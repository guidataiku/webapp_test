import { booleanAttribute, ChangeDetectorRef, DestroyRef, Directive, ElementRef, EventEmitter, HostBinding, inject, Input, isDevMode, numberAttribute, Output, TemplateRef, ViewChild, } from '@angular/core';
import { Overlay, ScrollStrategyOptions, } from '@angular/cdk/overlay';
import { ComponentPortal } from '@angular/cdk/portal';
import { RdsAutocompleteContainerComponent } from './autocomplete-container.component';
import { BehaviorSubject, distinctUntilChanged, merge, noop, skip, Subject, } from 'rxjs';
import { debounceTime, filter, tap } from 'rxjs/operators';
import { hasModifierKey } from '@angular/cdk/keycodes';
import { takeUntilDestroyed } from '@angular/core/rxjs-interop';
import { RDS_AUTOCOMPLETE_CONFIG, RDS_AUTOCOMPLETE_DEFAULT_CONFIG, } from './autocomplete.config';
import { RdsAutocompleteIntl } from './autocomplete-intl.service';
import { RDS_FORM_FIELD, RdsAbstractFormFieldControl } from '../form-field';
import { updateErrorState } from '../utils';
import * as i0 from "@angular/core";
export class RdsAbstractAutocompleteComponent extends RdsAbstractFormFieldControl {
    get attrDisabled() {
        if (this.ngControl && this.ngControl.disabled !== null) {
            return this.ngControl.disabled ? this.ngControl.disabled : null;
        }
        return this._disabled ? this._disabled : null;
    }
    set disabled(disabled) {
        this._disabled = booleanAttribute(disabled);
        if (this._focused) {
            this._focused = false;
            this.stateChanges.next();
        }
    }
    get disabled() {
        return this.attrDisabled || false;
    }
    set debounce(debounce) {
        this._debounce = numberAttribute(debounce, this.config.debounce);
    }
    get debounce() {
        return this._debounce;
    }
    set minSearchChars(minSearchChars) {
        this._minSearchChars = numberAttribute(minSearchChars, this.config.minSearchChars);
    }
    get minSearchChars() {
        return this._minSearchChars;
    }
    get empty() {
        return (this.values.length === 0 &&
            !this.inputEl.nativeElement.value &&
            !this.isNativelyBadInput());
    }
    get shouldLabelFloat() {
        return this._focused || !this.empty;
    }
    get errorState() {
        return this._errorState;
    }
    get inputAriaDescribedBy() {
        return this._inputAriaDescribedby;
    }
    set inputAriaDescribedBy(newValue) {
        this._inputAriaDescribedby = newValue;
    }
    constructor() {
        super();
        this.cdr = inject(ChangeDetectorRef);
        this.overlay = inject(Overlay);
        this.destroyRef = inject(DestroyRef);
        this.config = {
            ...RDS_AUTOCOMPLETE_DEFAULT_CONFIG,
            ...inject(RDS_AUTOCOMPLETE_CONFIG, { optional: true }),
        };
        this.intl = inject(RdsAutocompleteIntl);
        this.formField = inject(RDS_FORM_FIELD);
        this.scrollStrategyOptions = inject(ScrollStrategyOptions);
        this.compareItem = (i1, i2) => this.getUniqProperty(i1) === this.getUniqProperty(i2);
        this.highlightQuery = false;
        this.selectNewItemOnBlur = false;
        this.selectLastRemainingOnBlur = false;
        this._debounce = this.config.debounce;
        this._minSearchChars = this.config.minSearchChars;
        this.hostClass = 'w-100';
        this.controlType = 'autocomplete';
        this.typing$ = new BehaviorSubject(false);
        this.openChanged = new EventEmitter();
        this.shown = new EventEmitter();
        this.hidden = new EventEmitter();
        this.typing = this.typing$.pipe(distinctUntilChanged());
        this.loading = new BehaviorSubject(false);
        this.onChange = noop;
        this.onTouched = noop;
        this._newValues = [];
        this._open = false;
        this._overlayRef = null;
        this._options = [];
        this._onFocusInputValue = '';
        this._search$ = new BehaviorSubject('');
        this._lastValues = [];
        this._closed$ = new Subject();
        if (this.ngControl) {
            // Note: we provide the value accessor through here, instead of
            // the `providers` to avoid running into a circular import.
            this.ngControl.valueAccessor = this;
        }
        merge(this.intl.change$, this.stateChanges)
            .pipe(takeUntilDestroyed())
            .subscribe(() => this.cdr.markForCheck());
        this.typing$
            .pipe(takeUntilDestroyed())
            .subscribe(() => this.onValueChange());
    }
    ngOnInit() {
        this.updateSearch();
    }
    ngOnChanges(changes) {
        if (this.disabled) {
            this.hide();
        }
        if (this._dropdownInstance &&
            (changes['displayProperty'] ||
                changes['loadingText'] ||
                changes['noDataText'])) {
            this.assignInputsToDropdown();
        }
        if (changes['debounce']) {
            this.updateSearch();
        }
    }
    ngDoCheck() {
        if (this.ngControl) {
            const oldState = this._errorState;
            this._errorState =
                !this.typing$.getValue() &&
                    !this._open &&
                    updateErrorState(this.errorState, this.parentFormGroup, this.parentForm, this.ngControl.control);
            if (oldState !== this._errorState) {
                this.stateChanges.next();
            }
        }
    }
    ngOnDestroy() {
        if (this._overlayRef) {
            this._overlayRef.detach();
        }
        this._search$.complete();
        this._closed$.next();
        this._closed$.complete();
    }
    focusChanged(isFocused) {
        this.typing$.next(isFocused);
        if (isFocused !== this.focused &&
            (!this.inputEl.nativeElement.readOnly || !isFocused)) {
            this._focused = isFocused;
            this.stateChanges.next();
            this.inputEl.nativeElement.selectionStart =
                this.inputEl.nativeElement.value.length;
        }
        if (!isFocused) {
            this.onTouched();
            if ((!Array.isArray(this.value) && !this.value) ||
                Array.isArray(this.value)) {
                this.onValueChange(this._onFocusInputValue !== this.inputEl.nativeElement.value);
            }
        }
        else {
            this._onFocusInputValue = this.inputEl.nativeElement.value;
            this.show();
        }
    }
    show() {
        if (!this.disabled &&
            !this._open &&
            this.inputEl.nativeElement.value.length >= this.minSearchChars) {
            this._open = true;
            if (this._options.length === 0 && this.minSearchChars === 0) {
                this.searchFn(this._search$.getValue());
            }
            if (!this._overlayRef) {
                this._overlayRef = this.overlay.create({
                    hasBackdrop: true,
                    backdropClass: 'transparent',
                    positionStrategy: this.getPositionStrategy(),
                    scrollStrategy: this.scrollStrategyOptions.block(),
                    minWidth: Math.max(this.config.optionsContainerMinWidth, this._trigger.nativeElement.getBoundingClientRect().width),
                });
                this._overlayRef
                    .backdropClick()
                    .pipe(takeUntilDestroyed(this.destroyRef))
                    .subscribe(() => this.addNewItemOnBlurAndHide());
                this._portal = new ComponentPortal(RdsAutocompleteContainerComponent, null);
            }
            this._dropdownInstance = this._overlayRef.attach(this._portal);
            this.assignInputsToDropdown();
            this.openChanged.emit(true);
            this.shown.emit();
            this.inputEl.nativeElement.focus();
        }
    }
    hide() {
        if (this._open) {
            this._open = false;
            if (this._overlayRef) {
                this._overlayRef.detach();
            }
            this.onTouched();
            this._closed$.next();
            this.openChanged.emit(false);
            this.hidden.emit();
            this.cdr.markForCheck();
        }
    }
    hasValue() {
        return this.values.length > 0;
    }
    isSelected(option) {
        return this.values.some((o) => this.compareItem(option, o));
    }
    clear() {
        if (!this.disabled) {
            const beforeValue = this.inputEl.nativeElement.value;
            this.setValueForClear();
            this.inputEl.nativeElement.value = '';
            this.onValueChange(beforeValue !== '');
            this._newValues = [];
            this._options = [];
            this.inputEl.nativeElement.focus();
            this.updateDropdownOptions();
        }
    }
    selectNewItem() {
        if (typeof this.newItem === 'function') {
            const newItem = this.getNewItem();
            if (newItem) {
                this._options = this._options.filter((o) => !this._newValues.some((newOpt) => this.compareItem(o, newOpt)));
                this._newValues = [
                    ...this._newValues.filter((v) => !this.compareItem(v, newItem)),
                    newItem,
                ];
                this._options = [...this._options, ...this._newValues];
                this.select(newItem);
            }
        }
        else if (isDevMode()) {
            throw new Error(`Adding new item requires defined newItem as function for autocomplete.`);
        }
    }
    getNewItem() {
        return typeof this.newItem === 'function'
            ? this.newItem(this.inputEl.nativeElement.value, this._options)
            : null;
    }
    registerOnChange(fn) {
        this.onChange = fn;
    }
    registerOnTouched(fn) {
        this.onTouched = fn;
    }
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
        this.cdr.markForCheck();
    }
    writeValue(v) {
        this.value = v;
    }
    getInputFilledValue() {
        return this.inputEl.nativeElement.value;
    }
    getDisplayProperty(v) {
        if (!v) {
            return '';
        }
        else if (this.displayProperty) {
            if (typeof this.displayProperty === 'function') {
                return this.displayProperty(v);
            }
            else {
                return String(v[this.displayProperty]);
            }
        }
        else {
            return String(v);
        }
    }
    getUniqProperty(v) {
        if (!v) {
            return '';
        }
        else if (this.uniqProperty) {
            if (typeof this.uniqProperty === 'function') {
                return this.uniqProperty(v);
            }
            else {
                return String(v[this.uniqProperty]);
            }
        }
        else {
            return this.getDisplayProperty(v);
        }
    }
    onContainerClick() {
        if (!this._focused) {
            this.focus();
            if (Array.isArray(this.options) &&
                this.debounce === 0 &&
                this.minSearchChars === 0) {
                this.show();
            }
        }
    }
    setDescribedByIds(ids) {
        this.inputAriaDescribedBy = ids.join(' ');
    }
    getSearchQuery() {
        return this._search$.getValue();
    }
    updatePosition() {
        this._overlayRef?.updatePosition();
    }
    clearValue(event) {
        if (event) {
            event.stopPropagation();
        }
        this.clear();
    }
    toggle(option) {
        if (this.isSelected(option)) {
            this.deselect(option);
        }
        else {
            this.select(option);
        }
    }
    get required() {
        if (this.ngControl &&
            this.ngControl.control &&
            this.ngControl.control.validator) {
            const validators = this.ngControl.control.validator({});
            if (validators && validators['required']) {
                return true;
            }
        }
        return super.required;
    }
    _addOption(option, component) {
        this._dropdownInstance?.instance._addOption(option, component);
    }
    _deleteOption(option) {
        this._dropdownInstance?.instance._deleteOption(option);
    }
    onValueChange(force = false) {
        if (force ||
            this.hasAtLeastOneDifferentItem(this.values, this._lastValues)) {
            this._lastValues = [...this.values];
            this.onChange(this.value);
        }
    }
    addNewItemOnBlurAndHide() {
        this.addNewItemOnBlur();
        this.hide();
    }
    addNewItemOnBlur(query = this.inputEl.nativeElement.value) {
        if (this.selectLastRemainingOnBlur && this._options.length === 1) {
            this.select(this._options[0]);
        }
        else if (this.selectNewItemOnBlur && typeof this.newItem === 'function') {
            const newVal = this.newItem(query, this._options);
            if (newVal && this._options.every((o) => !this.compareItem(o, newVal))) {
                this._options = this._options.filter((o) => !this._newValues.some((newOpt) => this.compareItem(o, newOpt)));
                this._newValues = [
                    ...this._newValues.filter((v) => !this.compareItem(v, newVal)),
                    newVal,
                ];
                this._options = [...this._options, ...this._newValues];
                this.updateDropdownOptions();
                this.select(newVal);
            }
        }
        this.onTouched();
        this.typing$.next(false);
    }
    getPlaceholder() {
        if (!this._focused &&
            this.formField.labelPosition === 'floating' &&
            this.values.length === 0) {
            return '';
        }
        else if (typeof this.placeholder === 'string') {
            return this.placeholder;
        }
        else {
            return RdsAutocompleteIntl.translations.placeholder;
        }
    }
    search(query = this.inputEl.nativeElement.value) {
        if (typeof this.skipSearchValue === 'function' &&
            this.skipSearchValue(query)) {
            return;
        }
        this._search$.next(query);
    }
    onInputKeydown(event) {
        if (!hasModifierKey(event, 'altKey', 'shiftKey', 'ctrlKey', 'metaKey')) {
            if (!this._open && event.key === 'Enter') {
                this.show();
            }
            else if (this._open && event.key === 'Escape') {
                this.hide();
            }
            this._dropdownInstance?.instance.onKeydown(event);
        }
    }
    _filterBy(item, query) {
        return typeof this.filterBy === 'function'
            ? this.filterBy(item, query)
            : this.getDisplayProperty(item).includes(query);
    }
    searchFn(query) {
        if (this.inputEl.nativeElement.value.length >= this.minSearchChars) {
            if (this._focused) {
                this.show();
            }
            this.loading.next(true);
            if (typeof this.options === 'function') {
                this.options(query)
                    .pipe(takeUntilDestroyed(this.destroyRef))
                    .subscribe((options) => {
                    this._options = [
                        ...options,
                        ...this.getNewNotQueriedSelectedValues(options),
                    ];
                    this.updateDropdownOptions();
                });
            }
            else {
                this._options = [
                    ...this.options,
                    ...this.getNewNotQueriedSelectedValues(this.options),
                ].filter((v) => this._filterBy(v, query));
                this.updateDropdownOptions();
                this.loading.next(false);
            }
        }
        else {
            this.loading.next(false);
            this.hide();
        }
    }
    getNewNotQueriedSelectedValues(options) {
        return this.values
            .filter((o) => this._newValues.some((newOpt) => this.compareItem(o, newOpt)))
            .filter((o) => !options.some((q) => this.compareItem(q, o)));
    }
    updateDropdownOptions() {
        if (this._dropdownInstance) {
            this._dropdownInstance.instance.options = this._options;
            this._dropdownInstance.changeDetectorRef.markForCheck();
            this.loading.next(false);
        }
    }
    getPositionStrategy() {
        return this.overlay
            .position()
            .flexibleConnectedTo(this._origin.elementRef)
            .withPositions([this.getPositions()]);
    }
    getPositions() {
        return {
            originX: 'start',
            originY: 'bottom',
            overlayX: 'start',
            overlayY: 'top',
            offsetX: 0,
            offsetY: 0,
        };
    }
    assignInputsToDropdown() {
        this._dropdownInstance.instance.autocomplete = this;
        this._dropdownInstance.instance.size = this.formField.size;
        this._dropdownInstance.instance.options = this._options;
        this._dropdownInstance.changeDetectorRef.markForCheck();
    }
    updateSearch() {
        if (this._search$) {
            this._search$.complete();
        }
        const searchQuery = Array.isArray(this.value)
            ? ''
            : this.getDisplayProperty(this.values[0]);
        this._search$ = new BehaviorSubject(searchQuery);
        this._search$
            .pipe(skip(1), distinctUntilChanged(), filter((query) => this.inputEl.nativeElement.value === query), tap(() => {
            if (this._focused) {
                this.show();
            }
            if (this._dropdownInstance &&
                this.debounce !== 0 &&
                this.inputEl.nativeElement.value.length >= this.minSearchChars) {
                this.loading.next(true);
            }
            if (this.debounce !== 0 &&
                this.inputEl.nativeElement.value.length < this.minSearchChars &&
                this.loading.getValue()) {
                this.loading.next(false);
            }
        }), debounceTime(this.debounce), takeUntilDestroyed(this.destroyRef))
            .subscribe((q) => this.searchFn(q));
    }
    isNativelyBadInput() {
        return (this.inputEl.nativeElement.validity &&
            this.inputEl.nativeElement.validity.badInput);
    }
    hasAtLeastOneDifferentItem(arrayA, arrayB) {
        if (arrayA.length === 0 && arrayB.length === 0) {
            return false;
        }
        else if (arrayA.length !== arrayB.length) {
            return true;
        }
        return (arrayA.some((o) => !arrayB.some((op) => this.compareItem(o, op))) ||
            arrayB.some((o) => !arrayA.some((op) => this.compareItem(o, op))));
    }
    focus(options) {
        this.inputEl.nativeElement.focus(options);
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.1", ngImport: i0, type: RdsAbstractAutocompleteComponent, deps: [], target: i0.ɵɵFactoryTarget.Directive }); }
    static { this.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "16.1.0", version: "17.3.1", type: RdsAbstractAutocompleteComponent, inputs: { options: "options", displayProperty: "displayProperty", uniqProperty: "uniqProperty", compareItem: "compareItem", filterBy: "filterBy", highlightQuery: "highlightQuery", newItem: "newItem", selectNewItemOnBlur: ["selectNewItemOnBlur", "selectNewItemOnBlur", booleanAttribute], selectLastRemainingOnBlur: ["selectLastRemainingOnBlur", "selectLastRemainingOnBlur", booleanAttribute], skipSearchValue: "skipSearchValue", placeholder: "placeholder", loadingText: "loadingText", noDataText: "noDataText", newItemText: "newItemText", optionTemplate: "optionTemplate", noDataTemplate: "noDataTemplate", loadingTemplate: "loadingTemplate", newItemTemplate: "newItemTemplate", disabled: "disabled", debounce: "debounce", minSearchChars: "minSearchChars" }, outputs: { openChanged: "openChanged", shown: "shown", hidden: "hidden", typing: "typing", loading: "loading" }, host: { properties: { "attr.disabled": "this.attrDisabled", "class": "this.hostClass" } }, viewQueries: [{ propertyName: "inputEl", first: true, predicate: ["inputEl"], descendants: true, static: true }, { propertyName: "inputContainer", first: true, predicate: ["inputContainer"], descendants: true, static: true }], usesInheritance: true, usesOnChanges: true, ngImport: i0 }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.1", ngImport: i0, type: RdsAbstractAutocompleteComponent, decorators: [{
            type: Directive
        }], ctorParameters: () => [], propDecorators: { options: [{
                type: Input,
                args: [{ required: true }]
            }], displayProperty: [{
                type: Input
            }], uniqProperty: [{
                type: Input
            }], compareItem: [{
                type: Input
            }], filterBy: [{
                type: Input
            }], highlightQuery: [{
                type: Input
            }], newItem: [{
                type: Input
            }], selectNewItemOnBlur: [{
                type: Input,
                args: [{ transform: booleanAttribute }]
            }], selectLastRemainingOnBlur: [{
                type: Input,
                args: [{ transform: booleanAttribute }]
            }], skipSearchValue: [{
                type: Input
            }], placeholder: [{
                type: Input
            }], loadingText: [{
                type: Input
            }], noDataText: [{
                type: Input
            }], newItemText: [{
                type: Input
            }], optionTemplate: [{
                type: Input
            }], noDataTemplate: [{
                type: Input
            }], loadingTemplate: [{
                type: Input
            }], newItemTemplate: [{
                type: Input
            }], attrDisabled: [{
                type: HostBinding,
                args: ['attr.disabled']
            }], disabled: [{
                type: Input
            }], debounce: [{
                type: Input
            }], minSearchChars: [{
                type: Input
            }], hostClass: [{
                type: HostBinding,
                args: ['class']
            }], openChanged: [{
                type: Output
            }], shown: [{
                type: Output
            }], hidden: [{
                type: Output
            }], typing: [{
                type: Output
            }], loading: [{
                type: Output
            }], inputEl: [{
                type: ViewChild,
                args: ['inputEl', { static: true }]
            }], inputContainer: [{
                type: ViewChild,
                args: ['inputContainer', { static: true }]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWJzdHJhY3QtYXV0b2NvbXBsZXRlLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL2xpYnMvYW5ndWxhci1jb21wb25lbnRzL3NyYy9saWIvYXV0b2NvbXBsZXRlL2Fic3RyYWN0LWF1dG9jb21wbGV0ZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUNMLGdCQUFnQixFQUNoQixpQkFBaUIsRUFFakIsVUFBVSxFQUNWLFNBQVMsRUFFVCxVQUFVLEVBQ1YsWUFBWSxFQUNaLFdBQVcsRUFDWCxNQUFNLEVBQ04sS0FBSyxFQUNMLFNBQVMsRUFDVCxlQUFlLEVBSWYsTUFBTSxFQUVOLFdBQVcsRUFDWCxTQUFTLEdBQ1YsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUdMLE9BQU8sRUFHUCxxQkFBcUIsR0FDdEIsTUFBTSxzQkFBc0IsQ0FBQztBQUM5QixPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLGlDQUFpQyxFQUFFLE1BQU0sb0NBQW9DLENBQUM7QUFDdkYsT0FBTyxFQUNMLGVBQWUsRUFDZixvQkFBb0IsRUFDcEIsS0FBSyxFQUNMLElBQUksRUFFSixJQUFJLEVBQ0osT0FBTyxHQUNSLE1BQU0sTUFBTSxDQUFDO0FBQ2QsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDM0QsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQ3ZELE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQ2hFLE9BQU8sRUFDTCx1QkFBdUIsRUFDdkIsK0JBQStCLEdBQ2hDLE1BQU0sdUJBQXVCLENBQUM7QUFDL0IsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFFbEUsT0FBTyxFQUFFLGNBQWMsRUFB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eUJBQXlCO3NCQUFoRSxLQUFLO3VCQUFDLEVBQUUsU0FBUyxFQUFFLGdCQUFnQixFQUFFO2dCQUM3QixlQUFlO3NCQUF2QixLQUFLO2dCQUNHLFdBQVc7c0JBQW5CLEtBQUs7Z0JBQ0csV0FBVztzQkFBbkIsS0FBSztnQkFDRyxVQUFVO3NCQUFsQixLQUFLO2dCQUNHLFdBQVc7c0JBQW5CLEtBQUs7Z0JBQ0csY0FBYztzQkFBdEIsS0FBSztnQkFHRyxjQUFjO3NCQUF0QixLQUFLO2dCQUdHLGVBQWU7c0JBQXZCLEtBQUs7Z0JBR0csZUFBZTtzQkFBdkIsS0FBSztnQkFLRixZQUFZO3NCQURmLFdBQVc7dUJBQUMsZUFBZTtnQkFVZixRQUFRO3NCQURwQixLQUFLO2dCQWVGLFFBQVE7c0JBRFgsS0FBSztnQkFZRixjQUFjO3NCQURqQixLQUFLO2dCQWF5QixTQUFTO3NCQUF2QyxXQUFXO3VCQUFDLE9BQU87Z0JBS1YsV0FBVztzQkFBcEIsTUFBTTtnQkFDRyxLQUFLO3NCQUFkLE1BQU07Z0JBQ0csTUFBTTtzQkFBZixNQUFNO2dCQUNHLE1BQU07c0JBQWYsTUFBTTtnQkFDRyxPQUFPO3NCQUFoQixNQUFNO2dCQUdHLE9BQU87c0JBRGhCLFNBQVM7dUJBQUMsU0FBUyxFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTtnQkFHNUIsY0FBYztzQkFEdkIsU0FBUzt1QkFBQyxnQkFBZ0IsRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBib29sZWFuQXR0cmlidXRlLFxuICBDaGFuZ2VEZXRlY3RvclJlZixcbiAgQ29tcG9uZW50UmVmLFxuICBEZXN0cm95UmVmLFxuICBEaXJlY3RpdmUsXG4gIERvQ2hlY2ssXG4gIEVsZW1lbnRSZWYsXG4gIEV2ZW50RW1pdHRlcixcbiAgSG9zdEJpbmRpbmcsXG4gIGluamVjdCxcbiAgSW5wdXQsXG4gIGlzRGV2TW9kZSxcbiAgbnVtYmVyQXR0cmlidXRlLFxuICBPbkNoYW5nZXMsXG4gIE9uRGVzdHJveSxcbiAgT25Jbml0LFxuICBPdXRwdXQsXG4gIFNpbXBsZUNoYW5nZXMsXG4gIFRlbXBsYXRlUmVmLFxuICBWaWV3Q2hpbGQsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtcbiAgQ2RrT3ZlcmxheU9yaWdpbixcbiAgQ29ubmVjdGVkUG9zaXRpb24sXG4gIE92ZXJsYXksXG4gIE92ZXJsYXlSZWYsXG4gIFBvc2l0aW9uU3RyYXRlZ3ksXG4gIFNjcm9sbFN0cmF0ZWd5T3B0aW9ucyxcbn0gZnJvbSAnQGFuZ3VsYXIvY2RrL292ZXJsYXknO1xuaW1wb3J0IHsgQ29tcG9uZW50UG9ydGFsIH0gZnJvbSAnQGFuZ3VsYXIvY2RrL3BvcnRhbCc7XG5pbXBvcnQgeyBSZHNBdXRvY29tcGxldGVDb250YWluZXJDb21wb25lbnQgfSBmcm9tICcuL2F1dG9jb21wbGV0ZS1jb250YWluZXIuY29tcG9uZW50JztcbmltcG9ydCB7XG4gIEJlaGF2aW9yU3ViamVjdCxcbiAgZGlzdGluY3RVbnRpbENoYW5nZWQsXG4gIG1lcmdlLFxuICBub29wLFxuICBPYnNlcnZhYmxlLFxuICBza2lwLFxuICBTdWJqZWN0LFxufSBmcm9tICdyeGpzJztcbmltcG9ydCB7IGRlYm91bmNlVGltZSwgZmlsdGVyLCB0YXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBoYXNNb2RpZmllcktleSB9IGZyb20gJ0Bhbmd1bGFyL2Nkay9rZXljb2Rlcyc7XG5pbXBvcnQgeyB0YWtlVW50aWxEZXN0cm95ZWQgfSBmcm9tICdAYW5ndWxhci9jb3JlL3J4anMtaW50ZXJvcCc7XG5pbXBvcnQge1xuICBSRFNfQVVUT0NPTVBMRVRFX0NPTkZJRyxcbiAgUkRTX0FVVE9DT01QTEVURV9ERUZBVUxUX0NPTkZJRyxcbn0gZnJvbSAnLi9hdXRvY29tcGxldGUuY29uZmlnJztcbmltcG9ydCB7IFJkc0F1dG9jb21wbGV0ZUludGwgfSBmcm9tICcuL2F1dG9jb21wbGV0ZS1pbnRsLnNlcnZpY2UnO1xuaW1wb3J0IHsgQm9vbGVhbklucHV0LCBOdW1iZXJJbnB1dCB9IGZyb20gJ0Bhbmd1bGFyL2Nkay9jb2VyY2lvbic7XG5pbXBvcnQgeyBSRFNfRk9STV9GSUVMRCwgUmRzQWJzdHJhY3RGb3JtRmllbGRDb250cm9sIH0gZnJvbSAnLi4vZm9ybS1maWVsZCc7XG5pbXBvcnQgeyBSZHNDb250cm9sVHlwZSB9IGZyb20gJy4uL2Zvcm0tZmllbGQvY29udHJvbC50eXBlJztcbmltcG9ydCB7IHVwZGF0ZUVycm9yU3RhdGUgfSBmcm9tICcuLi91dGlscyc7XG5pbXBvcnQgeyBBYnN0cmFjdENvbnRyb2wsIENvbnRyb2xWYWx1ZUFjY2Vzc29yIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHtcbiAgUmRzQXV0b2NvbXBsZXRlTmV3SXRlbVRlbXBsYXRlQ29udGV4dCxcbiAgUmRzQXV0b2NvbXBsZXRlT3B0aW9uVGVtcGxhdGVDb250ZXh0LFxuICBSZHNBdXRvY29tcGxldGVUZW1wbGF0ZUNvbnRleHQsXG59IGZyb20gJy4vYXV0b2NvbXBsZXRlLnR5cGVzJztcbmltcG9ydCB7IFJkc0F1dG9jb21wbGV0ZU9wdGlvbkRpcmVjdGl2ZSB9IGZyb20gJy4vYXV0b2NvbXBsZXRlLW9wdGlvbi5kaXJlY3RpdmUnO1xuXG5ARGlyZWN0aXZlKClcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBSZHNBYnN0cmFjdEF1dG9jb21wbGV0ZUNvbXBvbmVudDxcbiAgICBULFxuICAgIEFycmF5T2ZGbGF0VHlwZSBleHRlbmRzIFQgfCBUW10sXG4gID5cbiAgZXh0ZW5kcyBSZHNBYnN0cmFjdEZvcm1GaWVsZENvbnRyb2w8QXJyYXlPZkZsYXRUeXBlPlxuICBpbXBsZW1lbnRzIE9uSW5pdCwgQ29udHJvbFZhbHVlQWNjZXNzb3IsIERvQ2hlY2ssIE9uQ2hhbmdlcywgT25EZXN0cm95XG57XG4gIHByb3RlY3RlZCByZWFkb25seSBjZHIgPSBpbmplY3QoQ2hhbmdlRGV0ZWN0b3JSZWYpO1xuICBwcm90ZWN0ZWQgcmVhZG9ubHkgb3ZlcmxheSA9IGluamVjdChPdmVybGF5KTtcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IGRlc3Ryb3lSZWYgPSBpbmplY3QoRGVzdHJveVJlZik7XG4gIHByb3RlY3RlZCByZWFkb25seSBjb25maWcgPSB7XG4gICAgLi4uUkRTX0FVVE9DT01QTEVURV9ERUZBVUxUX0NPTkZJRyxcbiAgICAuLi5pbmplY3QoUkRTX0FVVE9DT01QTEVURV9DT05GSUcsIHsgb3B0aW9uYWw6IHRydWUgfSksXG4gIH07XG4gIHByb3RlY3RlZCByZWFkb25seSBpbnRsID0gaW5qZWN0KFJkc0F1dG9jb21wbGV0ZUludGwpO1xuICBwcm90ZWN0ZWQgcmVhZG9ubHkgZm9ybUZpZWxkID0gaW5qZWN0KFJEU19GT1JNX0ZJRUxEKTtcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IHNjcm9sbFN0cmF0ZWd5T3B0aW9ucyA9IGluamVjdChTY3JvbGxTdHJhdGVneU9wdGlvbnMpO1xuXG4gIEBJbnB1dCh7IHJlcXVpcmVkOiB0cnVlIH0pIG9wdGlvbnM6XG4gICAgfCBUW11cbiAgICB8ICgocXVlcnk6IHN0cmluZykgPT4gT2JzZXJ2YWJsZTxUW10+KTtcbiAgQElucHV0KCkgZGlzcGxheVByb3BlcnR5OiBrZXlvZiBUIHwgKCh2YWx1ZTogVCkgPT4gc3RyaW5nKTtcbiAgQElucHV0KCkgdW5pcVByb3BlcnR5OiBrZXlvZiBUIHwgKCh2YWx1ZTogVCkgPT4gc3RyaW5nIHwgbnVtYmVyKTtcbiAgQElucHV0KCkgY29tcGFyZUl0ZW06IChpMTogVCwgaTI6IFQpID0+IGJvb2xlYW4gPSAoaTE6IFQsIGkyOiBUKSA9PlxuICAgIHRoaXMuZ2V0VW5pcVByb3BlcnR5KGkxKSA9PT0gdGhpcy5nZXRVbmlxUHJvcGVydHkoaTIpO1xuICBASW5wdXQoKSBmaWx0ZXJCeTogKGl0ZW06IFQsIHF1ZXJ5OiBzdHJpbmcpID0+IGJvb2xlYW47XG4gIEBJbnB1dCgpIGhpZ2hsaWdodFF1ZXJ5OiBib29sZWFuIHwgJ2ludmVyc2UnID0gZmFsc2U7XG4gIEBJbnB1dCgpIG5ld0l0ZW06IChxdWVyeTogc3RyaW5nLCBmZXRjaGVkQ29sbGVjdGlvbjogVFtdKSA9PiBUO1xuICBASW5wdXQoeyB0cmFuc2Zvcm06IGJvb2xlYW5BdHRyaWJ1dGUgfSkgc2VsZWN0TmV3SXRlbU9uQmx1ciA9IGZhbHNlO1xuICBASW5wdXQoeyB0cmFuc2Zvcm06IGJvb2xlYW5BdHRyaWJ1dGUgfSkgc2VsZWN0TGFzdFJlbWFpbmluZ09uQmx1ciA9IGZhbHNlO1xuICBASW5wdXQoKSBza2lwU2VhcmNoVmFsdWU6IChxdWVyeTogc3RyaW5nKSA9PiBib29sZWFuO1xuICBASW5wdXQoKSBwbGFjZWhvbGRlcjogc3RyaW5nO1xuICBASW5wdXQoKSBsb2FkaW5nVGV4dDogc3RyaW5nO1xuICBASW5wdXQoKSBub0RhdGFUZXh0OiBzdHJpbmc7XG4gIEBJbnB1dCgpIG5ld0l0ZW1UZXh0OiBzdHJpbmc7XG4gIEBJbnB1dCgpIG9wdGlvblRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxcbiAgICBSZHNBdXRvY29tcGxldGVPcHRpb25UZW1wbGF0ZUNvbnRleHQ8VCwgQXJyYXlPZkZsYXRUeXBlPlxuICA+O1xuICBASW5wdXQoKSBub0RhdGFUZW1wbGF0ZTogVGVtcGxhdGVSZWY8XG4gICAgUmRzQXV0b2NvbXBsZXRlVGVtcGxhdGVDb250ZXh0PFQsIEFycmF5T2ZGbGF0VHlwZT5cbiAgPjtcbiAgQElucHV0KCkgbG9hZGluZ1RlbXBsYXRlOiBUZW1wbGF0ZVJlZjxcbiAgICBSZHNBdXRvY29tcGxldGVUZW1wbGF0ZUNvbnRleHQ8VCwgQXJyYXlPZkZsYXRUeXBlPlxuICA+O1xuICBASW5wdXQoKSBuZXdJdGVtVGVtcGxhdGU6IFRlbXBsYXRlUmVmPFxuICAgIFJkc0F1dG9jb21wbGV0ZU5ld0l0ZW1UZW1wbGF0ZUNvbnRleHQ8VCwgQXJyYXlPZkZsYXRUeXBlPlxuICA+O1xuXG4gIEBIb3N0QmluZGluZygnYXR0ci5kaXNhYmxlZCcpXG4gIGdldCBhdHRyRGlzYWJsZWQoKTogYm9vbGVhbiB8IG51bGwge1xuICAgIGlmICh0aGlzLm5nQ29udHJvbCAmJiB0aGlzLm5nQ29udHJvbC5kaXNhYmxlZCAhPT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHRoaXMubmdDb250cm9sLmRpc2FibGVkID8gdGhpcy5uZ0NvbnRyb2wuZGlzYWJsZWQgOiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLl9kaXNhYmxlZCA/IHRoaXMuX2Rpc2FibGVkIDogbnVsbDtcbiAgfVxuXG4gIEBJbnB1dCgpXG4gIG92ZXJyaWRlIHNldCBkaXNhYmxlZChkaXNhYmxlZDogQm9vbGVhbklucHV0KSB7XG4gICAgdGhpcy5fZGlzYWJsZWQgPSBib29sZWFuQXR0cmlidXRlKGRpc2FibGVkKTtcblxuICAgIGlmICh0aGlzLl9mb2N1c2VkKSB7XG4gICAgICB0aGlzLl9mb2N1c2VkID0gZmFsc2U7XG4gICAgICB0aGlzLnN0YXRlQ2hhbmdlcy5uZXh0KCk7XG4gICAgfVxuICB9XG5cbiAgb3ZlcnJpZGUgZ2V0IGRpc2FibGVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmF0dHJEaXNhYmxlZCB8fCBmYWxzZTtcbiAgfVxuXG4gIEBJbnB1dCgpXG4gIHNldCBkZWJvdW5jZShkZWJvdW5jZTogTnVtYmVySW5wdXQpIHtcbiAgICB0aGlzLl9kZWJvdW5jZSA9IG51bWJlckF0dHJpYnV0ZShkZWJvdW5jZSwgdGhpcy5jb25maWcuZGVib3VuY2UpO1xuICB9XG5cbiAgZ2V0IGRlYm91bmNlKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuX2RlYm91bmNlO1xuICB9XG5cbiAgcHJpdmF0ZSBfZGVib3VuY2UgPSB0aGlzLmNvbmZpZy5kZWJvdW5jZTtcblxuICBASW5wdXQoKVxuICBzZXQgbWluU2VhcmNoQ2hhcnMobWluU2VhcmNoQ2hhcnM6IE51bWJlcklucHV0KSB7XG4gICAgdGhpcy5fbWluU2VhcmNoQ2hhcnMgPSBudW1iZXJBdHRyaWJ1dGUoXG4gICAgICBtaW5TZWFyY2hDaGFycyxcbiAgICAgIHRoaXMuY29uZmlnLm1pblNlYXJjaENoYXJzLFxuICAgICk7XG4gIH1cblxuICBnZXQgbWluU2VhcmNoQ2hhcnMoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5fbWluU2VhcmNoQ2hhcnM7XG4gIH1cblxuICBwcml2YXRlIF9taW5TZWFyY2hDaGFycyA9IHRoaXMuY29uZmlnLm1pblNlYXJjaENoYXJzO1xuICBASG9zdEJpbmRpbmcoJ2NsYXNzJykgcmVhZG9ubHkgaG9zdENsYXNzID0gJ3ctMTAwJztcblxuICByZWFkb25seSBjb250cm9sVHlwZTogUmRzQ29udHJvbFR5cGUgPSAnYXV0b2NvbXBsZXRlJztcbiAgcHJvdGVjdGVkIHR5cGluZyQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KGZhbHNlKTtcblxuICBAT3V0cHV0KCkgb3BlbkNoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyPGJvb2xlYW4+KCk7XG4gIEBPdXRwdXQoKSBzaG93biA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcbiAgQE91dHB1dCgpIGhpZGRlbiA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcbiAgQE91dHB1dCgpIHR5cGluZyA9IHRoaXMudHlwaW5nJC5waXBlKGRpc3RpbmN0VW50aWxDaGFuZ2VkKCkpO1xuICBAT3V0cHV0KCkgbG9hZGluZyA9IG5ldyBCZWhhdmlvclN1YmplY3QoZmFsc2UpO1xuXG4gIEBWaWV3Q2hpbGQoJ2lucHV0RWwnLCB7IHN0YXRpYzogdHJ1ZSB9KVxuICBwcm90ZWN0ZWQgaW5wdXRFbDogRWxlbWVudFJlZjxIVE1MSW5wdXRFbGVtZW50PjtcbiAgQFZpZXdDaGlsZCgnaW5wdXRDb250YWluZXInLCB7IHN0YXRpYzogdHJ1ZSB9KVxuICBwcm90ZWN0ZWQgaW5wdXRDb250YWluZXI6IEVsZW1lbnRSZWY8SFRNTERpdkVsZW1lbnQ+O1xuXG4gIGFic3RyYWN0IGdldCB2YWx1ZXMoKTogVFtdO1xuXG4gIGdldCBlbXB0eSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gKFxuICAgICAgdGhpcy52YWx1ZXMubGVuZ3RoID09PSAwICYmXG4gICAgICAhdGhpcy5pbnB1dEVsLm5hdGl2ZUVsZW1lbnQudmFsdWUgJiZcbiAgICAgICF0aGlzLmlzTmF0aXZlbHlCYWRJbnB1dCgpXG4gICAgKTtcbiAgfVxuXG4gIGdldCBzaG91bGRMYWJlbEZsb2F0KCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9mb2N1c2VkIHx8ICF0aGlzLmVtcHR5O1xuICB9XG5cbiAgZ2V0IGVycm9yU3RhdGUoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX2Vycm9yU3RhdGU7XG4gIH1cblxuICBwcm90ZWN0ZWQgZ2V0IGlucHV0QXJpYURlc2NyaWJlZEJ5KCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0QXJpYURlc2NyaWJlZGJ5O1xuICB9XG5cbiAgcHJvdGVjdGVkIHNldCBpbnB1dEFyaWFEZXNjcmliZWRCeShuZXdWYWx1ZTogc3RyaW5nKSB7XG4gICAgdGhpcy5faW5wdXRBcmlhRGVzY3JpYmVkYnkgPSBuZXdWYWx1ZTtcbiAgfVxuXG4gIF90cmlnZ2VyOiBFbGVtZW50UmVmPEhUTUxEaXZFbGVtZW50PjtcbiAgX29yaWdpbjogQ2RrT3ZlcmxheU9yaWdpbjtcblxuICBwcml2YXRlIF9pbnB1dEFyaWFEZXNjcmliZWRieTogc3RyaW5nO1xuXG4gIG9uQ2hhbmdlOiAodmFsdWU6IEFycmF5T2ZGbGF0VHlwZSkgPT4gdm9pZCA9IG5vb3A7XG4gIG9uVG91Y2hlZCA9IG5vb3A7XG5cbiAgcHJvdGVjdGVkIG92ZXJyaWRlIF92YWx1ZTogQXJyYXlPZkZsYXRUeXBlO1xuICBwcm90ZWN0ZWQgX25ld1ZhbHVlczogVFtdID0gW107XG4gIHByb3RlY3RlZCBfb3BlbiA9IGZhbHNlO1xuICBwcml2YXRlIF9vdmVybGF5UmVmOiBPdmVybGF5UmVmIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgX3BvcnRhbDogQ29tcG9uZW50UG9ydGFsPFxuICAgIFJkc0F1dG9jb21wbGV0ZUNvbnRhaW5lckNvbXBvbmVudDxULCBBcnJheU9mRmxhdFR5cGU+XG4gID47XG4gIHByb3RlY3RlZCBfZHJvcGRvd25JbnN0YW5jZTogQ29tcG9uZW50UmVmPFxuICAgIFJkc0F1dG9jb21wbGV0ZUNvbnRhaW5lckNvbXBvbmVudDxULCBBcnJheU9mRmxhdFR5cGU+XG4gID47XG4gIHByb3RlY3RlZCBfb3B0aW9uczogVFtdID0gW107XG4gIHByb3RlY3RlZCBfb25Gb2N1c0lucHV0VmFsdWUgPSAnJztcbiAgcHJvdGVjdGVkIF9zZWFyY2gkID0gbmV3IEJlaGF2aW9yU3ViamVjdDxzdHJpbmc+KCcnKTtcbiAgcHJpdmF0ZSBfbGFzdFZhbHVlczogVFtdID0gW107XG4gIHByaXZhdGUgcmVhZG9ubHkgX2Nsb3NlZCQgPSBuZXcgU3ViamVjdDx2b2lkPigpO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG5cbiAgICBpZiAodGhpcy5uZ0NvbnRyb2wpIHtcbiAgICAgIC8vIE5vdGU6IHdlIHByb3ZpZGUgdGhlIHZhbHVlIGFjY2Vzc29yIHRocm91Z2ggaGVyZSwgaW5zdGVhZCBvZlxuICAgICAgLy8gdGhlIGBwcm92aWRlcnNgIHRvIGF2b2lkIHJ1bm5pbmcgaW50byBhIGNpcmN1bGFyIGltcG9ydC5cbiAgICAgIHRoaXMubmdDb250cm9sLnZhbHVlQWNjZXNzb3IgPSB0aGlzO1xuICAgIH1cblxuICAgIG1lcmdlKHRoaXMuaW50bC5jaGFuZ2UkLCB0aGlzLnN0YXRlQ2hhbmdlcylcbiAgICAgIC5waXBlKHRha2VVbnRpbERlc3Ryb3llZCgpKVxuICAgICAgLnN1YnNjcmliZSgoKSA9PiB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKSk7XG4gICAgdGhpcy50eXBpbmckXG4gICAgICAucGlwZSh0YWtlVW50aWxEZXN0cm95ZWQoKSlcbiAgICAgIC5zdWJzY3JpYmUoKCkgPT4gdGhpcy5vblZhbHVlQ2hhbmdlKCkpO1xuICB9XG5cbiAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgdGhpcy51cGRhdGVTZWFyY2goKTtcbiAgfVxuXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5kaXNhYmxlZCkge1xuICAgICAgdGhpcy5oaWRlKCk7XG4gICAgfVxuXG4gICAgaWYgKFxuICAgICAgdGhpcy5fZHJvcGRvd25JbnN0YW5jZSAmJlxuICAgICAgKGNoYW5nZXNbJ2Rpc3BsYXlQcm9wZXJ0eSddIHx8XG4gICAgICAgIGNoYW5nZXNbJ2xvYWRpbmdUZXh0J10gfHxcbiAgICAgICAgY2hhbmdlc1snbm9EYXRhVGV4dCddKVxuICAgICkge1xuICAgICAgdGhpcy5hc3NpZ25JbnB1dHNUb0Ryb3Bkb3duKCk7XG4gICAgfVxuXG4gICAgaWYgKGNoYW5nZXNbJ2RlYm91bmNlJ10pIHtcbiAgICAgIHRoaXMudXBkYXRlU2VhcmNoKCk7XG4gICAgfVxuICB9XG5cbiAgbmdEb0NoZWNrKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLm5nQ29udHJvbCkge1xuICAgICAgY29uc3Qgb2xkU3RhdGUgPSB0aGlzLl9lcnJvclN0YXRlO1xuICAgICAgdGhpcy5fZXJyb3JTdGF0ZSA9XG4gICAgICAgICF0aGlzLnR5cGluZyQuZ2V0VmFsdWUoKSAmJlxuICAgICAgICAhdGhpcy5fb3BlbiAmJlxuICAgICAgICB1cGRhdGVFcnJvclN0YXRlKFxuICAgICAgICAgIHRoaXMuZXJyb3JTdGF0ZSxcbiAgICAgICAgICB0aGlzLnBhcmVudEZvcm1Hcm91cCxcbiAgICAgICAgICB0aGlzLnBhcmVudEZvcm0sXG4gICAgICAgICAgdGhpcy5uZ0NvbnRyb2wuY29udHJvbCxcbiAgICAgICAgKTtcblxuICAgICAgaWYgKG9sZFN0YXRlICE9PSB0aGlzLl9lcnJvclN0YXRlKSB7XG4gICAgICAgIHRoaXMuc3RhdGVDaGFuZ2VzLm5leHQoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5fb3ZlcmxheVJlZikge1xuICAgICAgdGhpcy5fb3ZlcmxheVJlZi5kZXRhY2goKTtcbiAgICB9XG5cbiAgICB0aGlzLl9zZWFyY2gkLmNvbXBsZXRlKCk7XG4gICAgdGhpcy5fY2xvc2VkJC5uZXh0KCk7XG4gICAgdGhpcy5fY2xvc2VkJC5jb21wbGV0ZSgpO1xuICB9XG5cbiAgcHJvdGVjdGVkIGZvY3VzQ2hhbmdlZChpc0ZvY3VzZWQ6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICB0aGlzLnR5cGluZyQubmV4dChpc0ZvY3VzZWQpO1xuXG4gICAgaWYgKFxuICAgICAgaXNGb2N1c2VkICE9PSB0aGlzLmZvY3VzZWQgJiZcbiAgICAgICghdGhpcy5pbnB1dEVsLm5hdGl2ZUVsZW1lbnQucmVhZE9ubHkgfHwgIWlzRm9jdXNlZClcbiAgICApIHtcbiAgICAgIHRoaXMuX2ZvY3VzZWQgPSBpc0ZvY3VzZWQ7XG4gICAgICB0aGlzLnN0YXRlQ2hhbmdlcy5uZXh0KCk7XG4gICAgICB0aGlzLmlucHV0RWwubmF0aXZlRWxlbWVudC5zZWxlY3Rpb25TdGFydCA9XG4gICAgICAgIHRoaXMuaW5wdXRFbC5uYXRpdmVFbGVtZW50LnZhbHVlLmxlbmd0aDtcbiAgICB9XG5cbiAgICBpZiAoIWlzRm9jdXNlZCkge1xuICAgICAgdGhpcy5vblRvdWNoZWQoKTtcblxuICAgICAgaWYgKFxuICAgICAgICAoIUFycmF5LmlzQXJyYXkodGhpcy52YWx1ZSkgJiYgIXRoaXMudmFsdWUpIHx8XG4gICAgICAgIEFycmF5LmlzQXJyYXkodGhpcy52YWx1ZSlcbiAgICAgICkge1xuICAgICAgICB0aGlzLm9uVmFsdWVDaGFuZ2UoXG4gICAgICAgICAgdGhpcy5fb25Gb2N1c0lucHV0VmFsdWUgIT09IHRoaXMuaW5wdXRFbC5uYXRpdmVFbGVtZW50LnZhbHVlLFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9vbkZvY3VzSW5wdXRWYWx1ZSA9IHRoaXMuaW5wdXRFbC5uYXRpdmVFbGVtZW50LnZhbHVlO1xuICAgICAgdGhpcy5zaG93KCk7XG4gICAgfVxuICB9XG5cbiAgc2hvdygpOiB2b2lkIHtcbiAgICBpZiAoXG4gICAgICAhdGhpcy5kaXNhYmxlZCAmJlxuICAgICAgIXRoaXMuX29wZW4gJiZcbiAgICAgIHRoaXMuaW5wdXRFbC5uYXRpdmVFbGVtZW50LnZhbHVlLmxlbmd0aCA+PSB0aGlzLm1pblNlYXJjaENoYXJzXG4gICAgKSB7XG4gICAgICB0aGlzLl9vcGVuID0gdHJ1ZTtcblxuICAgICAgaWYgKHRoaXMuX29wdGlvbnMubGVuZ3RoID09PSAwICYmIHRoaXMubWluU2VhcmNoQ2hhcnMgPT09IDApIHtcbiAgICAgICAgdGhpcy5zZWFyY2hGbih0aGlzLl9zZWFyY2gkLmdldFZhbHVlKCkpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXRoaXMuX292ZXJsYXlSZWYpIHtcbiAgICAgICAgdGhpcy5fb3ZlcmxheVJlZiA9IHRoaXMub3ZlcmxheS5jcmVhdGUoe1xuICAgICAgICAgIGhhc0JhY2tkcm9wOiB0cnVlLFxuICAgICAgICAgIGJhY2tkcm9wQ2xhc3M6ICd0cmFuc3BhcmVudCcsXG4gICAgICAgICAgcG9zaXRpb25TdHJhdGVneTogdGhpcy5nZXRQb3NpdGlvblN0cmF0ZWd5KCksXG4gICAgICAgICAgc2Nyb2xsU3RyYXRlZ3k6IHRoaXMuc2Nyb2xsU3RyYXRlZ3lPcHRpb25zLmJsb2NrKCksXG4gICAgICAgICAgbWluV2lkdGg6IE1hdGgubWF4KFxuICAgICAgICAgICAgdGhpcy5jb25maWcub3B0aW9uc0NvbnRhaW5lck1pbldpZHRoLFxuICAgICAgICAgICAgdGhpcy5fdHJpZ2dlci5uYXRpdmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoLFxuICAgICAgICAgICksXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9vdmVybGF5UmVmXG4gICAgICAgICAgLmJhY2tkcm9wQ2xpY2soKVxuICAgICAgICAgIC5waXBlKHRha2VVbnRpbERlc3Ryb3llZCh0aGlzLmRlc3Ryb3lSZWYpKVxuICAgICAgICAgIC5zdWJzY3JpYmUoKCkgPT4gdGhpcy5hZGROZXdJdGVtT25CbHVyQW5kSGlkZSgpKTtcbiAgICAgICAgdGhpcy5fcG9ydGFsID0gbmV3IENvbXBvbmVudFBvcnRhbDxcbiAgICAgICAgICBSZHNBdXRvY29tcGxldGVDb250YWluZXJDb21wb25lbnQ8VCwgQXJyYXlPZkZsYXRUeXBlPlxuICAgICAgICA+KFJkc0F1dG9jb21wbGV0ZUNvbnRhaW5lckNvbXBvbmVudCwgbnVsbCk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX2Ryb3Bkb3duSW5zdGFuY2UgPSB0aGlzLl9vdmVybGF5UmVmLmF0dGFjaCh0aGlzLl9wb3J0YWwpO1xuICAgICAgdGhpcy5hc3NpZ25JbnB1dHNUb0Ryb3Bkb3duKCk7XG4gICAgICB0aGlzLm9wZW5DaGFuZ2VkLmVtaXQodHJ1ZSk7XG4gICAgICB0aGlzLnNob3duLmVtaXQoKTtcbiAgICAgIHRoaXMuaW5wdXRFbC5uYXRpdmVFbGVtZW50LmZvY3VzKCk7XG4gICAgfVxuICB9XG5cbiAgaGlkZSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5fb3Blbikge1xuICAgICAgdGhpcy5fb3BlbiA9IGZhbHNlO1xuXG4gICAgICBpZiAodGhpcy5fb3ZlcmxheVJlZikge1xuICAgICAgICB0aGlzLl9vdmVybGF5UmVmLmRldGFjaCgpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLm9uVG91Y2hlZCgpO1xuICAgICAgdGhpcy5fY2xvc2VkJC5uZXh0KCk7XG4gICAgICB0aGlzLm9wZW5DaGFuZ2VkLmVtaXQoZmFsc2UpO1xuICAgICAgdGhpcy5oaWRkZW4uZW1pdCgpO1xuICAgICAgdGhpcy5jZHIubWFya0ZvckNoZWNrKCk7XG4gICAgfVxuICB9XG5cbiAgaGFzVmFsdWUoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWVzLmxlbmd0aCA+IDA7XG4gIH1cblxuICBpc1NlbGVjdGVkKG9wdGlvbjogVCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnZhbHVlcy5zb21lKChvKSA9PiB0aGlzLmNvbXBhcmVJdGVtKG9wdGlvbiwgbykpO1xuICB9XG5cbiAgYWJzdHJhY3QgZGVzZWxlY3Qob3B0aW9uPzogVCk6IHZvaWQ7XG5cbiAgY2xlYXIoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmRpc2FibGVkKSB7XG4gICAgICBjb25zdCBiZWZvcmVWYWx1ZSA9IHRoaXMuaW5wdXRFbC5uYXRpdmVFbGVtZW50LnZhbHVlO1xuICAgICAgdGhpcy5zZXRWYWx1ZUZvckNsZWFyKCk7XG4gICAgICB0aGlzLmlucHV0RWwubmF0aXZlRWxlbWVudC52YWx1ZSA9ICcnO1xuICAgICAgdGhpcy5vblZhbHVlQ2hhbmdlKGJlZm9yZVZhbHVlICE9PSAnJyk7XG4gICAgICB0aGlzLl9uZXdWYWx1ZXMgPSBbXTtcbiAgICAgIHRoaXMuX29wdGlvbnMgPSBbXTtcbiAgICAgIHRoaXMuaW5wdXRFbC5uYXRpdmVFbGVtZW50LmZvY3VzKCk7XG4gICAgICB0aGlzLnVwZGF0ZURyb3Bkb3duT3B0aW9ucygpO1xuICAgIH1cbiAgfVxuXG4gIHByb3RlY3RlZCBhYnN0cmFjdCBzZXRWYWx1ZUZvckNsZWFyKCk6IHZvaWQ7XG5cbiAgYWJzdHJhY3Qgc2VsZWN0KG9wdGlvbjogVCk6IHZvaWQ7XG5cbiAgc2VsZWN0TmV3SXRlbSgpOiB2b2lkIHtcbiAgICBpZiAodHlwZW9mIHRoaXMubmV3SXRlbSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgY29uc3QgbmV3SXRlbSA9IHRoaXMuZ2V0TmV3SXRlbSgpO1xuXG4gICAgICBpZiAobmV3SXRlbSkge1xuICAgICAgICB0aGlzLl9vcHRpb25zID0gdGhpcy5fb3B0aW9ucy5maWx0ZXIoXG4gICAgICAgICAgKG8pID0+ICF0aGlzLl9uZXdWYWx1ZXMuc29tZSgobmV3T3B0KSA9PiB0aGlzLmNvbXBhcmVJdGVtKG8sIG5ld09wdCkpLFxuICAgICAgICApO1xuICAgICAgICB0aGlzLl9uZXdWYWx1ZXMgPSBbXG4gICAgICAgICAgLi4udGhpcy5fbmV3VmFsdWVzLmZpbHRlcigodikgPT4gIXRoaXMuY29tcGFyZUl0ZW0odiwgbmV3SXRlbSkpLFxuICAgICAgICAgIG5ld0l0ZW0sXG4gICAgICAgIF07XG4gICAgICAgIHRoaXMuX29wdGlvbnMgPSBbLi4udGhpcy5fb3B0aW9ucywgLi4udGhpcy5fbmV3VmFsdWVzXTtcbiAgICAgICAgdGhpcy5zZWxlY3QobmV3SXRlbSk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChpc0Rldk1vZGUoKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgQWRkaW5nIG5ldyBpdGVtIHJlcXVpcmVzIGRlZmluZWQgbmV3SXRlbSBhcyBmdW5jdGlvbiBmb3IgYXV0b2NvbXBsZXRlLmAsXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIGdldE5ld0l0ZW0oKTogVCB8IG51bGwge1xuICAgIHJldHVybiB0eXBlb2YgdGhpcy5uZXdJdGVtID09PSAnZnVuY3Rpb24nXG4gICAgICA/IHRoaXMubmV3SXRlbSh0aGlzLmlucHV0RWwubmF0aXZlRWxlbWVudC52YWx1ZSwgdGhpcy5fb3B0aW9ucylcbiAgICAgIDogbnVsbDtcbiAgfVxuXG4gIHJlZ2lzdGVyT25DaGFuZ2UoZm46ICh2YWx1ZTogQXJyYXlPZkZsYXRUeXBlKSA9PiB2b2lkKTogdm9pZCB7XG4gICAgdGhpcy5vbkNoYW5nZSA9IGZuO1xuICB9XG5cbiAgcmVnaXN0ZXJPblRvdWNoZWQoZm46ICgpID0+IHZvaWQpOiB2b2lkIHtcbiAgICB0aGlzLm9uVG91Y2hlZCA9IGZuO1xuICB9XG5cbiAgc2V0RGlzYWJsZWRTdGF0ZShpc0Rpc2FibGVkOiBib29sZWFuKTogdm9pZCB7XG4gICAgdGhpcy5kaXNhYmxlZCA9IGlzRGlzYWJsZWQ7XG4gICAgdGhpcy5jZHIubWFya0ZvckNoZWNrKCk7XG4gIH1cblxuICB3cml0ZVZhbHVlKHY6IEFycmF5T2ZGbGF0VHlwZSk6IHZvaWQge1xuICAgIHRoaXMudmFsdWUgPSB2O1xuICB9XG5cbiAgYWJzdHJhY3QgaXNJbnB1dEZpbGxlZCgpOiBib29sZWFuO1xuXG4gIGdldElucHV0RmlsbGVkVmFsdWUoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5pbnB1dEVsLm5hdGl2ZUVsZW1lbnQudmFsdWU7XG4gIH1cblxuICBnZXREaXNwbGF5UHJvcGVydHkodjogVCB8IG51bGwpOiBzdHJpbmcge1xuICAgIGlmICghdikge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH0gZWxzZSBpZiAodGhpcy5kaXNwbGF5UHJvcGVydHkpIHtcbiAgICAgIGlmICh0eXBlb2YgdGhpcy5kaXNwbGF5UHJvcGVydHkgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGlzcGxheVByb3BlcnR5KHYpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFN0cmluZyh2W3RoaXMuZGlzcGxheVByb3BlcnR5XSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBTdHJpbmcodik7XG4gICAgfVxuICB9XG5cbiAgZ2V0VW5pcVByb3BlcnR5KHY6IFQgfCBudWxsKTogc3RyaW5nIHwgbnVtYmVyIHtcbiAgICBpZiAoIXYpIHtcbiAgICAgIHJldHVybiAnJztcbiAgICB9IGVsc2UgaWYgKHRoaXMudW5pcVByb3BlcnR5KSB7XG4gICAgICBpZiAodHlwZW9mIHRoaXMudW5pcVByb3BlcnR5ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnVuaXFQcm9wZXJ0eSh2KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBTdHJpbmcodlt0aGlzLnVuaXFQcm9wZXJ0eV0pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5nZXREaXNwbGF5UHJvcGVydHkodik7XG4gICAgfVxuICB9XG5cbiAgb25Db250YWluZXJDbGljaygpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuX2ZvY3VzZWQpIHtcbiAgICAgIHRoaXMuZm9jdXMoKTtcblxuICAgICAgaWYgKFxuICAgICAgICBBcnJheS5pc0FycmF5KHRoaXMub3B0aW9ucykgJiZcbiAgICAgICAgdGhpcy5kZWJvdW5jZSA9PT0gMCAmJlxuICAgICAgICB0aGlzLm1pblNlYXJjaENoYXJzID09PSAwXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5zaG93KCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgc2V0RGVzY3JpYmVkQnlJZHMoaWRzOiBzdHJpbmdbXSk6IHZvaWQge1xuICAgIHRoaXMuaW5wdXRBcmlhRGVzY3JpYmVkQnkgPSBpZHMuam9pbignICcpO1xuICB9XG5cbiAgZ2V0U2VhcmNoUXVlcnkoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5fc2VhcmNoJC5nZXRWYWx1ZSgpO1xuICB9XG5cbiAgdXBkYXRlUG9zaXRpb24oKTogdm9pZCB7XG4gICAgdGhpcy5fb3ZlcmxheVJlZj8udXBkYXRlUG9zaXRpb24oKTtcbiAgfVxuXG4gIGNsZWFyVmFsdWUoZXZlbnQ/OiBFdmVudCk6IHZvaWQge1xuICAgIGlmIChldmVudCkge1xuICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgfVxuXG4gICAgdGhpcy5jbGVhcigpO1xuICB9XG5cbiAgdG9nZ2xlKG9wdGlvbjogVCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmlzU2VsZWN0ZWQob3B0aW9uKSkge1xuICAgICAgdGhpcy5kZXNlbGVjdChvcHRpb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNlbGVjdChvcHRpb24pO1xuICAgIH1cbiAgfVxuXG4gIG92ZXJyaWRlIGdldCByZXF1aXJlZCgpOiBib29sZWFuIHtcbiAgICBpZiAoXG4gICAgICB0aGlzLm5nQ29udHJvbCAmJlxuICAgICAgdGhpcy5uZ0NvbnRyb2wuY29udHJvbCAmJlxuICAgICAgdGhpcy5uZ0NvbnRyb2wuY29udHJvbC52YWxpZGF0b3JcbiAgICApIHtcbiAgICAgIGNvbnN0IHZhbGlkYXRvcnMgPSB0aGlzLm5nQ29udHJvbC5jb250cm9sLnZhbGlkYXRvcihcbiAgICAgICAge30gYXMgQWJzdHJhY3RDb250cm9sLFxuICAgICAgKTtcblxuICAgICAgaWYgKHZhbGlkYXRvcnMgJiYgdmFsaWRhdG9yc1sncmVxdWlyZWQnXSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gc3VwZXIucmVxdWlyZWQ7XG4gIH1cblxuICBfYWRkT3B0aW9uKFxuICAgIG9wdGlvbjogSFRNTEVsZW1lbnQsXG4gICAgY29tcG9uZW50OiBSZHNBdXRvY29tcGxldGVPcHRpb25EaXJlY3RpdmU8VCwgQXJyYXlPZkZsYXRUeXBlPixcbiAgKTogdm9pZCB7XG4gICAgdGhpcy5fZHJvcGRvd25JbnN0YW5jZT8uaW5zdGFuY2UuX2FkZE9wdGlvbihvcHRpb24sIGNvbXBvbmVudCk7XG4gIH1cblxuICBfZGVsZXRlT3B0aW9uKG9wdGlvbjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICB0aGlzLl9kcm9wZG93bkluc3RhbmNlPy5pbnN0YW5jZS5fZGVsZXRlT3B0aW9uKG9wdGlvbik7XG4gIH1cblxuICBwcm90ZWN0ZWQgb25WYWx1ZUNoYW5nZShmb3JjZSA9IGZhbHNlKTogdm9pZCB7XG4gICAgaWYgKFxuICAgICAgZm9yY2UgfHxcbiAgICAgIHRoaXMuaGFzQXRMZWFzdE9uZURpZmZlcmVudEl0ZW0odGhpcy52YWx1ZXMsIHRoaXMuX2xhc3RWYWx1ZXMpXG4gICAgKSB7XG4gICAgICB0aGlzLl9sYXN0VmFsdWVzID0gWy4uLnRoaXMudmFsdWVzXTtcbiAgICAgIHRoaXMub25DaGFuZ2UodGhpcy52YWx1ZSk7XG4gICAgfVxuICB9XG5cbiAgcHJvdGVjdGVkIGFkZE5ld0l0ZW1PbkJsdXJBbmRIaWRlKCk6IHZvaWQge1xuICAgIHRoaXMuYWRkTmV3SXRlbU9uQmx1cigpO1xuICAgIHRoaXMuaGlkZSgpO1xuICB9XG5cbiAgcHJvdGVjdGVkIGFkZE5ld0l0ZW1PbkJsdXIocXVlcnkgPSB0aGlzLmlucHV0RWwubmF0aXZlRWxlbWVudC52YWx1ZSk6IHZvaWQge1xuICAgIGlmICh0aGlzLnNlbGVjdExhc3RSZW1haW5pbmdPbkJsdXIgJiYgdGhpcy5fb3B0aW9ucy5sZW5ndGggPT09IDEpIHtcbiAgICAgIHRoaXMuc2VsZWN0KHRoaXMuX29wdGlvbnNbMF0pO1xuICAgIH0gZWxzZSBpZiAodGhpcy5zZWxlY3ROZXdJdGVtT25CbHVyICYmIHR5cGVvZiB0aGlzLm5ld0l0ZW0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGNvbnN0IG5ld1ZhbCA9IHRoaXMubmV3SXRlbShxdWVyeSwgdGhpcy5fb3B0aW9ucyk7XG5cbiAgICAgIGlmIChuZXdWYWwgJiYgdGhpcy5fb3B0aW9ucy5ldmVyeSgobykgPT4gIXRoaXMuY29tcGFyZUl0ZW0obywgbmV3VmFsKSkpIHtcbiAgICAgICAgdGhpcy5fb3B0aW9ucyA9IHRoaXMuX29wdGlvbnMuZmlsdGVyKFxuICAgICAgICAgIChvKSA9PiAhdGhpcy5fbmV3VmFsdWVzLnNvbWUoKG5ld09wdCkgPT4gdGhpcy5jb21wYXJlSXRlbShvLCBuZXdPcHQpKSxcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5fbmV3VmFsdWVzID0gW1xuICAgICAgICAgIC4uLnRoaXMuX25ld1ZhbHVlcy5maWx0ZXIoKHYpID0+ICF0aGlzLmNvbXBhcmVJdGVtKHYsIG5ld1ZhbCkpLFxuICAgICAgICAgIG5ld1ZhbCxcbiAgICAgICAgXTtcbiAgICAgICAgdGhpcy5fb3B0aW9ucyA9IFsuLi50aGlzLl9vcHRpb25zLCAuLi50aGlzLl9uZXdWYWx1ZXNdO1xuICAgICAgICB0aGlzLnVwZGF0ZURyb3Bkb3duT3B0aW9ucygpO1xuICAgICAgICB0aGlzLnNlbGVjdChuZXdWYWwpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMub25Ub3VjaGVkKCk7XG4gICAgdGhpcy50eXBpbmckLm5leHQoZmFsc2UpO1xuICB9XG5cbiAgcHJvdGVjdGVkIGdldFBsYWNlaG9sZGVyKCk6IHN0cmluZyB7XG4gICAgaWYgKFxuICAgICAgIXRoaXMuX2ZvY3VzZWQgJiZcbiAgICAgIHRoaXMuZm9ybUZpZWxkLmxhYmVsUG9zaXRpb24gPT09ICdmbG9hdGluZycgJiZcbiAgICAgIHRoaXMudmFsdWVzLmxlbmd0aCA9PT0gMFxuICAgICkge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHRoaXMucGxhY2Vob2xkZXIgPT09ICdzdHJpbmcnKSB7XG4gICAgICByZXR1cm4gdGhpcy5wbGFjZWhvbGRlcjtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFJkc0F1dG9jb21wbGV0ZUludGwudHJhbnNsYXRpb25zLnBsYWNlaG9sZGVyO1xuICAgIH1cbiAgfVxuXG4gIHByb3RlY3RlZCBzZWFyY2gocXVlcnk6IHN0cmluZyA9IHRoaXMuaW5wdXRFbC5uYXRpdmVFbGVtZW50LnZhbHVlKTogdm9pZCB7XG4gICAgaWYgKFxuICAgICAgdHlwZW9mIHRoaXMuc2tpcFNlYXJjaFZhbHVlID09PSAnZnVuY3Rpb24nICYmXG4gICAgICB0aGlzLnNraXBTZWFyY2hWYWx1ZShxdWVyeSlcbiAgICApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLl9zZWFyY2gkLm5leHQocXVlcnkpO1xuICB9XG5cbiAgcHJvdGVjdGVkIG9uSW5wdXRLZXlkb3duKGV2ZW50OiBLZXlib2FyZEV2ZW50KTogdm9pZCB7XG4gICAgaWYgKCFoYXNNb2RpZmllcktleShldmVudCwgJ2FsdEtleScsICdzaGlmdEtleScsICdjdHJsS2V5JywgJ21ldGFLZXknKSkge1xuICAgICAgaWYgKCF0aGlzLl9vcGVuICYmIGV2ZW50LmtleSA9PT0gJ0VudGVyJykge1xuICAgICAgICB0aGlzLnNob3coKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5fb3BlbiAmJiBldmVudC5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9kcm9wZG93bkluc3RhbmNlPy5pbnN0YW5jZS5vbktleWRvd24oZXZlbnQpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgX2ZpbHRlckJ5KGl0ZW06IFQsIHF1ZXJ5OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdHlwZW9mIHRoaXMuZmlsdGVyQnkgPT09ICdmdW5jdGlvbidcbiAgICAgID8gdGhpcy5maWx0ZXJCeShpdGVtLCBxdWVyeSlcbiAgICAgIDogdGhpcy5nZXREaXNwbGF5UHJvcGVydHkoaXRlbSkuaW5jbHVkZXMocXVlcnkpO1xuICB9XG5cbiAgcHJpdmF0ZSBzZWFyY2hGbihxdWVyeTogc3RyaW5nKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuaW5wdXRFbC5uYXRpdmVFbGVtZW50LnZhbHVlLmxlbmd0aCA+PSB0aGlzLm1pblNlYXJjaENoYXJzKSB7XG4gICAgICBpZiAodGhpcy5fZm9jdXNlZCkge1xuICAgICAgICB0aGlzLnNob3coKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5sb2FkaW5nLm5leHQodHJ1ZSk7XG5cbiAgICAgIGlmICh0eXBlb2YgdGhpcy5vcHRpb25zID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRoaXMub3B0aW9ucyhxdWVyeSlcbiAgICAgICAgICAucGlwZSh0YWtlVW50aWxEZXN0cm95ZWQodGhpcy5kZXN0cm95UmVmKSlcbiAgICAgICAgICAuc3Vic2NyaWJlKChvcHRpb25zKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9vcHRpb25zID0gW1xuICAgICAgICAgICAgICAuLi5vcHRpb25zLFxuICAgICAgICAgICAgICAuLi50aGlzLmdldE5ld05vdFF1ZXJpZWRTZWxlY3RlZFZhbHVlcyhvcHRpb25zKSxcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZURyb3Bkb3duT3B0aW9ucygpO1xuICAgICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fb3B0aW9ucyA9IFtcbiAgICAgICAgICAuLi50aGlzLm9wdGlvbnMsXG4gICAgICAgICAgLi4udGhpcy5nZXROZXdOb3RRdWVyaWVkU2VsZWN0ZWRWYWx1ZXModGhpcy5vcHRpb25zKSxcbiAgICAgICAgXS5maWx0ZXIoKHYpID0+IHRoaXMuX2ZpbHRlckJ5KHYsIHF1ZXJ5KSk7XG4gICAgICAgIHRoaXMudXBkYXRlRHJvcGRvd25PcHRpb25zKCk7XG4gICAgICAgIHRoaXMubG9hZGluZy5uZXh0KGZhbHNlKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5sb2FkaW5nLm5leHQoZmFsc2UpO1xuICAgICAgdGhpcy5oaWRlKCk7XG4gICAgfVxuICB9XG5cbiAgcHJvdGVjdGVkIGdldE5ld05vdFF1ZXJpZWRTZWxlY3RlZFZhbHVlcyhvcHRpb25zOiBUW10pOiBUW10ge1xuICAgIHJldHVybiB0aGlzLnZhbHVlc1xuICAgICAgLmZpbHRlcigobykgPT5cbiAgICAgICAgdGhpcy5fbmV3VmFsdWVzLnNvbWUoKG5ld09wdCkgPT4gdGhpcy5jb21wYXJlSXRlbShvLCBuZXdPcHQpKSxcbiAgICAgIClcbiAgICAgIC5maWx0ZXIoKG8pID0+ICFvcHRpb25zLnNvbWUoKHEpID0+IHRoaXMuY29tcGFyZUl0ZW0ocSwgbykpKTtcbiAgfVxuXG4gIHByb3RlY3RlZCB1cGRhdGVEcm9wZG93bk9wdGlvbnMoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuX2Ryb3Bkb3duSW5zdGFuY2UpIHtcbiAgICAgIHRoaXMuX2Ryb3Bkb3duSW5zdGFuY2UuaW5zdGFuY2Uub3B0aW9ucyA9IHRoaXMuX29wdGlvbnM7XG4gICAgICB0aGlzLl9kcm9wZG93bkluc3RhbmNlLmNoYW5nZURldGVjdG9yUmVmLm1hcmtGb3JDaGVjaygpO1xuICAgICAgdGhpcy5sb2FkaW5nLm5leHQoZmFsc2UpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0UG9zaXRpb25TdHJhdGVneSgpOiBQb3NpdGlvblN0cmF0ZWd5IHtcbiAgICByZXR1cm4gdGhpcy5vdmVybGF5XG4gICAgICAucG9zaXRpb24oKVxuICAgICAgLmZsZXhpYmxlQ29ubmVjdGVkVG8odGhpcy5fb3JpZ2luLmVsZW1lbnRSZWYpXG4gICAgICAud2l0aFBvc2l0aW9ucyhbdGhpcy5nZXRQb3NpdGlvbnMoKV0pO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRQb3NpdGlvbnMoKTogQ29ubmVjdGVkUG9zaXRpb24ge1xuICAgIHJldHVybiB7XG4gICAgICBvcmlnaW5YOiAnc3RhcnQnLFxuICAgICAgb3JpZ2luWTogJ2JvdHRvbScsXG4gICAgICBvdmVybGF5WDogJ3N0YXJ0JyxcbiAgICAgIG92ZXJsYXlZOiAndG9wJyxcbiAgICAgIG9mZnNldFg6IDAsXG4gICAgICBvZmZzZXRZOiAwLFxuICAgIH07XG4gIH1cblxuICBwcm90ZWN0ZWQgYXNzaWduSW5wdXRzVG9Ecm9wZG93bigpOiB2b2lkIHtcbiAgICB0aGlzLl9kcm9wZG93bkluc3RhbmNlLmluc3RhbmNlLmF1dG9jb21wbGV0ZSA9IHRoaXM7XG4gICAgdGhpcy5fZHJvcGRvd25JbnN0YW5jZS5pbnN0YW5jZS5zaXplID0gdGhpcy5mb3JtRmllbGQuc2l6ZTtcbiAgICB0aGlzLl9kcm9wZG93bkluc3RhbmNlLmluc3RhbmNlLm9wdGlvbnMgPSB0aGlzLl9vcHRpb25zO1xuICAgIHRoaXMuX2Ryb3Bkb3duSW5zdGFuY2UuY2hhbmdlRGV0ZWN0b3JSZWYubWFya0ZvckNoZWNrKCk7XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZVNlYXJjaCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5fc2VhcmNoJCkge1xuICAgICAgdGhpcy5fc2VhcmNoJC5jb21wbGV0ZSgpO1xuICAgIH1cblxuICAgIGNvbnN0IHNlYXJjaFF1ZXJ5ID0gQXJyYXkuaXNBcnJheSh0aGlzLnZhbHVlKVxuICAgICAgPyAnJ1xuICAgICAgOiB0aGlzLmdldERpc3BsYXlQcm9wZXJ0eSh0aGlzLnZhbHVlc1swXSk7XG5cbiAgICB0aGlzLl9zZWFyY2gkID0gbmV3IEJlaGF2aW9yU3ViamVjdDxzdHJpbmc+KHNlYXJjaFF1ZXJ5KTtcbiAgICB0aGlzLl9zZWFyY2gkXG4gICAgICAucGlwZShcbiAgICAgICAgc2tpcCgxKSxcbiAgICAgICAgZGlzdGluY3RVbnRpbENoYW5nZWQoKSxcbiAgICAgICAgZmlsdGVyKChxdWVyeSkgPT4gdGhpcy5pbnB1dEVsLm5hdGl2ZUVsZW1lbnQudmFsdWUgPT09IHF1ZXJ5KSxcbiAgICAgICAgdGFwKCgpID0+IHtcbiAgICAgICAgICBpZiAodGhpcy5fZm9jdXNlZCkge1xuICAgICAgICAgICAgdGhpcy5zaG93KCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKFxuICAgICAgICAgICAgdGhpcy5fZHJvcGRvd25JbnN0YW5jZSAmJlxuICAgICAgICAgICAgdGhpcy5kZWJvdW5jZSAhPT0gMCAmJlxuICAgICAgICAgICAgdGhpcy5pbnB1dEVsLm5hdGl2ZUVsZW1lbnQudmFsdWUubGVuZ3RoID49IHRoaXMubWluU2VhcmNoQ2hhcnNcbiAgICAgICAgICApIHtcbiAgICAgICAgICAgIHRoaXMubG9hZGluZy5uZXh0KHRydWUpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChcbiAgICAgICAgICAgIHRoaXMuZGVib3VuY2UgIT09IDAgJiZcbiAgICAgICAgICAgIHRoaXMuaW5wdXRFbC5uYXRpdmVFbGVtZW50LnZhbHVlLmxlbmd0aCA8IHRoaXMubWluU2VhcmNoQ2hhcnMgJiZcbiAgICAgICAgICAgIHRoaXMubG9hZGluZy5nZXRWYWx1ZSgpXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICB0aGlzLmxvYWRpbmcubmV4dChmYWxzZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KSxcbiAgICAgICAgZGVib3VuY2VUaW1lKHRoaXMuZGVib3VuY2UpLFxuICAgICAgICB0YWtlVW50aWxEZXN0cm95ZWQodGhpcy5kZXN0cm95UmVmKSxcbiAgICAgIClcbiAgICAgIC5zdWJzY3JpYmUoKHEpID0+IHRoaXMuc2VhcmNoRm4ocSkpO1xuICB9XG5cbiAgcHJpdmF0ZSBpc05hdGl2ZWx5QmFkSW5wdXQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIChcbiAgICAgIHRoaXMuaW5wdXRFbC5uYXRpdmVFbGVtZW50LnZhbGlkaXR5ICYmXG4gICAgICB0aGlzLmlucHV0RWwubmF0aXZlRWxlbWVudC52YWxpZGl0eS5iYWRJbnB1dFxuICAgICk7XG4gIH1cblxuICBwcm90ZWN0ZWQgaGFzQXRMZWFzdE9uZURpZmZlcmVudEl0ZW0oYXJyYXlBOiBUW10sIGFycmF5QjogVFtdKTogYm9vbGVhbiB7XG4gICAgaWYgKGFycmF5QS5sZW5ndGggPT09IDAgJiYgYXJyYXlCLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0gZWxzZSBpZiAoYXJyYXlBLmxlbmd0aCAhPT0gYXJyYXlCLmxlbmd0aCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIChcbiAgICAgIGFycmF5QS5zb21lKChvKSA9PiAhYXJyYXlCLnNvbWUoKG9wKSA9PiB0aGlzLmNvbXBhcmVJdGVtKG8sIG9wKSkpIHx8XG4gICAgICBhcnJheUIuc29tZSgobykgPT4gIWFycmF5QS5zb21lKChvcCkgPT4gdGhpcy5jb21wYXJlSXRlbShvLCBvcCkpKVxuICAgICk7XG4gIH1cblxuICBwcm90ZWN0ZWQgZm9jdXMob3B0aW9ucz86IEZvY3VzT3B0aW9ucyk6IHZvaWQge1xuICAgIHRoaXMuaW5wdXRFbC5uYXRpdmVFbGVtZW50LmZvY3VzKG9wdGlvbnMpO1xuICB9XG59XG4iXX0=