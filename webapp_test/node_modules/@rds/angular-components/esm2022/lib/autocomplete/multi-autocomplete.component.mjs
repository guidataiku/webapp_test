import { ChangeDetectionStrategy, Component, ElementRef, forwardRef, HostListener, inject, Input, numberAttribute, QueryList, Renderer2, ViewChild, ViewChildren, } from '@angular/core';
import { AsyncPipe } from '@angular/common';
import { RdsAbstractFormFieldControl } from '../form-field';
import { RdsProgressSpinnerModule } from '../progress-spinner';
import { RdsIconComponent } from '../icons';
import { RdsButtonModule } from '../button';
import { RdsAbstractAutocompleteComponent } from './abstract-autocomplete.component';
import { map, startWith, switchMap } from 'rxjs/operators';
import { takeUntilDestroyed } from '@angular/core/rxjs-interop';
import { RdsChipComponent, RdsChipsModule } from '../chips';
import { FocusKeyManager } from '@angular/cdk/a11y';
import { Directionality } from '@angular/cdk/bidi';
import { merge } from 'rxjs';
import { hasModifierKey } from '@angular/cdk/keycodes';
import * as i0 from "@angular/core";
import * as i1 from "../progress-spinner/progress-spinner.component";
import * as i2 from "../button/icon-button.component";
import * as i3 from "../chips/chip/chip.component";
export class RdsMultiAutocompleteComponent extends RdsAbstractAutocompleteComponent {
    constructor() {
        super(...arguments);
        this.renderer = inject(Renderer2);
        this.elementRef = inject(ElementRef);
        this.dir = inject(Directionality, { optional: true });
        this._value = [];
        this.controlType = 'autocomplete-multi';
        this._multiMinimumInputWidth = this.config.multiMinimumInputWidth;
        this._multiMinimumInputWidthOffset = this.config.multiMinimumInputWidthOffset;
        this.focusedChip = null;
        this.disallowFocusEscape = true;
        this.chipActions = new QueryList();
        this._lastDestroyedFocusedChipIndex = null;
    }
    set multiMinimumInputWidth(width) {
        this._multiMinimumInputWidth = numberAttribute(width, this.config.multiMinimumInputWidth);
    }
    get multiMinimumInputWidth() {
        return this._multiMinimumInputWidth;
    }
    set multiMinimumInputWidthOffset(width) {
        this._multiMinimumInputWidthOffset = numberAttribute(width, this.config.multiMinimumInputWidthOffset);
    }
    get multiMinimumInputWidthOffset() {
        return this._multiMinimumInputWidthOffset;
    }
    set disabled(disabled) {
        super.disabled = disabled;
        this.syncChipsState();
    }
    get disabled() {
        return super.disabled;
    }
    trackByFn(o) {
        if (!this.trackBy) {
            return o;
        }
        if (typeof this.trackBy === 'function') {
            return this.trackBy(o);
        }
        return o[this.trackBy];
    }
    ngAfterViewInit() {
        this.valueContainer.changes
            .pipe(startWith(this.valueContainer), takeUntilDestroyed(this.destroyRef))
            .subscribe(() => this.recalculateInputWidth());
        this.setUpFocusManagement();
        this.trackChipSetChanges();
        this.trackDestroyedFocusedChip();
    }
    handleKeydown(event) {
        if (this.originatesFromChip(event)) {
            this.keyManager.onKeydown(event);
        }
    }
    ngOnDestroy() {
        super.ngOnDestroy();
        this.keyManager?.destroy();
        this.chipActions.destroy();
    }
    set value(value) {
        const oldValue = this.value;
        this._value = value || [];
        if (this.hasAtLeastOneDifferentItem(oldValue, this._value)) {
            this.recalculateInputWidth();
            this.cdr.markForCheck();
        }
    }
    get value() {
        return this._value;
    }
    get values() {
        return this.value || [];
    }
    setValueForClear() {
        this._options = [];
        this.value = [];
        this.updateDropdownOptions();
    }
    onInputKeydown(event) {
        if (this.values.length > 0 &&
            this.getInputFilledValue().length === 0 &&
            event.key === 'Backspace' &&
            !hasModifierKey(event, 'altKey', 'shiftKey', 'ctrlKey', 'metaKey')) {
            this.deselect(this.values[this.value.length - 1]);
        }
        super.onInputKeydown(event);
    }
    select(option) {
        if (!this.disabled && !this.isSelected(option)) {
            const newValue = this._options.filter((o) => this.isSelected(o) || this.compareItem(o, option));
            this.value = [
                ...this.value.filter((o) => !newValue.some((n) => this.compareItem(n, o))),
                ...newValue,
            ];
            this.updateDropdownOptions();
            this.inputEl.nativeElement.value = '';
            this.stateChanges.emit();
        }
    }
    deselect(option) {
        if (!this.disabled && (!option || this.isSelected(option))) {
            if (option) {
                this.value = this.value.filter((o) => !this.compareItem(o, option));
                if (option) {
                    this._options = this._options.filter((o) => !this._newValues.some((newOpt) => this.compareItem(o, newOpt)));
                    this._newValues = this._newValues.filter((v) => !this.compareItem(v, option));
                    this._options = [...this._options, ...this._newValues];
                }
                this.updateDropdownOptions();
            }
            else {
                this.clear();
            }
            this.focusedChip = null;
            this.onValueChange();
        }
    }
    isInputFilled() {
        return this.inputEl?.nativeElement.value.length > 0 || false;
    }
    hide() {
        super.hide();
        if (this.inputEl.nativeElement.value.length === 0) {
            this._search$.next('');
            this._options = [];
        }
    }
    chipFocus(chip) {
        const index = this.chips
            .map((c) => c.getActions())
            .reduce((p, c) => [...p, ...c], [])
            .findIndex((a) => a === chip.getActions()[0]);
        this.keyManager.setActiveItem(index);
    }
    assignInputsToDropdown() {
        this._dropdownInstance.instance.type = 'multi';
        super.assignInputsToDropdown();
    }
    showCaret() {
        return (this.getPlaceholder().trim() === '' &&
            this.inputEl.nativeElement.value.trim() === '' &&
            this.values.length > 0);
    }
    recalculateInputWidth() {
        if (this.autocompleteMulti &&
            this.inputEl &&
            this.valueContainer &&
            this.valueContainer.last &&
            this.inputContainer) {
            const availableWidth = this.autocompleteMulti.nativeElement.getBoundingClientRect().x +
                this.autocompleteMulti.nativeElement.getBoundingClientRect().width -
                this.valueContainer.last.nativeElement.getBoundingClientRect().x -
                this.valueContainer.last.nativeElement.getBoundingClientRect().width -
                this.multiMinimumInputWidthOffset;
            if (availableWidth > this.multiMinimumInputWidth) {
                this.renderer.setStyle(this.inputContainer.nativeElement, 'width', `${availableWidth}px`);
            }
            else {
                this.renderer.setStyle(this.inputContainer.nativeElement, 'width', '100%');
            }
        }
        else if (this.inputContainer) {
            this.renderer.setStyle(this.inputContainer.nativeElement, 'width', '100%');
        }
    }
    originatesFromChip(event) {
        let currentElement = event.target;
        while (currentElement && currentElement !== this.elementRef.nativeElement) {
            if (currentElement.classList.contains('rds-chips__chip')) {
                return true;
            }
            currentElement = currentElement.parentElement;
        }
        return false;
    }
    setUpFocusManagement() {
        // Create a flat `QueryList` containing the actions of all the chips.
        // This allows us to navigate both within the chip and move to the next/previous
        // one using the existing `ListKeyManager`.
        this.chips.changes
            .pipe(startWith(this.chips))
            .subscribe((chips) => {
            const actions = chips
                .map((c) => c.getActions())
                .reduce((p, c) => [...p, ...c], []);
            this.chipActions.reset(actions);
            this.chipActions.notifyOnChanges();
        });
        this.keyManager = new FocusKeyManager(this.chipActions)
            .withVerticalOrientation()
            .withHorizontalOrientation(this.dir ? this.dir.value : 'ltr')
            .withHomeAndEnd()
            .skipPredicate((action) => action.disabled);
        this.keyManager.tabOut.subscribe(() => {
            this.disallowFocusEscape = false;
            this.cdr.markForCheck();
            setTimeout(() => {
                this.disallowFocusEscape = true;
                this.cdr.markForCheck();
            });
        });
        // Keep the manager active index in sync so that navigation picks
        // up from the current chip if the user clicks into the list directly.
        this.chips.changes
            .pipe(startWith(null), switchMap(() => merge(...this.chips.map((c) => c.focus$))), takeUntilDestroyed(this.destroyRef))
            .subscribe(({ source: chip }) => {
            const action = chip.getSourceAction(document.activeElement);
            if (action) {
                this.keyManager.updateActiveItem(action);
            }
        });
        this.chips.changes
            .pipe(startWith(null), switchMap(() => merge(...this.chips.map((c) => c.focus$.pipe(map((e) => ({ focused: true, source: e.source })))), ...this.chips.map((c) => c.blur$.pipe(map((e) => ({ focused: false, source: e.source })))))))
            .subscribe((chip) => {
            if (chip.focused) {
                this.focusedChip = chip.source;
            }
            else if (this.focusedChip === chip.source) {
                this.focusedChip = null;
            }
            this.cdr.markForCheck();
        });
        this.dir?.change
            .pipe(takeUntilDestroyed(this.destroyRef))
            .subscribe((direction) => this.keyManager.withHorizontalOrientation(direction));
    }
    trackDestroyedFocusedChip() {
        this.chips.changes
            .pipe(startWith(null), switchMap(() => merge(...this.chips.map((c) => c.destroyed))), takeUntilDestroyed(this.destroyRef))
            .subscribe((event) => {
            const chipArray = this.chips.toArray();
            const chipIndex = chipArray.indexOf(event.source);
            // If the focused chip is destroyed, save its index so that we can move focus to the next
            // chip. We only save the index here, rather than move the focus immediately, because we want
            // to wait until the chip is removed from the chip list before focusing the next one. This
            // allows us to keep focus on the same index if the chip gets swapped out.
            if (this.isValidIndex(chipIndex) && event.source.hasFocus()) {
                this._lastDestroyedFocusedChipIndex = chipIndex;
            }
        });
    }
    isValidIndex(index) {
        return index >= 0 && index < this.chips.length;
    }
    trackChipSetChanges() {
        this.chips.changes
            .pipe(startWith(null), takeUntilDestroyed(this.destroyRef))
            .subscribe(() => {
            if (this.disabled) {
                // Since this happens after the content has been
                // checked, we need to defer it to the next tick.
                Promise.resolve().then(() => this.syncChipsState());
            }
            this._redirectDestroyedChipFocus();
        });
    }
    syncChipsState() {
        if (this.chips) {
            this.chips.forEach((chip) => {
                chip.disabled = this.disabled;
                chip.cdr.markForCheck();
            });
        }
    }
    _redirectDestroyedChipFocus() {
        if (this._lastDestroyedFocusedChipIndex == null) {
            return;
        }
        if (this.chips.length) {
            const newIndex = Math.min(this._lastDestroyedFocusedChipIndex, this.chips.length - 1);
            const chipToFocus = this.chips.toArray()[newIndex];
            if (chipToFocus.disabled) {
                // If we're down to one disabled chip, move focus back to the set.
                if (this.chips.length === 1) {
                    this.focus();
                }
                else {
                    this.keyManager.setPreviousItemActive();
                }
            }
            else {
                chipToFocus.focus();
            }
        }
        else {
            Promise.resolve().then(() => this.focus());
        }
        this._lastDestroyedFocusedChipIndex = null;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.1", ngImport: i0, type: RdsMultiAutocompleteComponent, deps: null, target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "17.3.1", type: RdsMultiAutocompleteComponent, isStandalone: true, selector: "rds-multi-autocomplete", inputs: { multiMinimumInputWidth: "multiMinimumInputWidth", multiMinimumInputWidthOffset: "multiMinimumInputWidthOffset", disabled: "disabled", trackBy: "trackBy" }, host: { listeners: { "keydown": "handleKeydown($event)" } }, providers: [
            {
                provide: RdsAbstractFormFieldControl,
                useExisting: forwardRef(() => RdsMultiAutocompleteComponent),
            },
        ], viewQueries: [{ propertyName: "autocompleteMulti", first: true, predicate: ["autocompleteMulti"], descendants: true, read: ElementRef }, { propertyName: "valueContainer", predicate: ["valueContainer"], descendants: true, read: ElementRef }, { propertyName: "chips", predicate: RdsChipComponent, descendants: true }], usesInheritance: true, ngImport: i0, template: `
    <div
      class="rds-autocomplete rds-autocomplete-{{
        formField.size
      }} rds-autocomplete-multi"
      #autocomplate
      (click)="inputEl.focus(); show()"
      [class.rds-autocomplete-typing]="typing | async"
      [class.rds-autocomplete-floating-label]="
        formField.labelPosition === 'floating'
      "
      [class.rds-autocomplete-has-value]="hasValue()"
    >
      <div #autocompleteMulti class="rds-autocomplete-multi-container">
        @for (o of values; track trackByFn(o)) {
          <rds-chip
            #valueContainer
            size="s"
            closable
            [tabindex]="
              (!focusedChip || focusedChip === valueContainer) &&
              disallowFocusEscape
                ? 0
                : -1
            "
            (focus)="chipFocus(valueContainer)"
            (closeChip)="deselect(o)"
            >{{ getDisplayProperty(o) }}
          </rds-chip>
        }
        <div
          class="rds-autocomplete-input-container"
          #inputContainer
          [class.rds-form-field__control-show-caret]="showCaret()"
          [class.rds-form-field__control-disabled]="ngControl?.disabled"
          [class.rds-form-field__control-focused]="_focused"
        >
          <input
            [placeholder]="getPlaceholder()"
            [disabled]="attrDisabled"
            [attr.aria-invalid]="errorState"
            [attr.aria-describedby]="inputAriaDescribedBy"
            autocomplete="off"
            class="rds-form-field__control"
            #inputEl
            (keydown.shift.tab)="addNewItemOnBlurAndHide()"
            (keydown.tab)="addNewItemOnBlurAndHide()"
            (blur)="focusChanged(false)"
            (focus)="focusChanged(true)"
            (input)="search()"
            (keydown)="onInputKeydown($event)"
          />
        </div>
      </div>
      <div class="rds-autocomplete-icon-container">
        @if (values.length > 0 || inputEl.value) {
          <button
            rds-icon-button
            [disabled]="ngControl?.disabled"
            (click)="clearValue($event)"
          >
            <rds-icon namespace="outlined" icon="close" />
          </button>
        }
        @if (loading | async) {
          <rds-progress-spinner size="s" />
        } @else {
          <rds-icon
            namespace="outlined"
            [icon]="_open ? 'caret_up' : 'caret_down'"
          />
        }
      </div>
    </div>
  `, isInline: true, styles: [".rds-autocomplete{display:flex;justify-content:space-between;align-items:center;height:100%}.rds-autocomplete .rds-autocomplete-input-container{align-items:center;display:flex;width:100%}.rds-autocomplete .rds-autocomplete-input-container.rds-form-field__control-show-caret:not(.rds-form-field__control-disabled){position:relative}.rds-autocomplete .rds-autocomplete-input-container.rds-form-field__control-show-caret:not(.rds-form-field__control-disabled):before{position:absolute;left:0;top:calc((100% - 24px)/2);content:\"\";height:24px;width:1px;border-left:1px solid var(--rds-color-high-contrast)}.rds-autocomplete .rds-autocomplete-input-container.rds-form-field__control-show-caret:not(.rds-form-field__control-disabled).rds-form-field__control-focused:before{display:none}.rds-autocomplete .rds-autocomplete-icon-container{display:flex;align-items:center;height:24px}.rds-autocomplete.rds-autocomplete-disabled .rds-autocomplete-icon-container{color:var(--rds-color-disabled)}.rds-autocomplete.rds-autocomplete-multi .rds-autocomplete-multi-container{display:flex;flex-wrap:wrap;width:100%}.rds-autocomplete.rds-autocomplete-floating-label.rds-autocomplete-multi.rds-autocomplete-floating-label .rds-autocomplete-multi-container{margin-top:16px}.rds-autocomplete.rds-autocomplete-l .rds-autocomplete-input-container.rds-form-field__control-show-caret:not(.rds-form-field__control-disabled):before{top:calc((100% - 24px)/2);height:24px}.rds-autocomplete.rds-autocomplete-l.rds-autocomplete-multi,.rds-autocomplete.rds-autocomplete-l.rds-autocomplete-multi .rds-autocomplete-multi-container{gap:4px}.rds-autocomplete.rds-autocomplete-l .rds-autocomplete-icon-container{gap:8px;margin-left:8px}.rds-autocomplete.rds-autocomplete-m .rds-autocomplete-input-container.rds-form-field__control-show-caret:not(.rds-form-field__control-disabled):before{top:calc((100% - 24px)/2);height:24px}.rds-autocomplete.rds-autocomplete-m.rds-autocomplete-multi,.rds-autocomplete.rds-autocomplete-m.rds-autocomplete-multi .rds-autocomplete-multi-container{gap:4px}.rds-autocomplete.rds-autocomplete-m .rds-autocomplete-icon-container{gap:8px;margin-left:8px}.rds-autocomplete.rds-autocomplete-s .rds-autocomplete-input-container.rds-form-field__control-show-caret:not(.rds-form-field__control-disabled):before{top:calc((100% - 20px)/2);height:20px}.rds-autocomplete.rds-autocomplete-s.rds-autocomplete-multi,.rds-autocomplete.rds-autocomplete-s.rds-autocomplete-multi .rds-autocomplete-multi-container{gap:4px}.rds-autocomplete.rds-autocomplete-s .rds-autocomplete-icon-container{gap:8px;margin-left:8px}\n"], dependencies: [{ kind: "pipe", type: AsyncPipe, name: "async" }, { kind: "ngmodule", type: RdsProgressSpinnerModule }, { kind: "component", type: i1.RdsProgressSpinnerComponent, selector: "rds-progress-spinner", inputs: ["value", "minValue", "maxValue", "mode", "size", "label", "white"] }, { kind: "component", type: RdsIconComponent, selector: "rds-icon", inputs: ["namespace", "icon"] }, { kind: "ngmodule", type: RdsButtonModule }, { kind: "component", type: i2.RdsIconButtonComponent, selector: "\n    button[rds-icon-button],\n    button[rdsIconButton],\n    button[rds-icon-warning-button],\n    button[rdsIconWarningButton],\n  ", inputs: ["size"] }, { kind: "ngmodule", type: RdsChipsModule }, { kind: "component", type: i3.RdsChipComponent, selector: "rds-chip, button[rds-chip], button[rdsChip]", inputs: ["ariaLabelCloseButton", "size", "type", "role", "disabled", "closable", "value"], outputs: ["closeChip", "destroyed"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.1", ngImport: i0, type: RdsMultiAutocompleteComponent, decorators: [{
            type: Component,
            args: [{ selector: 'rds-multi-autocomplete', changeDetection: ChangeDetectionStrategy.OnPush, template: `
    <div
      class="rds-autocomplete rds-autocomplete-{{
        formField.size
      }} rds-autocomplete-multi"
      #autocomplate
      (click)="inputEl.focus(); show()"
      [class.rds-autocomplete-typing]="typing | async"
      [class.rds-autocomplete-floating-label]="
        formField.labelPosition === 'floating'
      "
      [class.rds-autocomplete-has-value]="hasValue()"
    >
      <div #autocompleteMulti class="rds-autocomplete-multi-container">
        @for (o of values; track trackByFn(o)) {
          <rds-chip
            #valueContainer
            size="s"
            closable
            [tabindex]="
              (!focusedChip || focusedChip === valueContainer) &&
              disallowFocusEscape
                ? 0
                : -1
            "
            (focus)="chipFocus(valueContainer)"
            (closeChip)="deselect(o)"
            >{{ getDisplayProperty(o) }}
          </rds-chip>
        }
        <div
          class="rds-autocomplete-input-container"
          #inputContainer
          [class.rds-form-field__control-show-caret]="showCaret()"
          [class.rds-form-field__control-disabled]="ngControl?.disabled"
          [class.rds-form-field__control-focused]="_focused"
        >
          <input
            [placeholder]="getPlaceholder()"
            [disabled]="attrDisabled"
            [attr.aria-invalid]="errorState"
            [attr.aria-describedby]="inputAriaDescribedBy"
            autocomplete="off"
            class="rds-form-field__control"
            #inputEl
            (keydown.shift.tab)="addNewItemOnBlurAndHide()"
            (keydown.tab)="addNewItemOnBlurAndHide()"
            (blur)="focusChanged(false)"
            (focus)="focusChanged(true)"
            (input)="search()"
            (keydown)="onInputKeydown($event)"
          />
        </div>
      </div>
      <div class="rds-autocomplete-icon-container">
        @if (values.length > 0 || inputEl.value) {
          <button
            rds-icon-button
            [disabled]="ngControl?.disabled"
            (click)="clearValue($event)"
          >
            <rds-icon namespace="outlined" icon="close" />
          </button>
        }
        @if (loading | async) {
          <rds-progress-spinner size="s" />
        } @else {
          <rds-icon
            namespace="outlined"
            [icon]="_open ? 'caret_up' : 'caret_down'"
          />
        }
      </div>
    </div>
  `, providers: [
                        {
                            provide: RdsAbstractFormFieldControl,
                            useExisting: forwardRef(() => RdsMultiAutocompleteComponent),
                        },
                    ], standalone: true, imports: [
                        AsyncPipe,
                        RdsProgressSpinnerModule,
                        RdsIconComponent,
                        RdsButtonModule,
                        RdsChipsModule,
                    ], styles: [".rds-autocomplete{display:flex;justify-content:space-between;align-items:center;height:100%}.rds-autocomplete .rds-autocomplete-input-container{align-items:center;display:flex;width:100%}.rds-autocomplete .rds-autocomplete-input-container.rds-form-field__control-show-caret:not(.rds-form-field__control-disabled){position:relative}.rds-autocomplete .rds-autocomplete-input-container.rds-form-field__control-show-caret:not(.rds-form-field__control-disabled):before{position:absolute;left:0;top:calc((100% - 24px)/2);content:\"\";height:24px;width:1px;border-left:1px solid var(--rds-color-high-contrast)}.rds-autocomplete .rds-autocomplete-input-container.rds-form-field__control-show-caret:not(.rds-form-field__control-disabled).rds-form-field__control-focused:before{display:none}.rds-autocomplete .rds-autocomplete-icon-container{display:flex;align-items:center;height:24px}.rds-autocomplete.rds-autocomplete-disabled .rds-autocomplete-icon-container{color:var(--rds-color-disabled)}.rds-autocomplete.rds-autocomplete-multi .rds-autocomplete-multi-container{display:flex;flex-wrap:wrap;width:100%}.rds-autocomplete.rds-autocomplete-floating-label.rds-autocomplete-multi.rds-autocomplete-floating-label .rds-autocomplete-multi-container{margin-top:16px}.rds-autocomplete.rds-autocomplete-l .rds-autocomplete-input-container.rds-form-field__control-show-caret:not(.rds-form-field__control-disabled):before{top:calc((100% - 24px)/2);height:24px}.rds-autocomplete.rds-autocomplete-l.rds-autocomplete-multi,.rds-autocomplete.rds-autocomplete-l.rds-autocomplete-multi .rds-autocomplete-multi-container{gap:4px}.rds-autocomplete.rds-autocomplete-l .rds-autocomplete-icon-container{gap:8px;margin-left:8px}.rds-autocomplete.rds-autocomplete-m .rds-autocomplete-input-container.rds-form-field__control-show-caret:not(.rds-form-field__control-disabled):before{top:calc((100% - 24px)/2);height:24px}.rds-autocomplete.rds-autocomplete-m.rds-autocomplete-multi,.rds-autocomplete.rds-autocomplete-m.rds-autocomplete-multi .rds-autocomplete-multi-container{gap:4px}.rds-autocomplete.rds-autocomplete-m .rds-autocomplete-icon-container{gap:8px;margin-left:8px}.rds-autocomplete.rds-autocomplete-s .rds-autocomplete-input-container.rds-form-field__control-show-caret:not(.rds-form-field__control-disabled):before{top:calc((100% - 20px)/2);height:20px}.rds-autocomplete.rds-autocomplete-s.rds-autocomplete-multi,.rds-autocomplete.rds-autocomplete-s.rds-autocomplete-multi .rds-autocomplete-multi-container{gap:4px}.rds-autocomplete.rds-autocomplete-s .rds-autocomplete-icon-container{gap:8px;margin-left:8px}\n"] }]
        }], propDecorators: { multiMinimumInputWidth: [{
                type: Input
            }], multiMinimumInputWidthOffset: [{
                type: Input
            }], disabled: [{
                type: Input
            }], trackBy: [{
                type: Input
            }], valueContainer: [{
                type: ViewChildren,
                args: ['valueContainer', { read: ElementRef }]
            }], autocompleteMulti: [{
                type: ViewChild,
                args: ['autocompleteMulti', { read: ElementRef }]
            }], chips: [{
                type: ViewChildren,
                args: [RdsChipComponent]
            }], handleKeydown: [{
                type: HostListener,
                args: ['keydown', ['$event']]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXVsdGktYXV0b2NvbXBsZXRlLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL2xpYnMvYW5ndWxhci1jb21wb25lbnRzL3NyYy9saWIvYXV0b2NvbXBsZXRlL211bHRpLWF1dG9jb21wbGV0ZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUVMLHVCQUF1QixFQUN2QixTQUFTLEVBQ1QsVUFBVSxFQUNWLFVBQVUsRUFDVixZQUFZLEVBQ1osTUFBTSxFQUNOLEtBQUssRUFDTCxlQUFlLEVBRWYsU0FBUyxFQUNULFNBQVMsRUFDVCxTQUFTLEVBQ1QsWUFBWSxHQUNiLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUM1QyxPQUFPLEVBQUUsMkJBQTJCLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDNUQsT0FBTyxFQUFFLHdCQUF3QixFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDL0QsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sVUFBVSxDQUFDO0FBQzVDLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFDNUMsT0FBTyxFQUFFLGdDQUFnQyxFQUFFLE1BQU0sbUNBQW1DLENBQUM7QUFDckYsT0FBTyxFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDM0QsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDaEUsT0FBTyxFQUFFLGdCQUFnQixFQUFFLGNBQWMsRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUk1RCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDcEQsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ25ELE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxNQUFNLENB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QUEyQjs0QkFDcEMsV0FBVyxFQUFFLFVBQVUsQ0FBQyxHQUFHLEVBQUUsOEJBQThCLENBQUM7eUJBQzdEO3FCQUNGLGNBQ1csSUFBSSxXQUNQO3dCQUNQLFNBQVM7d0JBQ1Qsd0JBQXdCO3dCQUN4QixnQkFBZ0I7d0JBQ2hCLGVBQWU7d0JBQ2YsY0FBYztxQkFDZjs4QkFhWSxzQkFBc0I7c0JBQWxDLEtBQUs7Z0JBYU8sNEJBQTRCO3NCQUF4QyxLQUFLO2dCQWVPLFFBQVE7c0JBRHBCLEtBQUs7Z0JBV04sT0FBTztzQkFETixLQUFLO2dCQWdCSSxjQUFjO3NCQUR2QixZQUFZO3VCQUFDLGdCQUFnQixFQUFFLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRTtnQkFHMUMsaUJBQWlCO3NCQUQxQixTQUFTO3VCQUFDLG1CQUFtQixFQUFFLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRTtnQkFFcEIsS0FBSztzQkFBcEMsWUFBWTt1QkFBQyxnQkFBZ0I7Z0JBa0I5QixhQUFhO3NCQURaLFlBQVk7dUJBQUMsU0FBUyxFQUFFLENBQUMsUUFBUSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQWZ0ZXJWaWV3SW5pdCxcbiAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG4gIENvbXBvbmVudCxcbiAgRWxlbWVudFJlZixcbiAgZm9yd2FyZFJlZixcbiAgSG9zdExpc3RlbmVyLFxuICBpbmplY3QsXG4gIElucHV0LFxuICBudW1iZXJBdHRyaWJ1dGUsXG4gIE9uRGVzdHJveSxcbiAgUXVlcnlMaXN0LFxuICBSZW5kZXJlcjIsXG4gIFZpZXdDaGlsZCxcbiAgVmlld0NoaWxkcmVuLFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEFzeW5jUGlwZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyBSZHNBYnN0cmFjdEZvcm1GaWVsZENvbnRyb2wgfSBmcm9tICcuLi9mb3JtLWZpZWxkJztcbmltcG9ydCB7IFJkc1Byb2dyZXNzU3Bpbm5lck1vZHVsZSB9IGZyb20gJy4uL3Byb2dyZXNzLXNwaW5uZXInO1xuaW1wb3J0IHsgUmRzSWNvbkNvbXBvbmVudCB9IGZyb20gJy4uL2ljb25zJztcbmltcG9ydCB7IFJkc0J1dHRvbk1vZHVsZSB9IGZyb20gJy4uL2J1dHRvbic7XG5pbXBvcnQgeyBSZHNBYnN0cmFjdEF1dG9jb21wbGV0ZUNvbXBvbmVudCB9IGZyb20gJy4vYWJzdHJhY3QtYXV0b2NvbXBsZXRlLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBtYXAsIHN0YXJ0V2l0aCwgc3dpdGNoTWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgdGFrZVVudGlsRGVzdHJveWVkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZS9yeGpzLWludGVyb3AnO1xuaW1wb3J0IHsgUmRzQ2hpcENvbXBvbmVudCwgUmRzQ2hpcHNNb2R1bGUgfSBmcm9tICcuLi9jaGlwcyc7XG5pbXBvcnQgeyBSZHNDb250cm9sVHlwZSB9IGZyb20gJy4uL2Zvcm0tZmllbGQvY29udHJvbC50eXBlJztcbmltcG9ydCB7IEJvb2xlYW5JbnB1dCwgTnVtYmVySW5wdXQgfSBmcm9tICdAYW5ndWxhci9jZGsvY29lcmNpb24nO1xuaW1wb3J0IHsgUmRzQ2hpcEFjdGlvbkRpcmVjdGl2ZSB9IGZyb20gJy4uL2NoaXBzJztcbmltcG9ydCB7IEZvY3VzS2V5TWFuYWdlciB9IGZyb20gJ0Bhbmd1bGFyL2Nkay9hMTF5JztcbmltcG9ydCB7IERpcmVjdGlvbmFsaXR5IH0gZnJvbSAnQGFuZ3VsYXIvY2RrL2JpZGknO1xuaW1wb3J0IHsgbWVyZ2UgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IGhhc01vZGlmaWVyS2V5IH0gZnJvbSAnQGFuZ3VsYXIvY2RrL2tleWNvZGVzJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAncmRzLW11bHRpLWF1dG9jb21wbGV0ZScsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxuICB0ZW1wbGF0ZTogYFxuICAgIDxkaXZcbiAgICAgIGNsYXNzPVwicmRzLWF1dG9jb21wbGV0ZSByZHMtYXV0b2NvbXBsZXRlLXt7XG4gICAgICAgIGZvcm1GaWVsZC5zaXplXG4gICAgICB9fSByZHMtYXV0b2NvbXBsZXRlLW11bHRpXCJcbiAgICAgICNhdXRvY29tcGxhdGVcbiAgICAgIChjbGljayk9XCJpbnB1dEVsLmZvY3VzKCk7IHNob3coKVwiXG4gICAgICBbY2xhc3MucmRzLWF1dG9jb21wbGV0ZS10eXBpbmddPVwidHlwaW5nIHwgYXN5bmNcIlxuICAgICAgW2NsYXNzLnJkcy1hdXRvY29tcGxldGUtZmxvYXRpbmctbGFiZWxdPVwiXG4gICAgICAgIGZvcm1GaWVsZC5sYWJlbFBvc2l0aW9uID09PSAnZmxvYXRpbmcnXG4gICAgICBcIlxuICAgICAgW2NsYXNzLnJkcy1hdXRvY29tcGxldGUtaGFzLXZhbHVlXT1cImhhc1ZhbHVlKClcIlxuICAgID5cbiAgICAgIDxkaXYgI2F1dG9jb21wbGV0ZU11bHRpIGNsYXNzPVwicmRzLWF1dG9jb21wbGV0ZS1tdWx0aS1jb250YWluZXJcIj5cbiAgICAgICAgQGZvciAobyBvZiB2YWx1ZXM7IHRyYWNrIHRyYWNrQnlGbihvKSkge1xuICAgICAgICAgIDxyZHMtY2hpcFxuICAgICAgICAgICAgI3ZhbHVlQ29udGFpbmVyXG4gICAgICAgICAgICBzaXplPVwic1wiXG4gICAgICAgICAgICBjbG9zYWJsZVxuICAgICAgICAgICAgW3RhYmluZGV4XT1cIlxuICAgICAgICAgICAgICAoIWZvY3VzZWRDaGlwIHx8IGZvY3VzZWRDaGlwID09PSB2YWx1ZUNvbnRhaW5lcikgJiZcbiAgICAgICAgICAgICAgZGlzYWxsb3dGb2N1c0VzY2FwZVxuICAgICAgICAgICAgICAgID8gMFxuICAgICAgICAgICAgICAgIDogLTFcbiAgICAgICAgICAgIFwiXG4gICAgICAgICAgICAoZm9jdXMpPVwiY2hpcEZvY3VzKHZhbHVlQ29udGFpbmVyKVwiXG4gICAgICAgICAgICAoY2xvc2VDaGlwKT1cImRlc2VsZWN0KG8pXCJcbiAgICAgICAgICAgID57eyBnZXREaXNwbGF5UHJvcGVydHkobykgfX1cbiAgICAgICAgICA8L3Jkcy1jaGlwPlxuICAgICAgICB9XG4gICAgICAgIDxkaXZcbiAgICAgICAgICBjbGFzcz1cInJkcy1hdXRvY29tcGxldGUtaW5wdXQtY29udGFpbmVyXCJcbiAgICAgICAgICAjaW5wdXRDb250YWluZXJcbiAgICAgICAgICBbY2xhc3MucmRzLWZvcm0tZmllbGRfX2NvbnRyb2wtc2hvdy1jYXJldF09XCJzaG93Q2FyZXQoKVwiXG4gICAgICAgICAgW2NsYXNzLnJkcy1mb3JtLWZpZWxkX19jb250cm9sLWRpc2FibGVkXT1cIm5nQ29udHJvbD8uZGlzYWJsZWRcIlxuICAgICAgICAgIFtjbGFzcy5yZHMtZm9ybS1maWVsZF9fY29udHJvbC1mb2N1c2VkXT1cIl9mb2N1c2VkXCJcbiAgICAgICAgPlxuICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgW3BsYWNlaG9sZGVyXT1cImdldFBsYWNlaG9sZGVyKClcIlxuICAgICAgICAgICAgW2Rpc2FibGVkXT1cImF0dHJEaXNhYmxlZFwiXG4gICAgICAgICAgICBbYXR0ci5hcmlhLWludmFsaWRdPVwiZXJyb3JTdGF0ZVwiXG4gICAgICAgICAgICBbYXR0ci5hcmlhLWRlc2NyaWJlZGJ5XT1cImlucHV0QXJpYURlc2NyaWJlZEJ5XCJcbiAgICAgICAgICAgIGF1dG9jb21wbGV0ZT1cIm9mZlwiXG4gICAgICAgICAgICBjbGFzcz1cInJkcy1mb3JtLWZpZWxkX19jb250cm9sXCJcbiAgICAgICAgICAgICNpbnB1dEVsXG4gICAgICAgICAgICAoa2V5ZG93bi5zaGlmdC50YWIpPVwiYWRkTmV3SXRlbU9uQmx1ckFuZEhpZGUoKVwiXG4gICAgICAgICAgICAoa2V5ZG93bi50YWIpPVwiYWRkTmV3SXRlbU9uQmx1ckFuZEhpZGUoKVwiXG4gICAgICAgICAgICAoYmx1cik9XCJmb2N1c0NoYW5nZWQoZmFsc2UpXCJcbiAgICAgICAgICAgIChmb2N1cyk9XCJmb2N1c0NoYW5nZWQodHJ1ZSlcIlxuICAgICAgICAgICAgKGlucHV0KT1cInNlYXJjaCgpXCJcbiAgICAgICAgICAgIChrZXlkb3duKT1cIm9uSW5wdXRLZXlkb3duKCRldmVudClcIlxuICAgICAgICAgIC8+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzPVwicmRzLWF1dG9jb21wbGV0ZS1pY29uLWNvbnRhaW5lclwiPlxuICAgICAgICBAaWYgKHZhbHVlcy5sZW5ndGggPiAwIHx8IGlucHV0RWwudmFsdWUpIHtcbiAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICByZHMtaWNvbi1idXR0b25cbiAgICAgICAgICAgIFtkaXNhYmxlZF09XCJuZ0NvbnRyb2w/LmRpc2FibGVkXCJcbiAgICAgICAgICAgIChjbGljayk9XCJjbGVhclZhbHVlKCRldmVudClcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxyZHMtaWNvbiBuYW1lc3BhY2U9XCJvdXRsaW5lZFwiIGljb249XCJjbG9zZVwiIC8+XG4gICAgICAgICAgPC9idXR0b24+XG4gICAgICAgIH1cbiAgICAgICAgQGlmIChsb2FkaW5nIHwgYXN5bmMpIHtcbiAgICAgICAgICA8cmRzLXByb2dyZXNzLXNwaW5uZXIgc2l6ZT1cInNcIiAvPlxuICAgICAgICB9IEBlbHNlIHtcbiAgICAgICAgICA8cmRzLWljb25cbiAgICAgICAgICAgIG5hbWVzcGFjZT1cIm91dGxpbmVkXCJcbiAgICAgICAgICAgIFtpY29uXT1cIl9vcGVuID8gJ2NhcmV0X3VwJyA6ICdjYXJldF9kb3duJ1wiXG4gICAgICAgICAgLz5cbiAgICAgICAgfVxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIGAsXG4gIHN0eWxlVXJsczogWycuL2F1dG9jb21wbGV0ZS5jb21wb25lbnQuc2NzcyddLFxuICBwcm92aWRlcnM6IFtcbiAgICB7XG4gICAgICBwcm92aWRlOiBSZHNBYnN0cmFjdEZvcm1GaWVsZENvbnRyb2wsXG4gICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBSZHNNdWx0aUF1dG9jb21wbGV0ZUNvbXBvbmVudCksXG4gICAgfSxcbiAgXSxcbiAgc3RhbmRhbG9uZTogdHJ1ZSxcbiAgaW1wb3J0czogW1xuICAgIEFzeW5jUGlwZSxcbiAgICBSZHNQcm9ncmVzc1NwaW5uZXJNb2R1bGUsXG4gICAgUmRzSWNvbkNvbXBvbmVudCxcbiAgICBSZHNCdXR0b25Nb2R1bGUsXG4gICAgUmRzQ2hpcHNNb2R1bGUsXG4gIF0sXG59KVxuZXhwb3J0IGNsYXNzIFJkc011bHRpQXV0b2NvbXBsZXRlQ29tcG9uZW50PFQ+XG4gIGV4dGVuZHMgUmRzQWJzdHJhY3RBdXRvY29tcGxldGVDb21wb25lbnQ8VCwgVFtdPlxuICBpbXBsZW1lbnRzIEFmdGVyVmlld0luaXQsIE9uRGVzdHJveVxue1xuICBwcml2YXRlIHJlYWRvbmx5IHJlbmRlcmVyID0gaW5qZWN0KFJlbmRlcmVyMik7XG4gIHByaXZhdGUgcmVhZG9ubHkgZWxlbWVudFJlZiA9IGluamVjdChFbGVtZW50UmVmKTtcbiAgcHJpdmF0ZSByZWFkb25seSBkaXIgPSBpbmplY3QoRGlyZWN0aW9uYWxpdHksIHsgb3B0aW9uYWw6IHRydWUgfSk7XG5cbiAgcHJvdGVjdGVkIG92ZXJyaWRlIF92YWx1ZTogVFtdID0gW107XG4gIG92ZXJyaWRlIGNvbnRyb2xUeXBlOiBSZHNDb250cm9sVHlwZSA9ICdhdXRvY29tcGxldGUtbXVsdGknO1xuXG4gIEBJbnB1dCgpIHNldCBtdWx0aU1pbmltdW1JbnB1dFdpZHRoKHdpZHRoOiBOdW1iZXJJbnB1dCkge1xuICAgIHRoaXMuX211bHRpTWluaW11bUlucHV0V2lkdGggPSBudW1iZXJBdHRyaWJ1dGUoXG4gICAgICB3aWR0aCxcbiAgICAgIHRoaXMuY29uZmlnLm11bHRpTWluaW11bUlucHV0V2lkdGgsXG4gICAgKTtcbiAgfVxuXG4gIGdldCBtdWx0aU1pbmltdW1JbnB1dFdpZHRoKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuX211bHRpTWluaW11bUlucHV0V2lkdGg7XG4gIH1cblxuICBwcml2YXRlIF9tdWx0aU1pbmltdW1JbnB1dFdpZHRoID0gdGhpcy5jb25maWcubXVsdGlNaW5pbXVtSW5wdXRXaWR0aDtcblxuICBASW5wdXQoKSBzZXQgbXVsdGlNaW5pbXVtSW5wdXRXaWR0aE9mZnNldCh3aWR0aDogTnVtYmVySW5wdXQpIHtcbiAgICB0aGlzLl9tdWx0aU1pbmltdW1JbnB1dFdpZHRoT2Zmc2V0ID0gbnVtYmVyQXR0cmlidXRlKFxuICAgICAgd2lkdGgsXG4gICAgICB0aGlzLmNvbmZpZy5tdWx0aU1pbmltdW1JbnB1dFdpZHRoT2Zmc2V0LFxuICAgICk7XG4gIH1cblxuICBnZXQgbXVsdGlNaW5pbXVtSW5wdXRXaWR0aE9mZnNldCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9tdWx0aU1pbmltdW1JbnB1dFdpZHRoT2Zmc2V0O1xuICB9XG5cbiAgcHJpdmF0ZSBfbXVsdGlNaW5pbXVtSW5wdXRXaWR0aE9mZnNldCA9XG4gICAgdGhpcy5jb25maWcubXVsdGlNaW5pbXVtSW5wdXRXaWR0aE9mZnNldDtcblxuICBASW5wdXQoKVxuICBvdmVycmlkZSBzZXQgZGlzYWJsZWQoZGlzYWJsZWQ6IEJvb2xlYW5JbnB1dCkge1xuICAgIHN1cGVyLmRpc2FibGVkID0gZGlzYWJsZWQ7XG4gICAgdGhpcy5zeW5jQ2hpcHNTdGF0ZSgpO1xuICB9XG5cbiAgb3ZlcnJpZGUgZ2V0IGRpc2FibGVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBzdXBlci5kaXNhYmxlZDtcbiAgfVxuXG4gIEBJbnB1dCgpXG4gIHRyYWNrQnk6IGtleW9mIFQgfCAoKG86IFQpID0+IHVua25vd24pO1xuXG4gIHByb3RlY3RlZCB0cmFja0J5Rm4obzogVCk6IHVua25vd24ge1xuICAgIGlmICghdGhpcy50cmFja0J5KSB7XG4gICAgICByZXR1cm4gbztcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIHRoaXMudHJhY2tCeSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgcmV0dXJuIHRoaXMudHJhY2tCeShvKTtcbiAgICB9XG5cbiAgICByZXR1cm4gb1t0aGlzLnRyYWNrQnldO1xuICB9XG5cbiAgQFZpZXdDaGlsZHJlbigndmFsdWVDb250YWluZXInLCB7IHJlYWQ6IEVsZW1lbnRSZWYgfSlcbiAgcHJvdGVjdGVkIHZhbHVlQ29udGFpbmVyOiBRdWVyeUxpc3Q8RWxlbWVudFJlZjxIVE1MRWxlbWVudD4+O1xuICBAVmlld0NoaWxkKCdhdXRvY29tcGxldGVNdWx0aScsIHsgcmVhZDogRWxlbWVudFJlZiB9KVxuICBwcm90ZWN0ZWQgYXV0b2NvbXBsZXRlTXVsdGk6IEVsZW1lbnRSZWY8SFRNTEVsZW1lbnQ+O1xuICBAVmlld0NoaWxkcmVuKFJkc0NoaXBDb21wb25lbnQpIGNoaXBzOiBRdWVyeUxpc3Q8UmRzQ2hpcENvbXBvbmVudDxUPj47XG5cbiAgcHJvdGVjdGVkIGZvY3VzZWRDaGlwOiBSZHNDaGlwQ29tcG9uZW50PFQ+IHwgbnVsbCA9IG51bGw7XG4gIHByb3RlY3RlZCBkaXNhbGxvd0ZvY3VzRXNjYXBlID0gdHJ1ZTtcbiAgcHJpdmF0ZSBrZXlNYW5hZ2VyOiBGb2N1c0tleU1hbmFnZXI8UmRzQ2hpcEFjdGlvbkRpcmVjdGl2ZT47XG4gIHByaXZhdGUgcmVhZG9ubHkgY2hpcEFjdGlvbnMgPSBuZXcgUXVlcnlMaXN0PFJkc0NoaXBBY3Rpb25EaXJlY3RpdmU+KCk7XG4gIHByaXZhdGUgX2xhc3REZXN0cm95ZWRGb2N1c2VkQ2hpcEluZGV4OiBudW1iZXIgfCBudWxsID0gbnVsbDtcblxuICBuZ0FmdGVyVmlld0luaXQoKTogdm9pZCB7XG4gICAgdGhpcy52YWx1ZUNvbnRhaW5lci5jaGFuZ2VzXG4gICAgICAucGlwZShzdGFydFdpdGgodGhpcy52YWx1ZUNvbnRhaW5lciksIHRha2VVbnRpbERlc3Ryb3llZCh0aGlzLmRlc3Ryb3lSZWYpKVxuICAgICAgLnN1YnNjcmliZSgoKSA9PiB0aGlzLnJlY2FsY3VsYXRlSW5wdXRXaWR0aCgpKTtcbiAgICB0aGlzLnNldFVwRm9jdXNNYW5hZ2VtZW50KCk7XG4gICAgdGhpcy50cmFja0NoaXBTZXRDaGFuZ2VzKCk7XG4gICAgdGhpcy50cmFja0Rlc3Ryb3llZEZvY3VzZWRDaGlwKCk7XG4gIH1cblxuICBASG9zdExpc3RlbmVyKCdrZXlkb3duJywgWyckZXZlbnQnXSlcbiAgaGFuZGxlS2V5ZG93bihldmVudDogS2V5Ym9hcmRFdmVudCk6IHZvaWQge1xuICAgIGlmICh0aGlzLm9yaWdpbmF0ZXNGcm9tQ2hpcChldmVudCkpIHtcbiAgICAgIHRoaXMua2V5TWFuYWdlci5vbktleWRvd24oZXZlbnQpO1xuICAgIH1cbiAgfVxuXG4gIG92ZXJyaWRlIG5nT25EZXN0cm95KCk6IHZvaWQge1xuICAgIHN1cGVyLm5nT25EZXN0cm95KCk7XG4gICAgdGhpcy5rZXlNYW5hZ2VyPy5kZXN0cm95KCk7XG4gICAgdGhpcy5jaGlwQWN0aW9ucy5kZXN0cm95KCk7XG4gIH1cblxuICBvdmVycmlkZSBzZXQgdmFsdWUodmFsdWU6IFRbXSkge1xuICAgIGNvbnN0IG9sZFZhbHVlID0gdGhpcy52YWx1ZTtcbiAgICB0aGlzLl92YWx1ZSA9IHZhbHVlIHx8IFtdO1xuXG4gICAgaWYgKHRoaXMuaGFzQXRMZWFzdE9uZURpZmZlcmVudEl0ZW0ob2xkVmFsdWUsIHRoaXMuX3ZhbHVlKSkge1xuICAgICAgdGhpcy5yZWNhbGN1bGF0ZUlucHV0V2lkdGgoKTtcbiAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgfVxuXG4gIG92ZXJyaWRlIGdldCB2YWx1ZSgpOiBUW10ge1xuICAgIHJldHVybiB0aGlzLl92YWx1ZTtcbiAgfVxuXG4gIG92ZXJyaWRlIGdldCB2YWx1ZXMoKTogVFtdIHtcbiAgICByZXR1cm4gdGhpcy52YWx1ZSB8fCBbXTtcbiAgfVxuXG4gIHByb3RlY3RlZCBvdmVycmlkZSBzZXRWYWx1ZUZvckNsZWFyKCk6IHZvaWQge1xuICAgIHRoaXMuX29wdGlvbnMgPSBbXTtcbiAgICB0aGlzLnZhbHVlID0gW107XG4gICAgdGhpcy51cGRhdGVEcm9wZG93bk9wdGlvbnMoKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBvdmVycmlkZSBvbklucHV0S2V5ZG93bihldmVudDogS2V5Ym9hcmRFdmVudCk6IHZvaWQge1xuICAgIGlmIChcbiAgICAgIHRoaXMudmFsdWVzLmxlbmd0aCA+IDAgJiZcbiAgICAgIHRoaXMuZ2V0SW5wdXRGaWxsZWRWYWx1ZSgpLmxlbmd0aCA9PT0gMCAmJlxuICAgICAgZXZlbnQua2V5ID09PSAnQmFja3NwYWNlJyAmJlxuICAgICAgIWhhc01vZGlmaWVyS2V5KGV2ZW50LCAnYWx0S2V5JywgJ3NoaWZ0S2V5JywgJ2N0cmxLZXknLCAnbWV0YUtleScpXG4gICAgKSB7XG4gICAgICB0aGlzLmRlc2VsZWN0KHRoaXMudmFsdWVzW3RoaXMudmFsdWUubGVuZ3RoIC0gMV0pO1xuICAgIH1cblxuICAgIHN1cGVyLm9uSW5wdXRLZXlkb3duKGV2ZW50KTtcbiAgfVxuXG4gIHNlbGVjdChvcHRpb246IFQpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuZGlzYWJsZWQgJiYgIXRoaXMuaXNTZWxlY3RlZChvcHRpb24pKSB7XG4gICAgICBjb25zdCBuZXdWYWx1ZSA9IHRoaXMuX29wdGlvbnMuZmlsdGVyKFxuICAgICAgICAobykgPT4gdGhpcy5pc1NlbGVjdGVkKG8pIHx8IHRoaXMuY29tcGFyZUl0ZW0obywgb3B0aW9uKSxcbiAgICAgICk7XG4gICAgICB0aGlzLnZhbHVlID0gW1xuICAgICAgICAuLi50aGlzLnZhbHVlLmZpbHRlcihcbiAgICAgICAgICAobykgPT4gIW5ld1ZhbHVlLnNvbWUoKG4pID0+IHRoaXMuY29tcGFyZUl0ZW0obiwgbykpLFxuICAgICAgICApLFxuICAgICAgICAuLi5uZXdWYWx1ZSxcbiAgICAgIF07XG4gICAgICB0aGlzLnVwZGF0ZURyb3Bkb3duT3B0aW9ucygpO1xuICAgICAgdGhpcy5pbnB1dEVsLm5hdGl2ZUVsZW1lbnQudmFsdWUgPSAnJztcbiAgICAgIHRoaXMuc3RhdGVDaGFuZ2VzLmVtaXQoKTtcbiAgICB9XG4gIH1cblxuICBvdmVycmlkZSBkZXNlbGVjdChvcHRpb24/OiBUIHwgbnVsbCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5kaXNhYmxlZCAmJiAoIW9wdGlvbiB8fCB0aGlzLmlzU2VsZWN0ZWQob3B0aW9uKSkpIHtcbiAgICAgIGlmIChvcHRpb24pIHtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMudmFsdWUuZmlsdGVyKChvKSA9PiAhdGhpcy5jb21wYXJlSXRlbShvLCBvcHRpb24pKTtcblxuICAgICAgICBpZiAob3B0aW9uKSB7XG4gICAgICAgICAgdGhpcy5fb3B0aW9ucyA9IHRoaXMuX29wdGlvbnMuZmlsdGVyKFxuICAgICAgICAgICAgKG8pID0+XG4gICAgICAgICAgICAgICF0aGlzLl9uZXdWYWx1ZXMuc29tZSgobmV3T3B0KSA9PiB0aGlzLmNvbXBhcmVJdGVtKG8sIG5ld09wdCkpLFxuICAgICAgICAgICk7XG4gICAgICAgICAgdGhpcy5fbmV3VmFsdWVzID0gdGhpcy5fbmV3VmFsdWVzLmZpbHRlcihcbiAgICAgICAgICAgICh2KSA9PiAhdGhpcy5jb21wYXJlSXRlbSh2LCBvcHRpb24pLFxuICAgICAgICAgICk7XG4gICAgICAgICAgdGhpcy5fb3B0aW9ucyA9IFsuLi50aGlzLl9vcHRpb25zLCAuLi50aGlzLl9uZXdWYWx1ZXNdO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy51cGRhdGVEcm9wZG93bk9wdGlvbnMoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuY2xlYXIoKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5mb2N1c2VkQ2hpcCA9IG51bGw7XG4gICAgICB0aGlzLm9uVmFsdWVDaGFuZ2UoKTtcbiAgICB9XG4gIH1cblxuICBpc0lucHV0RmlsbGVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmlucHV0RWw/Lm5hdGl2ZUVsZW1lbnQudmFsdWUubGVuZ3RoID4gMCB8fCBmYWxzZTtcbiAgfVxuXG4gIG92ZXJyaWRlIGhpZGUoKTogdm9pZCB7XG4gICAgc3VwZXIuaGlkZSgpO1xuXG4gICAgaWYgKHRoaXMuaW5wdXRFbC5uYXRpdmVFbGVtZW50LnZhbHVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhpcy5fc2VhcmNoJC5uZXh0KCcnKTtcbiAgICAgIHRoaXMuX29wdGlvbnMgPSBbXTtcbiAgICB9XG4gIH1cblxuICBwcm90ZWN0ZWQgY2hpcEZvY3VzKGNoaXA6IFJkc0NoaXBDb21wb25lbnQ8VD4pOiB2b2lkIHtcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuY2hpcHNcbiAgICAgIC5tYXAoKGMpID0+IGMuZ2V0QWN0aW9ucygpKVxuICAgICAgLnJlZHVjZSgocCwgYykgPT4gWy4uLnAsIC4uLmNdLCBbXSlcbiAgICAgIC5maW5kSW5kZXgoKGEpID0+IGEgPT09IGNoaXAuZ2V0QWN0aW9ucygpWzBdKTtcbiAgICB0aGlzLmtleU1hbmFnZXIuc2V0QWN0aXZlSXRlbShpbmRleCk7XG4gIH1cblxuICBwcm90ZWN0ZWQgb3ZlcnJpZGUgYXNzaWduSW5wdXRzVG9Ecm9wZG93bigpOiB2b2lkIHtcbiAgICB0aGlzLl9kcm9wZG93bkluc3RhbmNlLmluc3RhbmNlLnR5cGUgPSAnbXVsdGknO1xuICAgIHN1cGVyLmFzc2lnbklucHV0c1RvRHJvcGRvd24oKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBzaG93Q2FyZXQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIChcbiAgICAgIHRoaXMuZ2V0UGxhY2Vob2xkZXIoKS50cmltKCkgPT09ICcnICYmXG4gICAgICB0aGlzLmlucHV0RWwubmF0aXZlRWxlbWVudC52YWx1ZS50cmltKCkgPT09ICcnICYmXG4gICAgICB0aGlzLnZhbHVlcy5sZW5ndGggPiAwXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgcmVjYWxjdWxhdGVJbnB1dFdpZHRoKCk6IHZvaWQge1xuICAgIGlmIChcbiAgICAgIHRoaXMuYXV0b2NvbXBsZXRlTXVsdGkgJiZcbiAgICAgIHRoaXMuaW5wdXRFbCAmJlxuICAgICAgdGhpcy52YWx1ZUNvbnRhaW5lciAmJlxuICAgICAgdGhpcy52YWx1ZUNvbnRhaW5lci5sYXN0ICYmXG4gICAgICB0aGlzLmlucHV0Q29udGFpbmVyXG4gICAgKSB7XG4gICAgICBjb25zdCBhdmFpbGFibGVXaWR0aCA9XG4gICAgICAgIHRoaXMuYXV0b2NvbXBsZXRlTXVsdGkubmF0aXZlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS54ICtcbiAgICAgICAgdGhpcy5hdXRvY29tcGxldGVNdWx0aS5uYXRpdmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoIC1cbiAgICAgICAgdGhpcy52YWx1ZUNvbnRhaW5lci5sYXN0Lm5hdGl2ZUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkueCAtXG4gICAgICAgIHRoaXMudmFsdWVDb250YWluZXIubGFzdC5uYXRpdmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoIC1cbiAgICAgICAgdGhpcy5tdWx0aU1pbmltdW1JbnB1dFdpZHRoT2Zmc2V0O1xuXG4gICAgICBpZiAoYXZhaWxhYmxlV2lkdGggPiB0aGlzLm11bHRpTWluaW11bUlucHV0V2lkdGgpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShcbiAgICAgICAgICB0aGlzLmlucHV0Q29udGFpbmVyLm5hdGl2ZUVsZW1lbnQsXG4gICAgICAgICAgJ3dpZHRoJyxcbiAgICAgICAgICBgJHthdmFpbGFibGVXaWR0aH1weGAsXG4gICAgICAgICk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKFxuICAgICAgICAgIHRoaXMuaW5wdXRDb250YWluZXIubmF0aXZlRWxlbWVudCxcbiAgICAgICAgICAnd2lkdGgnLFxuICAgICAgICAgICcxMDAlJyxcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHRoaXMuaW5wdXRDb250YWluZXIpIHtcbiAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoXG4gICAgICAgIHRoaXMuaW5wdXRDb250YWluZXIubmF0aXZlRWxlbWVudCxcbiAgICAgICAgJ3dpZHRoJyxcbiAgICAgICAgJzEwMCUnLFxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIG9yaWdpbmF0ZXNGcm9tQ2hpcChldmVudDogRXZlbnQpOiBib29sZWFuIHtcbiAgICBsZXQgY3VycmVudEVsZW1lbnQgPSBldmVudC50YXJnZXQgYXMgSFRNTEVsZW1lbnQgfCBudWxsO1xuXG4gICAgd2hpbGUgKGN1cnJlbnRFbGVtZW50ICYmIGN1cnJlbnRFbGVtZW50ICE9PSB0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudCkge1xuICAgICAgaWYgKGN1cnJlbnRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygncmRzLWNoaXBzX19jaGlwJykpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIGN1cnJlbnRFbGVtZW50ID0gY3VycmVudEVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBwcml2YXRlIHNldFVwRm9jdXNNYW5hZ2VtZW50KCk6IHZvaWQge1xuICAgIC8vIENyZWF0ZSBhIGZsYXQgYFF1ZXJ5TGlzdGAgY29udGFpbmluZyB0aGUgYWN0aW9ucyBvZiBhbGwgdGhlIGNoaXBzLlxuICAgIC8vIFRoaXMgYWxsb3dzIHVzIHRvIG5hdmlnYXRlIGJvdGggd2l0aGluIHRoZSBjaGlwIGFuZCBtb3ZlIHRvIHRoZSBuZXh0L3ByZXZpb3VzXG4gICAgLy8gb25lIHVzaW5nIHRoZSBleGlzdGluZyBgTGlzdEtleU1hbmFnZXJgLlxuICAgIHRoaXMuY2hpcHMuY2hhbmdlc1xuICAgICAgLnBpcGUoc3RhcnRXaXRoKHRoaXMuY2hpcHMpKVxuICAgICAgLnN1YnNjcmliZSgoY2hpcHM6IFF1ZXJ5TGlzdDxSZHNDaGlwQ29tcG9uZW50PFQ+PikgPT4ge1xuICAgICAgICBjb25zdCBhY3Rpb25zOiBSZHNDaGlwQWN0aW9uRGlyZWN0aXZlW10gPSBjaGlwc1xuICAgICAgICAgIC5tYXAoKGMpID0+IGMuZ2V0QWN0aW9ucygpKVxuICAgICAgICAgIC5yZWR1Y2UoKHAsIGMpID0+IFsuLi5wLCAuLi5jXSwgW10pO1xuICAgICAgICB0aGlzLmNoaXBBY3Rpb25zLnJlc2V0KGFjdGlvbnMpO1xuICAgICAgICB0aGlzLmNoaXBBY3Rpb25zLm5vdGlmeU9uQ2hhbmdlcygpO1xuICAgICAgfSk7XG5cbiAgICB0aGlzLmtleU1hbmFnZXIgPSBuZXcgRm9jdXNLZXlNYW5hZ2VyKHRoaXMuY2hpcEFjdGlvbnMpXG4gICAgICAud2l0aFZlcnRpY2FsT3JpZW50YXRpb24oKVxuICAgICAgLndpdGhIb3Jpem9udGFsT3JpZW50YXRpb24odGhpcy5kaXIgPyB0aGlzLmRpci52YWx1ZSA6ICdsdHInKVxuICAgICAgLndpdGhIb21lQW5kRW5kKClcbiAgICAgIC5za2lwUHJlZGljYXRlKChhY3Rpb24pID0+IGFjdGlvbi5kaXNhYmxlZCk7XG4gICAgdGhpcy5rZXlNYW5hZ2VyLnRhYk91dC5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgdGhpcy5kaXNhbGxvd0ZvY3VzRXNjYXBlID0gZmFsc2U7XG4gICAgICB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKTtcblxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHRoaXMuZGlzYWxsb3dGb2N1c0VzY2FwZSA9IHRydWU7XG4gICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBLZWVwIHRoZSBtYW5hZ2VyIGFjdGl2ZSBpbmRleCBpbiBzeW5jIHNvIHRoYXQgbmF2aWdhdGlvbiBwaWNrc1xuICAgIC8vIHVwIGZyb20gdGhlIGN1cnJlbnQgY2hpcCBpZiB0aGUgdXNlciBjbGlja3MgaW50byB0aGUgbGlzdCBkaXJlY3RseS5cbiAgICB0aGlzLmNoaXBzLmNoYW5nZXNcbiAgICAgIC5waXBlKFxuICAgICAgICBzdGFydFdpdGgobnVsbCksXG4gICAgICAgIHN3aXRjaE1hcCgoKSA9PiBtZXJnZSguLi50aGlzLmNoaXBzLm1hcCgoYykgPT4gYy5mb2N1cyQpKSksXG4gICAgICAgIHRha2VVbnRpbERlc3Ryb3llZCh0aGlzLmRlc3Ryb3lSZWYpLFxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZSgoeyBzb3VyY2U6IGNoaXAgfSkgPT4ge1xuICAgICAgICBjb25zdCBhY3Rpb24gPSBjaGlwLmdldFNvdXJjZUFjdGlvbihkb2N1bWVudC5hY3RpdmVFbGVtZW50IGFzIEVsZW1lbnQpO1xuXG4gICAgICAgIGlmIChhY3Rpb24pIHtcbiAgICAgICAgICB0aGlzLmtleU1hbmFnZXIudXBkYXRlQWN0aXZlSXRlbShhY3Rpb24pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB0aGlzLmNoaXBzLmNoYW5nZXNcbiAgICAgIC5waXBlKFxuICAgICAgICBzdGFydFdpdGgobnVsbCksXG4gICAgICAgIHN3aXRjaE1hcCgoKSA9PlxuICAgICAgICAgIG1lcmdlKFxuICAgICAgICAgICAgLi4udGhpcy5jaGlwcy5tYXAoKGMpID0+XG4gICAgICAgICAgICAgIGMuZm9jdXMkLnBpcGUobWFwKChlKSA9PiAoeyBmb2N1c2VkOiB0cnVlLCBzb3VyY2U6IGUuc291cmNlIH0pKSksXG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgLi4udGhpcy5jaGlwcy5tYXAoKGMpID0+XG4gICAgICAgICAgICAgIGMuYmx1ciQucGlwZShtYXAoKGUpID0+ICh7IGZvY3VzZWQ6IGZhbHNlLCBzb3VyY2U6IGUuc291cmNlIH0pKSksXG4gICAgICAgICAgICApLFxuICAgICAgICAgICksXG4gICAgICAgICksXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKChjaGlwKSA9PiB7XG4gICAgICAgIGlmIChjaGlwLmZvY3VzZWQpIHtcbiAgICAgICAgICB0aGlzLmZvY3VzZWRDaGlwID0gY2hpcC5zb3VyY2U7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5mb2N1c2VkQ2hpcCA9PT0gY2hpcC5zb3VyY2UpIHtcbiAgICAgICAgICB0aGlzLmZvY3VzZWRDaGlwID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgICAgfSk7XG5cbiAgICB0aGlzLmRpcj8uY2hhbmdlXG4gICAgICAucGlwZSh0YWtlVW50aWxEZXN0cm95ZWQodGhpcy5kZXN0cm95UmVmKSlcbiAgICAgIC5zdWJzY3JpYmUoKGRpcmVjdGlvbikgPT5cbiAgICAgICAgdGhpcy5rZXlNYW5hZ2VyLndpdGhIb3Jpem9udGFsT3JpZW50YXRpb24oZGlyZWN0aW9uKSxcbiAgICAgICk7XG4gIH1cblxuICBwcml2YXRlIHRyYWNrRGVzdHJveWVkRm9jdXNlZENoaXAoKTogdm9pZCB7XG4gICAgdGhpcy5jaGlwcy5jaGFuZ2VzXG4gICAgICAucGlwZShcbiAgICAgICAgc3RhcnRXaXRoKG51bGwpLFxuICAgICAgICBzd2l0Y2hNYXAoKCkgPT4gbWVyZ2UoLi4udGhpcy5jaGlwcy5tYXAoKGMpID0+IGMuZGVzdHJveWVkKSkpLFxuICAgICAgICB0YWtlVW50aWxEZXN0cm95ZWQodGhpcy5kZXN0cm95UmVmKSxcbiAgICAgIClcbiAgICAgIC5zdWJzY3JpYmUoKGV2ZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IGNoaXBBcnJheSA9IHRoaXMuY2hpcHMudG9BcnJheSgpO1xuICAgICAgICBjb25zdCBjaGlwSW5kZXggPSBjaGlwQXJyYXkuaW5kZXhPZihldmVudC5zb3VyY2UpO1xuXG4gICAgICAgIC8vIElmIHRoZSBmb2N1c2VkIGNoaXAgaXMgZGVzdHJveWVkLCBzYXZlIGl0cyBpbmRleCBzbyB0aGF0IHdlIGNhbiBtb3ZlIGZvY3VzIHRvIHRoZSBuZXh0XG4gICAgICAgIC8vIGNoaXAuIFdlIG9ubHkgc2F2ZSB0aGUgaW5kZXggaGVyZSwgcmF0aGVyIHRoYW4gbW92ZSB0aGUgZm9jdXMgaW1tZWRpYXRlbHksIGJlY2F1c2Ugd2Ugd2FudFxuICAgICAgICAvLyB0byB3YWl0IHVudGlsIHRoZSBjaGlwIGlzIHJlbW92ZWQgZnJvbSB0aGUgY2hpcCBsaXN0IGJlZm9yZSBmb2N1c2luZyB0aGUgbmV4dCBvbmUuIFRoaXNcbiAgICAgICAgLy8gYWxsb3dzIHVzIHRvIGtlZXAgZm9jdXMgb24gdGhlIHNhbWUgaW5kZXggaWYgdGhlIGNoaXAgZ2V0cyBzd2FwcGVkIG91dC5cbiAgICAgICAgaWYgKHRoaXMuaXNWYWxpZEluZGV4KGNoaXBJbmRleCkgJiYgZXZlbnQuc291cmNlLmhhc0ZvY3VzKCkpIHtcbiAgICAgICAgICB0aGlzLl9sYXN0RGVzdHJveWVkRm9jdXNlZENoaXBJbmRleCA9IGNoaXBJbmRleDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGlzVmFsaWRJbmRleChpbmRleDogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGluZGV4ID49IDAgJiYgaW5kZXggPCB0aGlzLmNoaXBzLmxlbmd0aDtcbiAgfVxuXG4gIHByaXZhdGUgdHJhY2tDaGlwU2V0Q2hhbmdlcygpOiB2b2lkIHtcbiAgICB0aGlzLmNoaXBzLmNoYW5nZXNcbiAgICAgIC5waXBlKHN0YXJ0V2l0aChudWxsKSwgdGFrZVVudGlsRGVzdHJveWVkKHRoaXMuZGVzdHJveVJlZikpXG4gICAgICAuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWQpIHtcbiAgICAgICAgICAvLyBTaW5jZSB0aGlzIGhhcHBlbnMgYWZ0ZXIgdGhlIGNvbnRlbnQgaGFzIGJlZW5cbiAgICAgICAgICAvLyBjaGVja2VkLCB3ZSBuZWVkIHRvIGRlZmVyIGl0IHRvIHRoZSBuZXh0IHRpY2suXG4gICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKSA9PiB0aGlzLnN5bmNDaGlwc1N0YXRlKCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fcmVkaXJlY3REZXN0cm95ZWRDaGlwRm9jdXMoKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBzeW5jQ2hpcHNTdGF0ZSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5jaGlwcykge1xuICAgICAgdGhpcy5jaGlwcy5mb3JFYWNoKChjaGlwKSA9PiB7XG4gICAgICAgIGNoaXAuZGlzYWJsZWQgPSB0aGlzLmRpc2FibGVkO1xuICAgICAgICBjaGlwLmNkci5tYXJrRm9yQ2hlY2soKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgX3JlZGlyZWN0RGVzdHJveWVkQ2hpcEZvY3VzKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLl9sYXN0RGVzdHJveWVkRm9jdXNlZENoaXBJbmRleCA9PSBudWxsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuY2hpcHMubGVuZ3RoKSB7XG4gICAgICBjb25zdCBuZXdJbmRleCA9IE1hdGgubWluKFxuICAgICAgICB0aGlzLl9sYXN0RGVzdHJveWVkRm9jdXNlZENoaXBJbmRleCxcbiAgICAgICAgdGhpcy5jaGlwcy5sZW5ndGggLSAxLFxuICAgICAgKTtcbiAgICAgIGNvbnN0IGNoaXBUb0ZvY3VzID0gdGhpcy5jaGlwcy50b0FycmF5KClbbmV3SW5kZXhdO1xuXG4gICAgICBpZiAoY2hpcFRvRm9jdXMuZGlzYWJsZWQpIHtcbiAgICAgICAgLy8gSWYgd2UncmUgZG93biB0byBvbmUgZGlzYWJsZWQgY2hpcCwgbW92ZSBmb2N1cyBiYWNrIHRvIHRoZSBzZXQuXG4gICAgICAgIGlmICh0aGlzLmNoaXBzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgIHRoaXMuZm9jdXMoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmtleU1hbmFnZXIuc2V0UHJldmlvdXNJdGVtQWN0aXZlKCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNoaXBUb0ZvY3VzLmZvY3VzKCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCkgPT4gdGhpcy5mb2N1cygpKTtcbiAgICB9XG5cbiAgICB0aGlzLl9sYXN0RGVzdHJveWVkRm9jdXNlZENoaXBJbmRleCA9IG51bGw7XG4gIH1cbn1cbiJdfQ==