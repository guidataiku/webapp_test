import { booleanAttribute, ChangeDetectionStrategy, ChangeDetectorRef, Component, ContentChildren, EventEmitter, HostBinding, HostListener, inject, Input, numberAttribute, Output, QueryList, ViewEncapsulation, } from '@angular/core';
import { NgControl } from '@angular/forms';
import { merge, noop } from 'rxjs';
import { startWith, switchMap } from 'rxjs/operators';
import { RdsAvatarComponent } from '../../avatar';
import { RDS_CHIP_LIST } from '../chip.tokens';
import { RdsChipSetComponent } from '../chip-set';
import { TAB } from '@angular/cdk/keycodes';
import { RdsChipSelectableComponent } from '../chip-selectable/chip-selectable.component';
import { takeUntilDestroyed } from '@angular/core/rxjs-interop';
import { TAB_INDEX_NOT_FOCUSABLE } from '../../utils';
import * as i0 from "@angular/core";
export class RdsChipListComponent extends RdsChipSetComponent {
    set tabIndex(value) {
        super.tabIndex = numberAttribute(value);
    }
    get tabIndex() {
        return super.tabIndex;
    }
    get tabindex() {
        return this.empty ? TAB_INDEX_NOT_FOCUSABLE : this.tabIndex;
    }
    get empty() {
        return this.selectableChips.length === 0;
    }
    get hostClasses() {
        const classes = [
            'rds-chips',
            `rds-chips--size-${this.size}`,
            `rds-chips--type-${this.type}`,
        ];
        if (this.disabled) {
            classes.push('rds-chips--disabled');
        }
        return classes;
    }
    set multiple(value) {
        const oldValue = this._multiple;
        this._multiple = booleanAttribute(value);
        this.syncListProperties(oldValue !== this._multiple);
    }
    get multiple() {
        return this._multiple;
    }
    set selectable(value) {
        this._selectable = booleanAttribute(value);
        this.syncListProperties();
    }
    get selectable() {
        return this._selectable;
    }
    get size() {
        return this._size;
    }
    set size(size) {
        this._size = size;
    }
    set value(value) {
        this.writeValue(value);
        this._value = value;
    }
    get value() {
        return this._value;
    }
    set disabled(v) {
        super.disabled = v;
    }
    get disabled() {
        return this.ngControl ? !!this.ngControl.disabled : this._disabled;
    }
    get selected() {
        const selectedChips = this.selectableChips
            .toArray()
            .filter((chip) => chip.selected);
        return this.multiple ? selectedChips : selectedChips[0];
    }
    get chipSelectionChanges() {
        return this.getChipSelectableStream((chip) => chip.selectedChange);
    }
    get chipBlurChanges() {
        return this.getChipSelectableStream((chip) => chip.blur$);
    }
    get focused() {
        return this.hasFocusedChip();
    }
    constructor() {
        super();
        this.ngControl = inject(NgControl, {
            self: true,
            optional: true,
        });
        this.cdr = inject(ChangeDetectorRef);
        this._multiple = false;
        this._selectable = true;
        this.valueChange = new EventEmitter();
        this.onChange = noop;
        this.onTouched = noop;
        this.orientation = 'horizontal';
        this._size = 'm';
        this.compareFn = (valueOne, valueTwo) => valueOne === valueTwo;
        if (this.ngControl) {
            // Note: we provide the value accessor through here, instead of
            // the `providers` to avoid running into a circular import.
            this.ngControl.valueAccessor = this;
        }
        this.role = 'listbox';
    }
    ngAfterContentInit() {
        super.ngAfterContentInit();
        if (this._pendingInitialValue !== undefined) {
            Promise.resolve().then(() => {
                this.setSelectionByValue(this._pendingInitialValue, false);
                this._pendingInitialValue = undefined;
            });
        }
        this.selectableChips.changes
            .pipe(startWith(this.selectableChips), takeUntilDestroyed(this.destroyRef))
            .subscribe(() => {
            const newRole = this.selectableChips.length > 0 ? 'listbox' : 'presentation';
            if (newRole !== this.role) {
                this.role = newRole;
            }
            // Update listbox selectable/multiple properties on chips
            this.syncListProperties();
        });
        this.chipBlurChanges
            .pipe(takeUntilDestroyed(this.destroyRef))
            .subscribe(() => this.blur());
        this.chipSelectionChanges
            .pipe(takeUntilDestroyed(this.destroyRef))
            .subscribe((event) => {
            if (!this.multiple) {
                this.selectableChips.forEach((chip) => {
                    if (chip !== event.source) {
                        chip.setSelectedState(false, false, false);
                    }
                });
            }
            if (event.isUserInput) {
                this.propagateChanges();
            }
        });
        this.checkAndSetAvatarSizes();
        this.avatars.changes
            .pipe(takeUntilDestroyed(this.destroyRef))
            .subscribe(() => this.checkAndSetAvatarSizes());
    }
    /**
     * Focuses the first selected chip in this chip listbox, or the first non-disabled chip when there
     * are no selected chips.
     */
    focus() {
        if (this.disabled) {
            return;
        }
        const firstSelectedChip = this.getFirstSelectedChip();
        if (firstSelectedChip && !firstSelectedChip.disabled) {
            firstSelectedChip.focus();
        }
        else if (this.selectableChips.length > 0) {
            this.keyManager.setFirstItemActive();
        }
        else {
            this.elementRef.nativeElement.focus();
        }
    }
    blur() {
        if (!this.disabled) {
            // Wait to see if focus moves to an individual chip.
            setTimeout(() => {
                if (!this.focused) {
                    this.markAsTouched();
                }
            });
        }
    }
    // ControlValueAccessor Start
    writeValue(value) {
        if (this.selectableChips) {
            this.setSelectionByValue(value, false);
        }
        else if (value != null) {
            this._pendingInitialValue = value;
        }
    }
    registerOnChange(fn) {
        this.onChange = fn;
    }
    registerOnTouched(fn) {
        this.onTouched = fn;
    }
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
    }
    // ControlValueAccessor End
    getChipSelectableStream(mappingFunction) {
        return this.selectableChips.changes.pipe(startWith(null), switchMap(() => merge(...this.selectableChips.map(mappingFunction))));
    }
    hasFocusedChip() {
        return (this.selectableChips &&
            this.selectableChips.some((chip) => chip.hasFocus()));
    }
    onKeydown(e) {
        if (e.keyCode === TAB) {
            super.allowFocusEscape();
        }
    }
    getFirstSelectedChip() {
        if (Array.isArray(this.selected)) {
            return this.selected.length ? this.selected[0] : undefined;
        }
        else {
            return this.selected;
        }
    }
    markAsTouched() {
        this.onTouched();
        this.cdr.markForCheck();
    }
    syncListProperties(clearSelection = false) {
        if (this.selectableChips) {
            // Defer setting the value in order to avoid the "Expression
            // has changed after it was checked" errors from Angular.
            Promise.resolve().then(() => {
                this.selectableChips.forEach((chip) => {
                    chip.chipListSelectable = this.selectable;
                    chip.chipListMulti = this.multiple;
                    if (clearSelection) {
                        chip.deselect();
                    }
                    chip.cdr.markForCheck();
                });
            });
        }
    }
    clearSelection(skip) {
        this.selectableChips.forEach((chip) => {
            if (chip !== skip) {
                chip.deselect();
            }
        });
    }
    propagateChanges(fallbackValue) {
        let valueToEmit;
        if (this.multiple) {
            valueToEmit = this.selected.map((chip) => chip.value);
        }
        else {
            valueToEmit = this.selected
                ? this.selected.value
                : fallbackValue || null;
        }
        this.value = valueToEmit;
        this.onChange(valueToEmit);
        this.valueChange.emit(valueToEmit);
    }
    setSelectionByValue(value, isUserInput = true) {
        this.clearSelection();
        if (this.multiple && value) {
            if (!Array.isArray(value)) {
                throw new Error('A multiselect chip-list requires the given value to be an array');
            }
            value.forEach((currentValue) => this.selectValue(currentValue, isUserInput));
        }
        else {
            this.selectValue(value, isUserInput);
        }
    }
    selectValue(value, isUserInput) {
        const correspondingChip = this.selectableChips.find((chip) => {
            try {
                return chip.value != null && this.compareFn(chip.value, value);
            }
            catch (error) {
                return false;
            }
        });
        if (correspondingChip) {
            isUserInput
                ? correspondingChip.selectViaInteraction()
                : correspondingChip.select();
        }
        return correspondingChip;
    }
    checkAndSetAvatarSizes() {
        this.avatars
            .filter((a) => a.size !== this.size)
            .forEach((a) => (a.size = this.size));
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.1", ngImport: i0, type: RdsChipListComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "17.3.1", type: RdsChipListComponent, selector: "rds-chip-list", inputs: { tabIndex: "tabIndex", multiple: "multiple", selectable: "selectable", size: "size", compareFn: "compareFn", value: "value", disabled: "disabled" }, outputs: { valueChange: "valueChange" }, host: { listeners: { "focus": "focus()", "blur": "blur()", "keydown": "onKeydown($event)" }, properties: { "tabIndex": "this.tabindex", "attr.aria-orientation": "this.orientation", "class": "this.hostClasses", "attr.aria-multiselectable": "this.multiple" } }, providers: [
            {
                provide: RDS_CHIP_LIST,
                useExisting: RdsChipListComponent,
            },
        ], queries: [{ propertyName: "selectableChips", predicate: RdsChipSelectableComponent, descendants: true }, { propertyName: "avatars", predicate: RdsAvatarComponent, descendants: true }], usesInheritance: true, ngImport: i0, template: `
    <ng-content
      select="rds-chip-selectable, rds-chip, button[rds-chip], button[rdsChip]"
    />
  `, isInline: true, styles: [".rds-chips__chip{display:flex;align-items:center;justify-content:center;border-width:1px;border-style:solid;border-color:var(--rds-color-chips-1-stroke-enabled);border-radius:30px;width:fit-content;background-color:var(--rds-color-chips-bg-enabled);color:var(--rds-color-informative);-webkit-user-select:none;user-select:none}.rds-chips__chip:hover{cursor:default}.rds-chips__chip:active:not([disabled]){box-shadow:none}.rds-chips__chip.cdk-focused.cdk-keyboard-focused:not([aria-disabled=true],[disabled]):not(:has(.rds-chip-close-button:focus-visible)){outline:var(--rds-color-stroke-active-focus) solid 2px;outline-offset:-1px}.rds-chips__chip .rds-chip__avatar{border-radius:100vmax}.rds-chips__chip .rds-chip__leading-icon{color:var(--rds-color-informative)}.rds-chips__chip .rds-chip-close-button:not([disabled]){color:var(--rds-color-informative)}.rds-chips__chip:hover:not([aria-disabled=true],[disabled]){box-shadow:0 0 1px #00000052,0 2px 4px #0000001c;cursor:pointer;border-color:var(--rds-color-chips-1-stroke-hover);color:var(--rds-color-informative);background-color:var(--rds-color-chips-bg-enabled)}.rds-chips__chip:hover:not([aria-disabled=true],[disabled]) .rds-chip__leading-icon{color:var(--rds-color-informative)}.rds-chips__chip:hover:not([aria-disabled=true],[disabled]) .rds-chip-close-button:not([disabled]){color:var(--rds-color-informative)}.rds-chips__chip .rds-chip-close-button>.rds-icon.rds-chip-close-icon{width:16px;height:16px}.rds-chips__chip .rds-avatar:hover .rds-avatar-overlay{display:none}.rds-chips__chip--selected:not([aria-disabled=true],[disabled]),.rds-chips__chip:active:not([aria-disabled=true],[disabled]){border-color:var(--rds-color-chips-1-bg-pressed);color:var(--rds-color-chips-1-text-pressed);background:var(--rds-color-chips-1-bg-pressed)}.rds-chips__chip .rds-chip-action{display:inline-flex;align-items:center;outline:none}.rds-chips__chip.rds-chips--type-blue{border-color:var(--rds-color-chips-1-stroke-enabled);color:var(--rds-color-informative)}.rds-chips__chip.rds-chips--type-blue .rds-chip__leading-icon{color:var(--rds-color-informative)}.rds-chips__chip.rds-chips--type-blue .rds-chip-close-button:not([disabled]){color:var(--rds-color-informative)}.rds-chips__chip.rds-chips--type-blue:hover:not([aria-disabled=true],[disabled]){border-color:var(--rds-color-chips-1-stroke-hover);color:var(--rds-color-informative);background:var(--rds-color-chips-bg-enabled)}.rds-chips__chip.rds-chips--type-blue:hover:not([aria-disabled=true],[disabled]) .rds-chip__leading-icon{color:var(--rds-color-informative)}.rds-chips__chip.rds-chips--type-blue:hover:not([aria-disabled=true],[disabled]) .rds-chip-close-button:not([disabled]){color:var(--rds-color-informative)}.rds-chips__chip.rds-chips--type-blue.rds-chips__chip--selected:not([aria-disabled=true],[disabled]),.rds-chips__chip.rds-chips--type-blue:active:not([aria-disabled=true],[disabled]){border-color:var(--rds-color-chips-1-bg-pressed);color:var(--rds-color-chips-1-text-pressed);background:var(--rds-color-chips-1-bg-pressed)}.rds-chips__chip.rds-chips--type-neutral{border-color:var(--rds-color-chips-2-stroke-enabled);color:var(--rds-color-neutral)}.rds-chips__chip.rds-chips--type-neutral .rds-chip__leading-icon{color:var(--rds-color-neutral)}.rds-chips__chip.rds-chips--type-neutral .rds-chip-close-button:not([disabled]){color:var(--rds-color-neutral)}.rds-chips__chip.rds-chips--type-neutral:hover:not([aria-disabled=true],[disabled]){border-color:var(--rds-color-chips-2-stroke-hover);color:var(--rds-color-neutral);background:var(--rds-color-chips-bg-enabled)}.rds-chips__chip.rds-chips--type-neutral:hover:not([aria-disabled=true],[disabled]) .rds-chip__leading-icon{color:var(--rds-color-neutral)}.rds-chips__chip.rds-chips--type-neutral:hover:not([aria-disabled=true],[disabled]) .rds-chip-close-button:not([disabled]){color:var(--rds-color-neutral)}.rds-chips__chip.rds-chips--type-neutral.rds-chips__chip--selected:not([aria-disabled=true],[disabled]),.rds-chips__chip.rds-chips--type-neutral:active:not([aria-disabled=true],[disabled]){border-color:var(--rds-color-chips-2-bg-pressed);color:var(--rds-color-chips-2-text-pressed);background:var(--rds-color-chips-2-bg-pressed)}.rds-chips__chip .rds-chips--size-s{font-size:14px;font-weight:400;line-height:20px;text-transform:none;letter-spacing:.3px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;min-height:28px;padding:0 11px}.rds-chips__chip .rds-chips--size-s .rds-chip__leading-icon{margin:0 4px 0 -4px;width:18px;height:18px}.rds-chips__chip .rds-chips--size-s .rds-chip__avatar{margin:0 4px 0 -10px;width:24px;height:24px}.rds-chips__chip .rds-chips--size-s .rds-chip__avatar .rds-avatar__container,.rds-chips__chip .rds-chips--size-s .rds-avatar .rds-avatar__container .rds-avatar-image{width:24px;height:24px}.rds-chips__chip .rds-chips--size-s .rds-chip-close-button{margin-inline:4px -4px}.rds-chips__chip .rds-chips--size-s .rds-chip-close-button:after,.rds-chips__chip .rds-chips--size-s .rds-chip-close-button:before{border-radius:100vmax;width:20px;height:20px;inset:-1px 0 0 -1px}.rds-chips__chip .rds-chips--size-s .rds-chip-close-button:before{width:20px;height:20px}.rds-chips__chip .rds-chips--size-m{font-size:16px;font-weight:400;line-height:24px;text-transform:none;letter-spacing:.2px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;min-height:36px;padding:0 15px}.rds-chips__chip .rds-chips--size-m .rds-chip__leading-icon{margin:0 8px 0 -4px;width:18px;height:18px}.rds-chips__chip .rds-chips--size-m .rds-chip__avatar{margin:0 8px 0 -12px;width:28px;height:28px}.rds-chips__chip .rds-chips--size-m .rds-chip__avatar .rds-avatar__container,.rds-chips__chip .rds-chips--size-m .rds-avatar .rds-avatar__container .rds-avatar-image{width:28px;height:28px}.rds-chips__chip .rds-chips--size-m .rds-chip-close-button{margin-inline:8px -4px}.rds-chips__chip .rds-chips--size-m .rds-chip-close-button:after,.rds-chips__chip .rds-chips--size-m .rds-chip-close-button:before{border-radius:100vmax;width:20px;height:20px;inset:-1px 0 0 -1px}.rds-chips__chip .rds-chips--size-m .rds-chip-close-button:before{width:20px;height:20px}.rds-chips__chip .rds-chips--size-l{font-size:18px;font-weight:400;line-height:24px;text-transform:none;letter-spacing:.2px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;min-height:48px;padding:0 23px}.rds-chips__chip .rds-chips--size-l .rds-chip__leading-icon{margin:0 8px 0 -8px;width:24px;height:24px}.rds-chips__chip .rds-chips--size-l .rds-chip__avatar{margin:0 8px 0 -20px;width:40px;height:40px}.rds-chips__chip .rds-chips--size-l .rds-chip__avatar .rds-avatar__container,.rds-chips__chip .rds-chips--size-l .rds-avatar .rds-avatar__container .rds-avatar-image{width:40px;height:40px}.rds-chips__chip .rds-chips--size-l .rds-chip-close-button{margin-inline:8px -8px}.rds-chips__chip .rds-chips--size-l .rds-chip-close-button:after,.rds-chips__chip .rds-chips--size-l .rds-chip-close-button:before{border-radius:100vmax;width:20px;height:20px;inset:-1px 0 0 -1px}.rds-chips__chip .rds-chips--size-l .rds-chip-close-button:before{width:20px;height:20px}.rds-chips__chip[disabled],.rds-chips__chip[aria-disabled=true]{border-color:var(--rds-color-stroke-enabled);background-color:var(--rds-color-bg-disabled);color:var(--rds-color-disabled)}.rds-chips__chip[disabled] .rds-chip__avatar,.rds-chips__chip[aria-disabled=true] .rds-chip__avatar{opacity:.3}.rds-chips__chip[disabled] .rds-chip__leading-icon,.rds-chips__chip[aria-disabled=true] .rds-chip__leading-icon{color:var(--rds-color-disabled)}.rds-chips{display:flex;flex-wrap:wrap}.rds-chips.rds-chips--size-s{gap:8px}.rds-chips.rds-chips--size-m,.rds-chips.rds-chips--size-l{gap:12px}.rds-chips-wrapper{display:flex;align-items:center;justify-content:center}\n"], changeDetection: i0.ChangeDetectionStrategy.OnPush, encapsulation: i0.ViewEncapsulation.None }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.1", ngImport: i0, type: RdsChipListComponent, decorators: [{
            type: Component,
            args: [{ selector: 'rds-chip-list', template: `
    <ng-content
      select="rds-chip-selectable, rds-chip, button[rds-chip], button[rdsChip]"
    />
  `, encapsulation: ViewEncapsulation.None, changeDetection: ChangeDetectionStrategy.OnPush, providers: [
                        {
                            provide: RDS_CHIP_LIST,
                            useExisting: RdsChipListComponent,
                        },
                    ], styles: [".rds-chips__chip{display:flex;align-items:center;justify-content:center;border-width:1px;border-style:solid;border-color:var(--rds-color-chips-1-stroke-enabled);border-radius:30px;width:fit-content;background-color:var(--rds-color-chips-bg-enabled);color:var(--rds-color-informative);-webkit-user-select:none;user-select:none}.rds-chips__chip:hover{cursor:default}.rds-chips__chip:active:not([disabled]){box-shadow:none}.rds-chips__chip.cdk-focused.cdk-keyboard-focused:not([aria-disabled=true],[disabled]):not(:has(.rds-chip-close-button:focus-visible)){outline:var(--rds-color-stroke-active-focus) solid 2px;outline-offset:-1px}.rds-chips__chip .rds-chip__avatar{border-radius:100vmax}.rds-chips__chip .rds-chip__leading-icon{color:var(--rds-color-informative)}.rds-chips__chip .rds-chip-close-button:not([disabled]){color:var(--rds-color-informative)}.rds-chips__chip:hover:not([aria-disabled=true],[disabled]){box-shadow:0 0 1px #00000052,0 2px 4px #0000001c;cursor:pointer;border-color:var(--rds-color-chips-1-stroke-hover);color:var(--rds-color-informative);background-color:var(--rds-color-chips-bg-enabled)}.rds-chips__chip:hover:not([aria-disabled=true],[disabled]) .rds-chip__leading-icon{color:var(--rds-color-informative)}.rds-chips__chip:hover:not([aria-disabled=true],[disabled]) .rds-chip-close-button:not([disabled]){color:var(--rds-color-informative)}.rds-chips__chip .rds-chip-close-button>.rds-icon.rds-chip-close-icon{width:16px;height:16px}.rds-chips__chip .rds-avatar:hover .rds-avatar-overlay{display:none}.rds-chips__chip--selected:not([aria-disabled=true],[disabled]),.rds-chips__chip:active:not([aria-disabled=true],[disabled]){border-color:var(--rds-color-chips-1-bg-pressed);color:var(--rds-color-chips-1-text-pressed);background:var(--rds-color-chips-1-bg-pressed)}.rds-chips__chip .rds-chip-action{display:inline-flex;align-items:center;outline:none}.rds-chips__chip.rds-chips--type-blue{border-color:var(--rds-color-chips-1-stroke-enabled);color:var(--rds-color-informative)}.rds-chips__chip.rds-chips--type-blue .rds-chip__leading-icon{color:var(--rds-color-informative)}.rds-chips__chip.rds-chips--type-blue .rds-chip-close-button:not([disabled]){color:var(--rds-color-informative)}.rds-chips__chip.rds-chips--type-blue:hover:not([aria-disabled=true],[disabled]){border-color:var(--rds-color-chips-1-stroke-hover);color:var(--rds-color-informative);background:var(--rds-color-chips-bg-enabled)}.rds-chips__chip.rds-chips--type-blue:hover:not([aria-disabled=true],[disabled]) .rds-chip__leading-icon{color:var(--rds-color-informative)}.rds-chips__chip.rds-chips--type-blue:hover:not([aria-disabled=true],[disabled]) .rds-chip-close-button:not([disabled]){color:var(--rds-color-informative)}.rds-chips__chip.rds-chips--type-blue.rds-chips__chip--selected:not([aria-disabled=true],[disabled]),.rds-chips__chip.rds-chips--type-blue:active:not([aria-disabled=true],[disabled]){border-color:var(--rds-color-chips-1-bg-pressed);color:var(--rds-color-chips-1-text-pressed);background:var(--rds-color-chips-1-bg-pressed)}.rds-chips__chip.rds-chips--type-neutral{border-color:var(--rds-color-chips-2-stroke-enabled);color:var(--rds-color-neutral)}.rds-chips__chip.rds-chips--type-neutral .rds-chip__leading-icon{color:var(--rds-color-neutral)}.rds-chips__chip.rds-chips--type-neutral .rds-chip-close-button:not([disabled]){color:var(--rds-color-neutral)}.rds-chips__chip.rds-chips--type-neutral:hover:not([aria-disabled=true],[disabled]){border-color:var(--rds-color-chips-2-stroke-hover);color:var(--rds-color-neutral);background:var(--rds-color-chips-bg-enabled)}.rds-chips__chip.rds-chips--type-neutral:hover:not([aria-disabled=true],[disabled]) .rds-chip__leading-icon{color:var(--rds-color-neutral)}.rds-chips__chip.rds-chips--type-neutral:hover:not([aria-disabled=true],[disabled]) .rds-chip-close-button:not([disabled]){color:var(--rds-color-neutral)}.rds-chips__chip.rds-chips--type-neutral.rds-chips__chip--selected:not([aria-disabled=true],[disabled]),.rds-chips__chip.rds-chips--type-neutral:active:not([aria-disabled=true],[disabled]){border-color:var(--rds-color-chips-2-bg-pressed);color:var(--rds-color-chips-2-text-pressed);background:var(--rds-color-chips-2-bg-pressed)}.rds-chips__chip .rds-chips--size-s{font-size:14px;font-weight:400;line-height:20px;text-transform:none;letter-spacing:.3px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;min-height:28px;padding:0 11px}.rds-chips__chip .rds-chips--size-s .rds-chip__leading-icon{margin:0 4px 0 -4px;width:18px;height:18px}.rds-chips__chip .rds-chips--size-s .rds-chip__avatar{margin:0 4px 0 -10px;width:24px;height:24px}.rds-chips__chip .rds-chips--size-s .rds-chip__avatar .rds-avatar__container,.rds-chips__chip .rds-chips--size-s .rds-avatar .rds-avatar__container .rds-avatar-image{width:24px;height:24px}.rds-chips__chip .rds-chips--size-s .rds-chip-close-button{margin-inline:4px -4px}.rds-chips__chip .rds-chips--size-s .rds-chip-close-button:after,.rds-chips__chip .rds-chips--size-s .rds-chip-close-button:before{border-radius:100vmax;width:20px;height:20px;inset:-1px 0 0 -1px}.rds-chips__chip .rds-chips--size-s .rds-chip-close-button:before{width:20px;height:20px}.rds-chips__chip .rds-chips--size-m{font-size:16px;font-weight:400;line-height:24px;text-transform:none;letter-spacing:.2px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;min-height:36px;padding:0 15px}.rds-chips__chip .rds-chips--size-m .rds-chip__leading-icon{margin:0 8px 0 -4px;width:18px;height:18px}.rds-chips__chip .rds-chips--size-m .rds-chip__avatar{margin:0 8px 0 -12px;width:28px;height:28px}.rds-chips__chip .rds-chips--size-m .rds-chip__avatar .rds-avatar__container,.rds-chips__chip .rds-chips--size-m .rds-avatar .rds-avatar__container .rds-avatar-image{width:28px;height:28px}.rds-chips__chip .rds-chips--size-m .rds-chip-close-button{margin-inline:8px -4px}.rds-chips__chip .rds-chips--size-m .rds-chip-close-button:after,.rds-chips__chip .rds-chips--size-m .rds-chip-close-button:before{border-radius:100vmax;width:20px;height:20px;inset:-1px 0 0 -1px}.rds-chips__chip .rds-chips--size-m .rds-chip-close-button:before{width:20px;height:20px}.rds-chips__chip .rds-chips--size-l{font-size:18px;font-weight:400;line-height:24px;text-transform:none;letter-spacing:.2px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;min-height:48px;padding:0 23px}.rds-chips__chip .rds-chips--size-l .rds-chip__leading-icon{margin:0 8px 0 -8px;width:24px;height:24px}.rds-chips__chip .rds-chips--size-l .rds-chip__avatar{margin:0 8px 0 -20px;width:40px;height:40px}.rds-chips__chip .rds-chips--size-l .rds-chip__avatar .rds-avatar__container,.rds-chips__chip .rds-chips--size-l .rds-avatar .rds-avatar__container .rds-avatar-image{width:40px;height:40px}.rds-chips__chip .rds-chips--size-l .rds-chip-close-button{margin-inline:8px -8px}.rds-chips__chip .rds-chips--size-l .rds-chip-close-button:after,.rds-chips__chip .rds-chips--size-l .rds-chip-close-button:before{border-radius:100vmax;width:20px;height:20px;inset:-1px 0 0 -1px}.rds-chips__chip .rds-chips--size-l .rds-chip-close-button:before{width:20px;height:20px}.rds-chips__chip[disabled],.rds-chips__chip[aria-disabled=true]{border-color:var(--rds-color-stroke-enabled);background-color:var(--rds-color-bg-disabled);color:var(--rds-color-disabled)}.rds-chips__chip[disabled] .rds-chip__avatar,.rds-chips__chip[aria-disabled=true] .rds-chip__avatar{opacity:.3}.rds-chips__chip[disabled] .rds-chip__leading-icon,.rds-chips__chip[aria-disabled=true] .rds-chip__leading-icon{color:var(--rds-color-disabled)}.rds-chips{display:flex;flex-wrap:wrap}.rds-chips.rds-chips--size-s{gap:8px}.rds-chips.rds-chips--size-m,.rds-chips.rds-chips--size-l{gap:12px}.rds-chips-wrapper{display:flex;align-items:center;justify-content:center}\n"] }]
        }], ctorParameters: () => [], propDecorators: { selectableChips: [{
                type: ContentChildren,
                args: [RdsChipSelectableComponent, { descendants: true }]
            }], tabIndex: [{
                type: Input
            }], tabindex: [{
                type: HostBinding,
                args: ['tabIndex']
            }], valueChange: [{
                type: Output
            }], avatars: [{
                type: ContentChildren,
                args: [RdsAvatarComponent, { descendants: true }]
            }], orientation: [{
                type: HostBinding,
                args: ['attr.aria-orientation']
            }], hostClasses: [{
                type: HostBinding,
                args: ['class']
            }], multiple: [{
                type: Input
            }, {
                type: HostBinding,
                args: ['attr.aria-multiselectable']
            }], selectable: [{
                type: Input
            }], size: [{
                type: Input
            }], compareFn: [{
                type: Input
            }], value: [{
                type: Input
            }], disabled: [{
                type: Input
            }], focus: [{
                type: HostListener,
                args: ['focus']
            }], blur: [{
                type: HostListener,
                args: ['blur']
            }], onKeydown: [{
                type: HostListener,
                args: ['keydown', ['$event']]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hpcC1saXN0LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL2xpYnMvYW5ndWxhci1jb21wb25lbnRzL3NyYy9saWIvY2hpcHMvY2hpcC1saXN0L2NoaXAtbGlzdC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUVMLGdCQUFnQixFQUNoQix1QkFBdUIsRUFDdkIsaUJBQWlCLEVBQ2pCLFNBQVMsRUFDVCxlQUFlLEVBQ2YsWUFBWSxFQUNaLFdBQVcsRUFDWCxZQUFZLEVBQ1osTUFBTSxFQUNOLEtBQUssRUFDTCxlQUFlLEVBRWYsTUFBTSxFQUNOLFNBQVMsRUFDVCxpQkFBaUIsR0FDbEIsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUF3QixTQUFTLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUNqRSxPQUFPLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBYyxNQUFNLE1BQU0sQ0FBQztBQUMvQyxPQUFPLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRXRELE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLGNBQWMsQ0FBQztBQU9sRCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDL0MsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sYUFBYSxDQUFDO0FBQ2xELE9BQU8sRUFBRSxHQUFHLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUM1QyxPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSw4Q0FBOEMsQ0FBQztBQUMxRixPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUNoRSxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSxhQUFhLENBQUM7O0FBbUJ0RCxNQUFNLE9BQU8sb0JBQ1gsU0FBUSxtQkFBc0I7SUFpQjlCLElBQ2EsUUFBUSxDQUFDLEtBQWtCO1FBQ3RDLEtBQUss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QUFNO2dCQXVEWixTQUFTO3NCQURoQixZQUFZO3VCQUFDLFNBQVMsRUFBRSxDQUFDLFFBQVEsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJvb2xlYW5JbnB1dCwgTnVtYmVySW5wdXQgfSBmcm9tICdAYW5ndWxhci9jZGsvY29lcmNpb24nO1xuaW1wb3J0IHtcbiAgQWZ0ZXJDb250ZW50SW5pdCxcbiAgYm9vbGVhbkF0dHJpYnV0ZSxcbiAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG4gIENoYW5nZURldGVjdG9yUmVmLFxuICBDb21wb25lbnQsXG4gIENvbnRlbnRDaGlsZHJlbixcbiAgRXZlbnRFbWl0dGVyLFxuICBIb3N0QmluZGluZyxcbiAgSG9zdExpc3RlbmVyLFxuICBpbmplY3QsXG4gIElucHV0LFxuICBudW1iZXJBdHRyaWJ1dGUsXG4gIE9uRGVzdHJveSxcbiAgT3V0cHV0LFxuICBRdWVyeUxpc3QsXG4gIFZpZXdFbmNhcHN1bGF0aW9uLFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBOZ0NvbnRyb2wgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQgeyBtZXJnZSwgbm9vcCwgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgc3RhcnRXaXRoLCBzd2l0Y2hNYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBSZHNDaGlwQ29tcG9uZW50IH0gZnJvbSAnLi4vY2hpcC9jaGlwLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBSZHNBdmF0YXJDb21wb25lbnQgfSBmcm9tICcuLi8uLi9hdmF0YXInO1xuaW1wb3J0IHtcbiAgUmRzQ2hpcENvbXBhcmVGdW5jdGlvbixcbiAgUmRzQ2hpcEV2ZW50LFxuICBSZHNDaGlwU2VsZWN0RXZlbnQsXG4gIFJkc0NoaXBzU2l6ZSxcbn0gZnJvbSAnLi4vY2hpcC50eXBlcyc7XG5pbXBvcnQgeyBSRFNfQ0hJUF9MSVNUIH0gZnJvbSAnLi4vY2hpcC50b2tlbnMnO1xuaW1wb3J0IHsgUmRzQ2hpcFNldENvbXBvbmVudCB9IGZyb20gJy4uL2NoaXAtc2V0JztcbmltcG9ydCB7IFRBQiB9IGZyb20gJ0Bhbmd1bGFyL2Nkay9rZXljb2Rlcyc7XG5pbXBvcnQgeyBSZHNDaGlwU2VsZWN0YWJsZUNvbXBvbmVudCB9IGZyb20gJy4uL2NoaXAtc2VsZWN0YWJsZS9jaGlwLXNlbGVjdGFibGUuY29tcG9uZW50JztcbmltcG9ydCB7IHRha2VVbnRpbERlc3Ryb3llZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUvcnhqcy1pbnRlcm9wJztcbmltcG9ydCB7IFRBQl9JTkRFWF9OT1RfRk9DVVNBQkxFIH0gZnJvbSAnLi4vLi4vdXRpbHMnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdyZHMtY2hpcC1saXN0JyxcbiAgdGVtcGxhdGU6IGBcbiAgICA8bmctY29udGVudFxuICAgICAgc2VsZWN0PVwicmRzLWNoaXAtc2VsZWN0YWJsZSwgcmRzLWNoaXAsIGJ1dHRvbltyZHMtY2hpcF0sIGJ1dHRvbltyZHNDaGlwXVwiXG4gICAgLz5cbiAgYCxcbiAgc3R5bGVVcmxzOiBbJy4uL2NoaXBzLmNvbW1vbi5zY3NzJ10sXG4gIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxuICBwcm92aWRlcnM6IFtcbiAgICB7XG4gICAgICBwcm92aWRlOiBSRFNfQ0hJUF9MSVNULFxuICAgICAgdXNlRXhpc3Rpbmc6IFJkc0NoaXBMaXN0Q29tcG9uZW50LFxuICAgIH0sXG4gIF0sXG59KVxuZXhwb3J0IGNsYXNzIFJkc0NoaXBMaXN0Q29tcG9uZW50PFQ+XG4gIGV4dGVuZHMgUmRzQ2hpcFNldENvbXBvbmVudDxUPlxuICBpbXBsZW1lbnRzIEFmdGVyQ29udGVudEluaXQsIE9uRGVzdHJveSwgQ29udHJvbFZhbHVlQWNjZXNzb3JcbntcbiAgcHJpdmF0ZSByZWFkb25seSBuZ0NvbnRyb2wgPSBpbmplY3QoTmdDb250cm9sLCB7XG4gICAgc2VsZjogdHJ1ZSxcbiAgICBvcHRpb25hbDogdHJ1ZSxcbiAgfSk7XG4gIHByaXZhdGUgcmVhZG9ubHkgY2RyID0gaW5qZWN0KENoYW5nZURldGVjdG9yUmVmKTtcblxuICBwcml2YXRlIF92YWx1ZTogVDtcbiAgcHJpdmF0ZSBfbXVsdGlwbGUgPSBmYWxzZTtcbiAgcHJpdmF0ZSBfc2VsZWN0YWJsZSA9IHRydWU7XG4gIHByaXZhdGUgX3BlbmRpbmdJbml0aWFsVmFsdWU6IGFueTtcblxuICBAQ29udGVudENoaWxkcmVuKFJkc0NoaXBTZWxlY3RhYmxlQ29tcG9uZW50LCB7IGRlc2NlbmRhbnRzOiB0cnVlIH0pXG4gIHNlbGVjdGFibGVDaGlwczogUXVlcnlMaXN0PFJkc0NoaXBTZWxlY3RhYmxlQ29tcG9uZW50PFQ+PjtcblxuICBASW5wdXQoKVxuICBvdmVycmlkZSBzZXQgdGFiSW5kZXgodmFsdWU6IE51bWJlcklucHV0KSB7XG4gICAgc3VwZXIudGFiSW5kZXggPSBudW1iZXJBdHRyaWJ1dGUodmFsdWUpO1xuICB9XG5cbiAgb3ZlcnJpZGUgZ2V0IHRhYkluZGV4KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHN1cGVyLnRhYkluZGV4O1xuICB9XG5cbiAgQEhvc3RCaW5kaW5nKCd0YWJJbmRleCcpXG4gIGdldCB0YWJpbmRleCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmVtcHR5ID8gVEFCX0lOREVYX05PVF9GT0NVU0FCTEUgOiB0aGlzLnRhYkluZGV4O1xuICB9XG5cbiAgb3ZlcnJpZGUgZ2V0IGVtcHR5KCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnNlbGVjdGFibGVDaGlwcy5sZW5ndGggPT09IDA7XG4gIH1cblxuICBAT3V0cHV0KClcbiAgcmVhZG9ubHkgdmFsdWVDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICBAQ29udGVudENoaWxkcmVuKFJkc0F2YXRhckNvbXBvbmVudCwgeyBkZXNjZW5kYW50czogdHJ1ZSB9KVxuICBhdmF0YXJzOiBRdWVyeUxpc3Q8UmRzQXZhdGFyQ29tcG9uZW50PjtcblxuICBwcml2YXRlIG9uQ2hhbmdlOiAoXzogYW55KSA9PiB2b2lkID0gbm9vcDtcbiAgcHJpdmF0ZSBvblRvdWNoZWQgPSBub29wO1xuXG4gIEBIb3N0QmluZGluZygnYXR0ci5hcmlhLW9yaWVudGF0aW9uJylcbiAgb3JpZW50YXRpb24gPSAnaG9yaXpvbnRhbCc7XG5cbiAgQEhvc3RCaW5kaW5nKCdjbGFzcycpIGdldCBob3N0Q2xhc3NlcygpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgY2xhc3NlcyA9IFtcbiAgICAgICdyZHMtY2hpcHMnLFxuICAgICAgYHJkcy1jaGlwcy0tc2l6ZS0ke3RoaXMuc2l6ZX1gLFxuICAgICAgYHJkcy1jaGlwcy0tdHlwZS0ke3RoaXMudHlwZX1gLFxuICAgIF07XG5cbiAgICBpZiAodGhpcy5kaXNhYmxlZCkge1xuICAgICAgY2xhc3Nlcy5wdXNoKCdyZHMtY2hpcHMtLWRpc2FibGVkJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNsYXNzZXM7XG4gIH1cblxuICBASW5wdXQoKVxuICBASG9zdEJpbmRpbmcoJ2F0dHIuYXJpYS1tdWx0aXNlbGVjdGFibGUnKVxuICBzZXQgbXVsdGlwbGUodmFsdWU6IEJvb2xlYW5JbnB1dCkge1xuICAgIGNvbnN0IG9sZFZhbHVlID0gdGhpcy5fbXVsdGlwbGU7XG4gICAgdGhpcy5fbXVsdGlwbGUgPSBib29sZWFuQXR0cmlidXRlKHZhbHVlKTtcbiAgICB0aGlzLnN5bmNMaXN0UHJvcGVydGllcyhvbGRWYWx1ZSAhPT0gdGhpcy5fbXVsdGlwbGUpO1xuICB9XG5cbiAgZ2V0IG11bHRpcGxlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9tdWx0aXBsZTtcbiAgfVxuXG4gIEBJbnB1dCgpXG4gIHNldCBzZWxlY3RhYmxlKHZhbHVlOiBCb29sZWFuSW5wdXQpIHtcbiAgICB0aGlzLl9zZWxlY3RhYmxlID0gYm9vbGVhbkF0dHJpYnV0ZSh2YWx1ZSk7XG4gICAgdGhpcy5zeW5jTGlzdFByb3BlcnRpZXMoKTtcbiAgfVxuXG4gIGdldCBzZWxlY3RhYmxlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9zZWxlY3RhYmxlO1xuICB9XG5cbiAgQElucHV0KClcbiAgZ2V0IHNpemUoKTogUmRzQ2hpcHNTaXplIHtcbiAgICByZXR1cm4gdGhpcy5fc2l6ZTtcbiAgfVxuXG4gIHNldCBzaXplKHNpemU6IFJkc0NoaXBzU2l6ZSkge1xuICAgIHRoaXMuX3NpemUgPSBzaXplO1xuICB9XG5cbiAgcHJvdGVjdGVkIG92ZXJyaWRlIF9zaXplOiBSZHNDaGlwc1NpemUgPSAnbSc7XG5cbiAgQElucHV0KClcbiAgY29tcGFyZUZuOiBSZHNDaGlwQ29tcGFyZUZ1bmN0aW9uPFQ+ID0gKHZhbHVlT25lOiBULCB2YWx1ZVR3bzogVCk6IGJvb2xlYW4gPT5cbiAgICB2YWx1ZU9uZSA9PT0gdmFsdWVUd287XG5cbiAgQElucHV0KClcbiAgc2V0IHZhbHVlKHZhbHVlOiBUKSB7XG4gICAgdGhpcy53cml0ZVZhbHVlKHZhbHVlKTtcbiAgICB0aGlzLl92YWx1ZSA9IHZhbHVlO1xuICB9XG5cbiAgZ2V0IHZhbHVlKCk6IFQge1xuICAgIHJldHVybiB0aGlzLl92YWx1ZTtcbiAgfVxuXG4gIEBJbnB1dCgpXG4gIG92ZXJyaWRlIHNldCBkaXNhYmxlZCh2OiBCb29sZWFuSW5wdXQpIHtcbiAgICBzdXBlci5kaXNhYmxlZCA9IHY7XG4gIH1cblxuICBvdmVycmlkZSBnZXQgZGlzYWJsZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMubmdDb250cm9sID8gISF0aGlzLm5nQ29udHJvbC5kaXNhYmxlZCA6IHRoaXMuX2Rpc2FibGVkO1xuICB9XG5cbiAgZ2V0IHNlbGVjdGVkKCk6XG4gICAgfCBSZHNDaGlwU2VsZWN0YWJsZUNvbXBvbmVudDxUPlxuICAgIHwgUmRzQ2hpcFNlbGVjdGFibGVDb21wb25lbnQ8VD5bXSB7XG4gICAgY29uc3Qgc2VsZWN0ZWRDaGlwcyA9IHRoaXMuc2VsZWN0YWJsZUNoaXBzXG4gICAgICAudG9BcnJheSgpXG4gICAgICAuZmlsdGVyKChjaGlwKSA9PiBjaGlwLnNlbGVjdGVkKTtcblxuICAgIHJldHVybiB0aGlzLm11bHRpcGxlID8gc2VsZWN0ZWRDaGlwcyA6IHNlbGVjdGVkQ2hpcHNbMF07XG4gIH1cblxuICBnZXQgY2hpcFNlbGVjdGlvbkNoYW5nZXMoKTogT2JzZXJ2YWJsZTxSZHNDaGlwU2VsZWN0RXZlbnQ8VD4+IHtcbiAgICByZXR1cm4gdGhpcy5nZXRDaGlwU2VsZWN0YWJsZVN0cmVhbTxcbiAgICAgIFJkc0NoaXBTZWxlY3RFdmVudDxUPixcbiAgICAgIFJkc0NoaXBTZWxlY3RhYmxlQ29tcG9uZW50PFQ+XG4gICAgPigoY2hpcCkgPT4gY2hpcC5zZWxlY3RlZENoYW5nZSk7XG4gIH1cblxuICBnZXQgY2hpcEJsdXJDaGFuZ2VzKCk6IE9ic2VydmFibGU8UmRzQ2hpcEV2ZW50PFQ+PiB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0Q2hpcFNlbGVjdGFibGVTdHJlYW0oKGNoaXApID0+IGNoaXAuYmx1ciQpO1xuICB9XG5cbiAgb3ZlcnJpZGUgZ2V0IGZvY3VzZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuaGFzRm9jdXNlZENoaXAoKTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG5cbiAgICBpZiAodGhpcy5uZ0NvbnRyb2wpIHtcbiAgICAgIC8vIE5vdGU6IHdlIHByb3ZpZGUgdGhlIHZhbHVlIGFjY2Vzc29yIHRocm91Z2ggaGVyZSwgaW5zdGVhZCBvZlxuICAgICAgLy8gdGhlIGBwcm92aWRlcnNgIHRvIGF2b2lkIHJ1bm5pbmcgaW50byBhIGNpcmN1bGFyIGltcG9ydC5cbiAgICAgIHRoaXMubmdDb250cm9sLnZhbHVlQWNjZXNzb3IgPSB0aGlzO1xuICAgIH1cblxuICAgIHRoaXMucm9sZSA9ICdsaXN0Ym94JztcbiAgfVxuXG4gIG92ZXJyaWRlIG5nQWZ0ZXJDb250ZW50SW5pdCgpOiB2b2lkIHtcbiAgICBzdXBlci5uZ0FmdGVyQ29udGVudEluaXQoKTtcblxuICAgIGlmICh0aGlzLl9wZW5kaW5nSW5pdGlhbFZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCkgPT4ge1xuICAgICAgICB0aGlzLnNldFNlbGVjdGlvbkJ5VmFsdWUodGhpcy5fcGVuZGluZ0luaXRpYWxWYWx1ZSwgZmFsc2UpO1xuICAgICAgICB0aGlzLl9wZW5kaW5nSW5pdGlhbFZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdGhpcy5zZWxlY3RhYmxlQ2hpcHMuY2hhbmdlc1xuICAgICAgLnBpcGUoXG4gICAgICAgIHN0YXJ0V2l0aCh0aGlzLnNlbGVjdGFibGVDaGlwcyksXG4gICAgICAgIHRha2VVbnRpbERlc3Ryb3llZCh0aGlzLmRlc3Ryb3lSZWYpLFxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgIGNvbnN0IG5ld1JvbGUgPVxuICAgICAgICAgIHRoaXMuc2VsZWN0YWJsZUNoaXBzLmxlbmd0aCA+IDAgPyAnbGlzdGJveCcgOiAncHJlc2VudGF0aW9uJztcblxuICAgICAgICBpZiAobmV3Um9sZSAhPT0gdGhpcy5yb2xlKSB7XG4gICAgICAgICAgdGhpcy5yb2xlID0gbmV3Um9sZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFVwZGF0ZSBsaXN0Ym94IHNlbGVjdGFibGUvbXVsdGlwbGUgcHJvcGVydGllcyBvbiBjaGlwc1xuICAgICAgICB0aGlzLnN5bmNMaXN0UHJvcGVydGllcygpO1xuICAgICAgfSk7XG5cbiAgICB0aGlzLmNoaXBCbHVyQ2hhbmdlc1xuICAgICAgLnBpcGUodGFrZVVudGlsRGVzdHJveWVkKHRoaXMuZGVzdHJveVJlZikpXG4gICAgICAuc3Vic2NyaWJlKCgpID0+IHRoaXMuYmx1cigpKTtcblxuICAgIHRoaXMuY2hpcFNlbGVjdGlvbkNoYW5nZXNcbiAgICAgIC5waXBlKHRha2VVbnRpbERlc3Ryb3llZCh0aGlzLmRlc3Ryb3lSZWYpKVxuICAgICAgLnN1YnNjcmliZSgoZXZlbnQpID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLm11bHRpcGxlKSB7XG4gICAgICAgICAgdGhpcy5zZWxlY3RhYmxlQ2hpcHMuZm9yRWFjaCgoY2hpcCkgPT4ge1xuICAgICAgICAgICAgaWYgKGNoaXAgIT09IGV2ZW50LnNvdXJjZSkge1xuICAgICAgICAgICAgICBjaGlwLnNldFNlbGVjdGVkU3RhdGUoZmFsc2UsIGZhbHNlLCBmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZXZlbnQuaXNVc2VySW5wdXQpIHtcbiAgICAgICAgICB0aGlzLnByb3BhZ2F0ZUNoYW5nZXMoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICB0aGlzLmNoZWNrQW5kU2V0QXZhdGFyU2l6ZXMoKTtcbiAgICB0aGlzLmF2YXRhcnMuY2hhbmdlc1xuICAgICAgLnBpcGUodGFrZVVudGlsRGVzdHJveWVkKHRoaXMuZGVzdHJveVJlZikpXG4gICAgICAuc3Vic2NyaWJlKCgpID0+IHRoaXMuY2hlY2tBbmRTZXRBdmF0YXJTaXplcygpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGb2N1c2VzIHRoZSBmaXJzdCBzZWxlY3RlZCBjaGlwIGluIHRoaXMgY2hpcCBsaXN0Ym94LCBvciB0aGUgZmlyc3Qgbm9uLWRpc2FibGVkIGNoaXAgd2hlbiB0aGVyZVxuICAgKiBhcmUgbm8gc2VsZWN0ZWQgY2hpcHMuXG4gICAqL1xuICBASG9zdExpc3RlbmVyKCdmb2N1cycpXG4gIG92ZXJyaWRlIGZvY3VzKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmRpc2FibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgZmlyc3RTZWxlY3RlZENoaXAgPSB0aGlzLmdldEZpcnN0U2VsZWN0ZWRDaGlwKCk7XG5cbiAgICBpZiAoZmlyc3RTZWxlY3RlZENoaXAgJiYgIWZpcnN0U2VsZWN0ZWRDaGlwLmRpc2FibGVkKSB7XG4gICAgICBmaXJzdFNlbGVjdGVkQ2hpcC5mb2N1cygpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5zZWxlY3RhYmxlQ2hpcHMubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5rZXlNYW5hZ2VyLnNldEZpcnN0SXRlbUFjdGl2ZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5mb2N1cygpO1xuICAgIH1cbiAgfVxuXG4gIEBIb3N0TGlzdGVuZXIoJ2JsdXInKVxuICBibHVyKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5kaXNhYmxlZCkge1xuICAgICAgLy8gV2FpdCB0byBzZWUgaWYgZm9jdXMgbW92ZXMgdG8gYW4gaW5kaXZpZHVhbCBjaGlwLlxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGlmICghdGhpcy5mb2N1c2VkKSB7XG4gICAgICAgICAgdGhpcy5tYXJrQXNUb3VjaGVkKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8vIENvbnRyb2xWYWx1ZUFjY2Vzc29yIFN0YXJ0XG4gIHdyaXRlVmFsdWUodmFsdWU6IGFueSk6IHZvaWQge1xuICAgIGlmICh0aGlzLnNlbGVjdGFibGVDaGlwcykge1xuICAgICAgdGhpcy5zZXRTZWxlY3Rpb25CeVZhbHVlKHZhbHVlLCBmYWxzZSk7XG4gICAgfSBlbHNlIGlmICh2YWx1ZSAhPSBudWxsKSB7XG4gICAgICB0aGlzLl9wZW5kaW5nSW5pdGlhbFZhbHVlID0gdmFsdWU7XG4gICAgfVxuICB9XG5cbiAgcmVnaXN0ZXJPbkNoYW5nZShmbjogKF86IGFueSkgPT4gdm9pZCk6IHZvaWQge1xuICAgIHRoaXMub25DaGFuZ2UgPSBmbjtcbiAgfVxuXG4gIHJlZ2lzdGVyT25Ub3VjaGVkKGZuOiAoKSA9PiB2b2lkKTogdm9pZCB7XG4gICAgdGhpcy5vblRvdWNoZWQgPSBmbjtcbiAgfVxuXG4gIHNldERpc2FibGVkU3RhdGUoaXNEaXNhYmxlZDogYm9vbGVhbik6IHZvaWQge1xuICAgIHRoaXMuZGlzYWJsZWQgPSBpc0Rpc2FibGVkO1xuICB9XG5cbiAgLy8gQ29udHJvbFZhbHVlQWNjZXNzb3IgRW5kXG5cbiAgcHJvdGVjdGVkIGdldENoaXBTZWxlY3RhYmxlU3RyZWFtPFxuICAgIEUsXG4gICAgQyBleHRlbmRzIFJkc0NoaXBTZWxlY3RhYmxlQ29tcG9uZW50PFQ+ID0gUmRzQ2hpcFNlbGVjdGFibGVDb21wb25lbnQ8VD4sXG4gID4obWFwcGluZ0Z1bmN0aW9uOiAoY2hpcDogQykgPT4gT2JzZXJ2YWJsZTxFPik6IE9ic2VydmFibGU8RT4ge1xuICAgIHJldHVybiB0aGlzLnNlbGVjdGFibGVDaGlwcy5jaGFuZ2VzLnBpcGUoXG4gICAgICBzdGFydFdpdGgobnVsbCksXG4gICAgICBzd2l0Y2hNYXAoKCkgPT5cbiAgICAgICAgbWVyZ2UoLi4uKHRoaXMuc2VsZWN0YWJsZUNoaXBzIGFzIFF1ZXJ5TGlzdDxDPikubWFwKG1hcHBpbmdGdW5jdGlvbikpLFxuICAgICAgKSxcbiAgICApO1xuICB9XG5cbiAgcHJvdGVjdGVkIG92ZXJyaWRlIGhhc0ZvY3VzZWRDaGlwKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAoXG4gICAgICB0aGlzLnNlbGVjdGFibGVDaGlwcyAmJlxuICAgICAgdGhpcy5zZWxlY3RhYmxlQ2hpcHMuc29tZSgoY2hpcCkgPT4gY2hpcC5oYXNGb2N1cygpKVxuICAgICk7XG4gIH1cblxuICBASG9zdExpc3RlbmVyKCdrZXlkb3duJywgWyckZXZlbnQnXSlcbiAgcHJpdmF0ZSBvbktleWRvd24oZTogS2V5Ym9hcmRFdmVudCk6IHZvaWQge1xuICAgIGlmIChlLmtleUNvZGUgPT09IFRBQikge1xuICAgICAgc3VwZXIuYWxsb3dGb2N1c0VzY2FwZSgpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0Rmlyc3RTZWxlY3RlZENoaXAoKTogUmRzQ2hpcENvbXBvbmVudDxUPiB8IHVuZGVmaW5lZCB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkodGhpcy5zZWxlY3RlZCkpIHtcbiAgICAgIHJldHVybiB0aGlzLnNlbGVjdGVkLmxlbmd0aCA/IHRoaXMuc2VsZWN0ZWRbMF0gOiB1bmRlZmluZWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLnNlbGVjdGVkO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgbWFya0FzVG91Y2hlZCgpOiB2b2lkIHtcbiAgICB0aGlzLm9uVG91Y2hlZCgpO1xuICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xuICB9XG5cbiAgcHJpdmF0ZSBzeW5jTGlzdFByb3BlcnRpZXMoY2xlYXJTZWxlY3Rpb24gPSBmYWxzZSk6IHZvaWQge1xuICAgIGlmICh0aGlzLnNlbGVjdGFibGVDaGlwcykge1xuICAgICAgLy8gRGVmZXIgc2V0dGluZyB0aGUgdmFsdWUgaW4gb3JkZXIgdG8gYXZvaWQgdGhlIFwiRXhwcmVzc2lvblxuICAgICAgLy8gaGFzIGNoYW5nZWQgYWZ0ZXIgaXQgd2FzIGNoZWNrZWRcIiBlcnJvcnMgZnJvbSBBbmd1bGFyLlxuICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKSA9PiB7XG4gICAgICAgIHRoaXMuc2VsZWN0YWJsZUNoaXBzLmZvckVhY2goKGNoaXApID0+IHtcbiAgICAgICAgICBjaGlwLmNoaXBMaXN0U2VsZWN0YWJsZSA9IHRoaXMuc2VsZWN0YWJsZTtcbiAgICAgICAgICBjaGlwLmNoaXBMaXN0TXVsdGkgPSB0aGlzLm11bHRpcGxlO1xuXG4gICAgICAgICAgaWYgKGNsZWFyU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICBjaGlwLmRlc2VsZWN0KCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY2hpcC5jZHIubWFya0ZvckNoZWNrKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBjbGVhclNlbGVjdGlvbihza2lwPzogUmRzQ2hpcENvbXBvbmVudDxUPik6IHZvaWQge1xuICAgIHRoaXMuc2VsZWN0YWJsZUNoaXBzLmZvckVhY2goKGNoaXApID0+IHtcbiAgICAgIGlmIChjaGlwICE9PSBza2lwKSB7XG4gICAgICAgIGNoaXAuZGVzZWxlY3QoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgcHJvcGFnYXRlQ2hhbmdlcyhmYWxsYmFja1ZhbHVlPzogYW55KTogdm9pZCB7XG4gICAgbGV0IHZhbHVlVG9FbWl0OiBhbnk7XG5cbiAgICBpZiAodGhpcy5tdWx0aXBsZSkge1xuICAgICAgdmFsdWVUb0VtaXQgPSAodGhpcy5zZWxlY3RlZCBhcyBSZHNDaGlwQ29tcG9uZW50PFQ+W10pLm1hcChcbiAgICAgICAgKGNoaXApID0+IGNoaXAudmFsdWUsXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZVRvRW1pdCA9IHRoaXMuc2VsZWN0ZWRcbiAgICAgICAgPyAodGhpcy5zZWxlY3RlZCBhcyBSZHNDaGlwQ29tcG9uZW50PFQ+KS52YWx1ZVxuICAgICAgICA6IGZhbGxiYWNrVmFsdWUgfHwgbnVsbDtcbiAgICB9XG5cbiAgICB0aGlzLnZhbHVlID0gdmFsdWVUb0VtaXQ7XG4gICAgdGhpcy5vbkNoYW5nZSh2YWx1ZVRvRW1pdCk7XG4gICAgdGhpcy52YWx1ZUNoYW5nZS5lbWl0KHZhbHVlVG9FbWl0KTtcbiAgfVxuXG4gIHByaXZhdGUgc2V0U2VsZWN0aW9uQnlWYWx1ZSh2YWx1ZTogYW55LCBpc1VzZXJJbnB1dCA9IHRydWUpOiB2b2lkIHtcbiAgICB0aGlzLmNsZWFyU2VsZWN0aW9uKCk7XG5cbiAgICBpZiAodGhpcy5tdWx0aXBsZSAmJiB2YWx1ZSkge1xuICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgJ0EgbXVsdGlzZWxlY3QgY2hpcC1saXN0IHJlcXVpcmVzIHRoZSBnaXZlbiB2YWx1ZSB0byBiZSBhbiBhcnJheScsXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIHZhbHVlLmZvckVhY2goKGN1cnJlbnRWYWx1ZSkgPT5cbiAgICAgICAgdGhpcy5zZWxlY3RWYWx1ZShjdXJyZW50VmFsdWUsIGlzVXNlcklucHV0KSxcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2VsZWN0VmFsdWUodmFsdWUsIGlzVXNlcklucHV0KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHNlbGVjdFZhbHVlKFxuICAgIHZhbHVlOiBhbnksXG4gICAgaXNVc2VySW5wdXQ6IGJvb2xlYW4sXG4gICk6IFJkc0NoaXBDb21wb25lbnQ8VD4gfCB1bmRlZmluZWQge1xuICAgIGNvbnN0IGNvcnJlc3BvbmRpbmdDaGlwID0gdGhpcy5zZWxlY3RhYmxlQ2hpcHMuZmluZCgoY2hpcCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIGNoaXAudmFsdWUgIT0gbnVsbCAmJiB0aGlzLmNvbXBhcmVGbihjaGlwLnZhbHVlIGFzIFQsIHZhbHVlKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmIChjb3JyZXNwb25kaW5nQ2hpcCkge1xuICAgICAgaXNVc2VySW5wdXRcbiAgICAgICAgPyBjb3JyZXNwb25kaW5nQ2hpcC5zZWxlY3RWaWFJbnRlcmFjdGlvbigpXG4gICAgICAgIDogY29ycmVzcG9uZGluZ0NoaXAuc2VsZWN0KCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNvcnJlc3BvbmRpbmdDaGlwO1xuICB9XG5cbiAgcHJpdmF0ZSBjaGVja0FuZFNldEF2YXRhclNpemVzKCk6IHZvaWQge1xuICAgIHRoaXMuYXZhdGFyc1xuICAgICAgLmZpbHRlcigoYSkgPT4gYS5zaXplICE9PSB0aGlzLnNpemUpXG4gICAgICAuZm9yRWFjaCgoYSkgPT4gKGEuc2l6ZSA9IHRoaXMuc2l6ZSkpO1xuICB9XG59XG4iXX0=