import { FocusMonitor } from '@angular/cdk/a11y';
import { booleanAttribute, ChangeDetectionStrategy, ChangeDetectorRef, Component, DestroyRef, ElementRef, EventEmitter, forwardRef, HostBinding, inject, Input, NgZone, numberAttribute, Output, ViewChild, ViewEncapsulation, } from '@angular/core';
import { ControlContainer, FormGroupDirective, NG_VALUE_ACCESSOR, NgForm, Validators, } from '@angular/forms';
import { noop } from 'rxjs';
import { RdsCheckboxChangeEvent } from './checkbox-change.event';
import { animate, state, style, transition, trigger, } from '@angular/animations';
import { TAB_INDEX_DEFAULT, TAB_INDEX_NOT_FOCUSABLE, updateErrorState, } from '../utils';
import { takeUntilDestroyed } from '@angular/core/rxjs-interop';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "@angular/cdk/observers";
let nextUniqueId = 0;
export const rdsCheckboxAnimations = {
    /** Animation that transitions the form field's error and hint messages. */
    transitionMessages: trigger('transitionMessages', [
        state('enter', style({ opacity: 1, transform: 'translateY(0%)' })),
        transition('void => enter', [
            style({ opacity: 0, transform: 'translateY(-100%)' }),
            animate('200ms cubic-bezier(0.55, 0, 0.55, 0.2)'),
        ]),
    ]),
};
export class RdsCheckboxComponent {
    constructor() {
        this.destroyRef = inject(DestroyRef);
        this.elementRef = inject(ElementRef);
        this.cdr = inject(ChangeDetectorRef);
        this.focusMonitor = inject(FocusMonitor);
        this.ngZone = inject(NgZone);
        this.parentForm = inject(NgForm, { optional: true });
        this.parentFormGroup = inject(FormGroupDirective, {
            optional: true,
        });
        this.controlContainer = inject(ControlContainer, {
            optional: true,
            host: true,
            skipSelf: true,
        });
        this._uniqueId = `rds-checkbox-${++nextUniqueId}`;
        this._currentAnimationClass = '';
        this._errorState = false;
        this._tabIndex = TAB_INDEX_DEFAULT;
        this._indeterminate = false;
        this._currentCheckState = 0 /* TransitionCheckState.Init */;
        this.subscriptAnimationState = '';
        this.hostClass = 'rds-checkbox';
        this.id = this._uniqueId;
        this.size = 'l';
        this.ariaLabel = '';
        this.checked = false;
        this.disabled = false;
        this.changed = new EventEmitter();
        this._onChange = noop;
        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */
        this._onTouched = noop;
    }
    get getHostId() {
        return this._uniqueId;
    }
    get hostIndeterminate() {
        return this.indeterminate;
    }
    get hostChecked() {
        return this.checked;
    }
    get hostDisabled() {
        return this.disabled;
    }
    get errorState() {
        return this._errorState;
    }
    set tabIndex(value) {
        this._tabIndex = numberAttribute(value, TAB_INDEX_DEFAULT);
    }
    get tabIndex() {
        return this.disabled ? TAB_INDEX_NOT_FOCUSABLE : this._tabIndex;
    }
    set indeterminate(value) {
        this._indeterminate = booleanAttribute(value);
        if (this.indeterminate) {
            this.transitionCheckState(3 /* TransitionCheckState.Indeterminate */);
        }
        else {
            this.transitionCheckState(this.checked
                ? 1 /* TransitionCheckState.Checked */
                : 2 /* TransitionCheckState.Unchecked */);
        }
        this.syncIndeterminate(this.indeterminate);
    }
    get indeterminate() {
        return this._indeterminate;
    }
    get attrRequired() {
        if (this._control && this._control?.hasValidator(Validators.required)) {
            return this._control?.hasValidator(Validators.required) ?? null;
        }
        return this._required ?? null;
    }
    set required(value) {
        this._required = booleanAttribute(value);
    }
    get required() {
        return this.attrRequired ?? false;
    }
    get inputId() {
        return `${this.id || this._uniqueId}-input`;
    }
    get ariaChecked() {
        if (this.checked) {
            return 'true';
        }
        return this.indeterminate ? 'mixed' : 'false';
    }
    ngOnInit() {
        if (this.controlContainer) {
            if (this.formControlName) {
                this._control = this.controlContainer.control?.get(this.formControlName);
            }
            else {
                // Missing FormControlName directive from host element of the component
            }
        }
        else {
            // Can't find parent FormGroup directive
        }
    }
    ngDoCheck() {
        if (this._control) {
            // We need to re-evaluate this on every change detection cycle, because there are some
            // error triggers that we can't subscribe to (e.g. parent form submissions). This means
            // that whatever logic is in here has to be super lean or we risk destroying the performance.
            this._errorState = updateErrorState(this.errorState, this.parentFormGroup, this.parentForm, this._control);
        }
    }
    ngAfterContentInit() {
        const control = this._control;
        if (control && control.valueChanges) {
            control.valueChanges
                .pipe(takeUntilDestroyed(this.destroyRef))
                .subscribe(() => {
                control?.markAsDirty();
                control?.markAsTouched();
                this.cdr.markForCheck();
            });
        }
        const parent = this.parentFormGroup || this.parentForm;
        if (parent) {
            parent.ngSubmit
                .pipe(takeUntilDestroyed(this.destroyRef))
                .subscribe(() => {
                this.cdr.markForCheck();
            });
        }
    }
    ngAfterViewInit() {
        if (this.checkboxLabel.nativeElement.innerText) {
            this.elementRef.nativeElement.classList.add('rds-checkbox-with-label');
        }
        this.focusMonitor
            .monitor(this.elementRef, true)
            .subscribe((focusOrigin) => {
            if (!focusOrigin) {
                // When a focused element becomes disabled, the browser *immediately* fires a blur event.
                // Angular does not expect events to be raised during change detection, so any state change
                // (such as a form control's 'ng-touched') will cause a changed-after-checked error.
                // See https://github.com/angular/angular/issues/17793. To work around this, we defer
                // telling the form control it has been touched until the next tick.
                Promise.resolve().then(() => {
                    this._onTouched();
                    this.cdr.markForCheck();
                });
            }
        });
        this.subscriptAnimationState = 'enter'; // Avoid animations on load.
        this.cdr.detectChanges();
        this.syncIndeterminate(this.indeterminate);
    }
    ngOnDestroy() {
        this.focusMonitor.stopMonitoring(this.elementRef);
    }
    get isErrorMessageVisible() {
        return this.errorState;
    }
    onLabelTextChange() {
        if (this.checkboxLabel.nativeElement.innerText) {
            this.elementRef.nativeElement.classList.add('rds-checkbox-with-label');
        }
        else {
            this.elementRef.nativeElement.classList.remove('rds-checkbox-with-label');
        }
        this.cdr.detectChanges();
    }
    // start ControlValueAccessor - part
    writeValue(value) {
        this.checked = value;
    }
    registerOnChange(fn) {
        this._onChange = fn;
    }
    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */
    registerOnTouched(fn) {
        this._onTouched = fn;
    }
    setDisabledState(isDisabled) {
        if (this.disabled !== isDisabled) {
            this.disabled = isDisabled;
            this.cdr.markForCheck();
        }
    }
    // end ControlValueAccessor - part
    onInputClick(event) {
        // We have to stop propagation for click events on the visual hidden input element.
        // By default, when a user clicks on a label element, a generated click event will be
        // dispatched on the associated input element. Since we are using a label element as our
        // root container, the click event on the `checkbox` will be executed twice.
        // The real click event will bubble up, and the generated click event also tries to bubble up.
        // This will lead to multiple click events.
        // Preventing bubbling for the second event will solve that issue.
        event.stopPropagation();
        if (this.disabled) {
            return;
        }
        Promise.resolve().then(() => (this.indeterminate = false));
        this.toggle();
        this.transitionCheckState(this.checked
            ? 1 /* TransitionCheckState.Checked */
            : 2 /* TransitionCheckState.Unchecked */);
        this.emitChangedEvent();
    }
    focus(origin = 'keyboard', options) {
        this.focusMonitor.focusVia(this._inputElement, origin, options);
    }
    getAnimationClassForCheckStateTransition(oldState, newState) {
        let animSuffix = '';
        switch (oldState) {
            case 0 /* TransitionCheckState.Init */:
                if (newState === 1 /* TransitionCheckState.Checked */) {
                    animSuffix = 'unchecked-checked';
                }
                else if (newState === 3 /* TransitionCheckState.Indeterminate */) {
                    animSuffix = 'unchecked-indeterminate';
                }
                else {
                    return '';
                }
                break;
            case 2 /* TransitionCheckState.Unchecked */:
                animSuffix =
                    newState === 1 /* TransitionCheckState.Checked */
                        ? 'unchecked-checked'
                        : 'unchecked-indeterminate';
                break;
            case 1 /* TransitionCheckState.Checked */:
                animSuffix =
                    newState === 2 /* TransitionCheckState.Unchecked */
                        ? 'checked-unchecked'
                        : 'checked-indeterminate';
                break;
            case 3 /* TransitionCheckState.Indeterminate */:
                animSuffix =
                    newState === 1 /* TransitionCheckState.Checked */
                        ? 'indeterminate-checked'
                        : 'indeterminate-unchecked';
                break;
        }
        return `rds-checkbox-animation--${animSuffix}`;
    }
    transitionCheckState(newState) {
        const oldState = this._currentCheckState;
        const element = this.elementRef.nativeElement;
        if (oldState === newState) {
            return;
        }
        if (this._currentAnimationClass.length > 0) {
            element.classList.remove(this._currentAnimationClass);
        }
        this._currentAnimationClass = this.getAnimationClassForCheckStateTransition(oldState, newState);
        this._currentCheckState = newState;
        if (this._currentAnimationClass.length > 0) {
            element.classList.add(this._currentAnimationClass);
            // Remove the animation class to avoid animation when the checkbox is moved between containers
            const animationClass = this._currentAnimationClass;
            this.ngZone.runOutsideAngular(() => {
                setTimeout(() => {
                    element.classList.remove(animationClass);
                }, 1000);
            });
        }
    }
    toggle() {
        this.checked = !this.checked;
    }
    emitChangedEvent() {
        const event = new RdsCheckboxChangeEvent();
        event.source = this;
        event.checked = this.checked;
        this._onChange(this.checked);
        this.changed.emit(event);
    }
    syncIndeterminate(value) {
        const nativeCheckbox = this._inputElement;
        if (nativeCheckbox) {
            nativeCheckbox.nativeElement.indeterminate = value;
        }
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.1", ngImport: i0, type: RdsCheckboxComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "17.3.1", type: RdsCheckboxComponent, selector: "rds-checkbox", inputs: { id: "id", value: "value", name: "name", size: "size", ariaLabel: ["aria-label", "ariaLabel"], ariaLabelledby: ["aria-labelledby", "ariaLabelledby"], ariaDescribedby: ["aria-describedby", "ariaDescribedby"], formControlName: "formControlName", tabIndex: "tabIndex", checked: ["checked", "checked", booleanAttribute], disabled: ["disabled", "disabled", booleanAttribute], indeterminate: "indeterminate", required: "required" }, outputs: { changed: "changed" }, host: { properties: { "class": "this.hostClass", "tabIndex": "this.hostTabindex", "attr.id": "this.getHostId", "class.rds-checkbox--indeterminate": "this.hostIndeterminate", "class.rds-checkbox--checked": "this.hostChecked", "class.rds-checkbox--disabled": "this.hostDisabled", "class.rds-checkbox--invalid": "this.errorState", "attr.required": "this.attrRequired" } }, providers: [
            {
                provide: NG_VALUE_ACCESSOR,
                useExisting: forwardRef(() => RdsCheckboxComponent),
                multi: true,
            },
        ], viewQueries: [{ propertyName: "checkboxLabel", first: true, predicate: ["checkboxLabel"], descendants: true }, { propertyName: "_inputElement", first: true, predicate: ["input"], descendants: true }], ngImport: i0, template: `
    <div class="rds-checkbox__wrapper">
      <label [attr.for]="inputId" class="rds-checkbox__container" #label>
        <div class="rds-checkbox__checkbox-container">
          <input
            #input
            class="rds-checkbox__native-checkbox cdk-visually-hidden"
            type="checkbox"
            [id]="inputId"
            [required]="required"
            [checked]="checked"
            [attr.value]="value"
            [disabled]="disabled"
            [attr.name]="name"
            [tabIndex]="tabIndex"
            [attr.aria-label]="ariaLabel || null"
            [attr.aria-labelledby]="ariaLabelledby"
            [attr.aria-checked]="ariaChecked"
            [attr.aria-describedby]="ariaDescribedby"
            (click)="onInputClick($event)"
          />
          <div class="rds-checkbox__overlay"></div>
          <div class="rds-checkbox__frame"></div>
          <div class="rds-checkbox__background">
            <svg
              focusable="false"
              class="rds-checkbox__checkmark"
              viewBox="0 0 24 24"
              xml:space="preserve"
            >
              <path
                class="rds-checkbox__checkmark-path"
                fill="none"
                d="M4.1,12.7 9,17.6 20.3,6.3"
              />
            </svg>
            <div class="rds-checkbox__indeterminate-mark"></div>
          </div>
        </div>
        <span
          class="rds-checkbox__label"
          [ngClass]="'rds-checkbox__label--' + size"
          #checkboxLabel
          (cdkObserveContent)="onLabelTextChange()"
        >
          @if (required && !disabled) {
            <span class="rds-asterisk">&#32;* </span>
          }
          <!-- Add an invisible span so JAWS can read the label -->
          <span style="display:none">&nbsp;</span>
          <ng-content />
        </span>
      </label>
    </div>
    <div class="rds-checkbox__subscript-wrapper">
      @switch (isErrorMessageVisible) {
        @case (true) {
          <div
            class="rds-checkbox__subscript rds-checkbox__subscript--error"
            [@transitionMessages]="subscriptAnimationState"
          >
            <ng-content select="rds-control-error" />
          </div>
        }
        @case (false) {
          <div
            class="rds-checkbox__subscript rds-checkbox__subscript--hint"
            [@transitionMessages]="subscriptAnimationState"
          >
            <ng-content select="rds-control-hint" />
          </div>
        }
      }
    </div>
  `, isInline: true, styles: ["@keyframes rds-checkbox__fade-in-background{0%{opacity:0}50%{opacity:1}}@keyframes rds-checkbox__fade-out-background{0%,50%{opacity:1}to{opacity:0}}@keyframes rds-checkbox__from-checked-to-indeterminate-checkmark{0%{animation-timing-function:cubic-bezier(0,0,.2,.1);opacity:1;transform:rotate(0)}to{opacity:0;transform:rotate(45deg)}}@keyframes rds-checkbox__from-indeterminate-to-checked-checkmark{0%{animation-timing-function:cubic-bezier(.14,0,0,1);opacity:0;transform:rotate(45deg)}to{opacity:1;transform:rotate(360deg)}}@keyframes rds-checkbox__from-unchecked-to-checked-checkmark-path{0%,50%{stroke-dashoffset:22.910259}50%{animation-timing-function:cubic-bezier(0,0,.2,.1)}to{stroke-dashoffset:0}}@keyframes rds-checkbox__from-checked-to-unchecked-checkmark-path{0%{animation-timing-function:cubic-bezier(.4,0,1,1);stroke-dashoffset:0}to{stroke-dashoffset:-22.910259}}@keyframes rds-checkbox__from-unchecked-to-indeterminate-indeterminate-mark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0,0,0,1)}to{transform:scaleX(1)}}@keyframes rds-checkbox__from-checked-to-indeterminate-indeterminate-mark{0%{animation-timing-function:cubic-bezier(0,0,.2,.1);opacity:0;transform:rotate(-45deg)}to{opacity:1;transform:rotate(0)}}@keyframes rds-checkbox__from-indeterminate-to-checked-indeterminate-mark{0%{animation-timing-function:cubic-bezier(.14,0,0,1);opacity:1;transform:rotate(0)}to{opacity:0;transform:rotate(315deg)}}@keyframes rds-checkbox__from-indeterminate-to-unchecked-indeterminate-mark{0%{animation-timing-function:linear;opacity:1;transform:scaleX(1)}32.8%,to{opacity:0;transform:scaleX(0)}}.rds-checkbox{display:flex;flex-direction:column}.rds-checkbox.rds-checkbox-with-label .rds-checkbox__checkbox-container{margin:auto 10px auto auto}.rds-checkbox__wrapper{align-items:center;display:inline-flex;transition:background .4s cubic-bezier(.25,.8,.25,1);margin:4px 0;height:24px;cursor:pointer}.rds-checkbox__wrapper .rds-checkbox__container{align-items:center;display:inline-flex;-webkit-user-select:none;user-select:none;cursor:inherit;white-space:nowrap}.rds-checkbox__wrapper .rds-checkbox__checkbox-container{position:relative;display:inline-block;margin:auto;height:18px;width:18px}.rds-checkbox__wrapper .rds-checkbox__native-checkbox{bottom:0;left:50%}.rds-checkbox__wrapper .rds-checkbox__overlay{position:absolute;inset:0;transform:translate(-9px,-9px);transition:border-color 90ms cubic-bezier(0,0,.2,.1),background 90ms cubic-bezier(0,0,.2,.1);border:2px solid transparent;border-radius:2px;width:36px;height:36px;background:transparent}.rds-checkbox__wrapper .rds-checkbox__frame{position:absolute;inset:0;transition:border-color 90ms cubic-bezier(0,0,.2,.1);border:2px solid var(--rds-color-grey-3);border-radius:2px;background:transparent}.rds-checkbox__wrapper .rds-checkbox__background{position:absolute;inset:0;justify-content:center;align-items:center;display:inline-flex;opacity:0;transition:opacity 90ms cubic-bezier(0,0,.2,.1);border-radius:2px;background:var(--rds-color-informative)}.rds-checkbox__wrapper .rds-checkbox__checkmark{position:absolute;inset:0;opacity:0;width:100%;fill:var(--rds-color-bg-base-1);stroke:var(--rds-color-bg-base-1)}.rds-checkbox__wrapper .rds-checkbox__checkmark-path{stroke-dashoffset:0;stroke-dasharray:22.910259;stroke-width:2.1333333333px}.rds-checkbox__wrapper .rds-checkbox__indeterminate-mark{opacity:0;transform:scaleX(0) rotate(0) translateY(0);width:calc(100% - 6px);height:2px;background:var(--rds-color-bg-base-1)}.rds-checkbox__wrapper .rds-checkbox__label{color:var(--rds-color-high-contrast)}.rds-checkbox__wrapper .rds-checkbox__label--s{font-size:14px;font-weight:200;line-height:20px;text-transform:none;letter-spacing:.3px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-checkbox__wrapper .rds-checkbox__label--m{font-size:16px;font-weight:200;line-height:24px;text-transform:none;letter-spacing:.2px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-checkbox__wrapper .rds-checkbox__label--l{font-size:18px;font-weight:200;line-height:24px;text-transform:none;letter-spacing:.2px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-checkbox.rds-checkbox--checked .rds-checkbox__checkmark{opacity:1}.rds-checkbox.rds-checkbox--checked .rds-checkbox__checkmark-path{stroke-dashoffset:0}.rds-checkbox.rds-checkbox--checked .rds-checkbox__background{opacity:1}.rds-checkbox.rds-checkbox--checked .rds-checkbox__indeterminate-mark{transform:scaleX(1) rotate(-45deg)}.rds-checkbox.rds-checkbox--indeterminate .rds-checkbox__checkmark{opacity:0;transform:rotate(45deg)}.rds-checkbox.rds-checkbox--indeterminate .rds-checkbox__checkmark-path{stroke-dashoffset:0}.rds-checkbox.rds-checkbox--indeterminate .rds-checkbox__indeterminate-mark{opacity:1;transform:scaleX(1) rotate(0) translateY(0)}.rds-checkbox.rds-checkbox--indeterminate .rds-checkbox__background{opacity:1}.rds-checkbox.cdk-focused.cdk-keyboard-focused .rds-checkbox__overlay{background:transparent;border-color:var(--rds-color-stroke-active-focus)}.rds-checkbox:hover:not(.rds-checkbox--disabled) .rds-checkbox__overlay{background:var(--rds-color-bg-transparent-hover-select)}.rds-checkbox:active:not(.rds-checkbox--disabled) .rds-checkbox__overlay{background:var(--rds-color-bg-transparent-pressed)}.rds-checkbox.rds-checkbox--disabled,.rds-checkbox.rds-checkbox--disabled .rds-checkbox__wrapper{cursor:default}.rds-checkbox.rds-checkbox--disabled.rds-checkbox--checked .rds-checkbox__background,.rds-checkbox.rds-checkbox--disabled.rds-checkbox--indeterminate .rds-checkbox__background{background:var(--rds-color-grey-2)}.rds-checkbox.rds-checkbox--disabled .rds-checkbox__frame{border-color:var(--rds-color-grey-2)}.rds-checkbox.rds-checkbox--disabled .rds-checkbox__label{color:var(--rds-color-disabled)}.rds-checkbox--invalid .rds-checkbox__background{background:var(--rds-color-error)}.rds-checkbox--invalid .rds-checkbox__frame{border-color:var(--rds-color-error)}.rds-checkbox-animation--unchecked-checked .rds-checkbox__background{animation:.18s linear 0ms rds-checkbox__fade-in-background}.rds-checkbox-animation--unchecked-checked .rds-checkbox__checkmark-path{animation:.18s linear 0ms rds-checkbox__from-unchecked-to-checked-checkmark-path}.rds-checkbox-animation--unchecked-indeterminate .rds-checkbox__background{animation:.18s linear 0ms rds-checkbox__fade-in-background}.rds-checkbox-animation--unchecked-indeterminate .rds-checkbox__indeterminate-mark{animation:90ms linear 0ms rds-checkbox__from-unchecked-to-indeterminate-indeterminate-mark}.rds-checkbox-animation--checked-unchecked .rds-checkbox__background{animation:.18s linear 0ms rds-checkbox__fade-out-background}.rds-checkbox-animation--checked-unchecked .rds-checkbox__checkmark-path{animation:90ms linear 0ms rds-checkbox__from-checked-to-unchecked-checkmark-path}.rds-checkbox-animation--checked-indeterminate .rds-checkbox__checkmark{animation:90ms linear 0ms rds-checkbox__from-checked-to-indeterminate-checkmark}.rds-checkbox-animation--checked-indeterminate .rds-checkbox__indeterminate-mark{animation:90ms linear 0ms rds-checkbox__from-checked-to-indeterminate-indeterminate-mark}.rds-checkbox-animation--indeterminate-checked .rds-checkbox__checkmark{animation:.5s linear 0ms rds-checkbox__from-indeterminate-to-checked-checkmark}.rds-checkbox-animation--indeterminate-checked .rds-checkbox__indeterminate-mark{animation:.5s linear 0ms rds-checkbox__from-indeterminate-to-checked-indeterminate-mark}.rds-checkbox-animation--indeterminate-unchecked .rds-checkbox__background{animation:.18s linear 0ms rds-checkbox__fade-out-background}.rds-checkbox-animation--indeterminate-unchecked .rds-checkbox__indeterminate-mark{animation:.3s linear 0ms rds-checkbox__from-indeterminate-to-unchecked-indeterminate-mark}.rds-asterisk{color:var(--rds-color-error)}.rds-checkbox__subscript-wrapper>div:not(:empty){margin-top:4px}.rds-checkbox--disabled .rds-checkbox__subscript{color:var(--rds-color-disabled)}.rds-checkbox__subscript{font-size:12px;font-weight:400;line-height:16px;text-transform:none;letter-spacing:.5px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-align:left}.rds-checkbox__subscript--hint{color:var(--rds-color-low-contrast)}.rds-checkbox__subscript--error{color:var(--rds-color-error)}\n"], dependencies: [{ kind: "directive", type: i1.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i2.CdkObserveContent, selector: "[cdkObserveContent]", inputs: ["cdkObserveContentDisabled", "debounce"], outputs: ["cdkObserveContent"], exportAs: ["cdkObserveContent"] }], animations: [rdsCheckboxAnimations.transitionMessages], changeDetection: i0.ChangeDetectionStrategy.OnPush, encapsulation: i0.ViewEncapsulation.None }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.1", ngImport: i0, type: RdsCheckboxComponent, decorators: [{
            type: Component,
            args: [{ selector: 'rds-checkbox', template: `
    <div class="rds-checkbox__wrapper">
      <label [attr.for]="inputId" class="rds-checkbox__container" #label>
        <div class="rds-checkbox__checkbox-container">
          <input
            #input
            class="rds-checkbox__native-checkbox cdk-visually-hidden"
            type="checkbox"
            [id]="inputId"
            [required]="required"
            [checked]="checked"
            [attr.value]="value"
            [disabled]="disabled"
            [attr.name]="name"
            [tabIndex]="tabIndex"
            [attr.aria-label]="ariaLabel || null"
            [attr.aria-labelledby]="ariaLabelledby"
            [attr.aria-checked]="ariaChecked"
            [attr.aria-describedby]="ariaDescribedby"
            (click)="onInputClick($event)"
          />
          <div class="rds-checkbox__overlay"></div>
          <div class="rds-checkbox__frame"></div>
          <div class="rds-checkbox__background">
            <svg
              focusable="false"
              class="rds-checkbox__checkmark"
              viewBox="0 0 24 24"
              xml:space="preserve"
            >
              <path
                class="rds-checkbox__checkmark-path"
                fill="none"
                d="M4.1,12.7 9,17.6 20.3,6.3"
              />
            </svg>
            <div class="rds-checkbox__indeterminate-mark"></div>
          </div>
        </div>
        <span
          class="rds-checkbox__label"
          [ngClass]="'rds-checkbox__label--' + size"
          #checkboxLabel
          (cdkObserveContent)="onLabelTextChange()"
        >
          @if (required && !disabled) {
            <span class="rds-asterisk">&#32;* </span>
          }
          <!-- Add an invisible span so JAWS can read the label -->
          <span style="display:none">&nbsp;</span>
          <ng-content />
        </span>
      </label>
    </div>
    <div class="rds-checkbox__subscript-wrapper">
      @switch (isErrorMessageVisible) {
        @case (true) {
          <div
            class="rds-checkbox__subscript rds-checkbox__subscript--error"
            [@transitionMessages]="subscriptAnimationState"
          >
            <ng-content select="rds-control-error" />
          </div>
        }
        @case (false) {
          <div
            class="rds-checkbox__subscript rds-checkbox__subscript--hint"
            [@transitionMessages]="subscriptAnimationState"
          >
            <ng-content select="rds-control-hint" />
          </div>
        }
      }
    </div>
  `, providers: [
                        {
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: forwardRef(() => RdsCheckboxComponent),
                            multi: true,
                        },
                    ], encapsulation: ViewEncapsulation.None, animations: [rdsCheckboxAnimations.transitionMessages], changeDetection: ChangeDetectionStrategy.OnPush, styles: ["@keyframes rds-checkbox__fade-in-background{0%{opacity:0}50%{opacity:1}}@keyframes rds-checkbox__fade-out-background{0%,50%{opacity:1}to{opacity:0}}@keyframes rds-checkbox__from-checked-to-indeterminate-checkmark{0%{animation-timing-function:cubic-bezier(0,0,.2,.1);opacity:1;transform:rotate(0)}to{opacity:0;transform:rotate(45deg)}}@keyframes rds-checkbox__from-indeterminate-to-checked-checkmark{0%{animation-timing-function:cubic-bezier(.14,0,0,1);opacity:0;transform:rotate(45deg)}to{opacity:1;transform:rotate(360deg)}}@keyframes rds-checkbox__from-unchecked-to-checked-checkmark-path{0%,50%{stroke-dashoffset:22.910259}50%{animation-timing-function:cubic-bezier(0,0,.2,.1)}to{stroke-dashoffset:0}}@keyframes rds-checkbox__from-checked-to-unchecked-checkmark-path{0%{animation-timing-function:cubic-bezier(.4,0,1,1);stroke-dashoffset:0}to{stroke-dashoffset:-22.910259}}@keyframes rds-checkbox__from-unchecked-to-indeterminate-indeterminate-mark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0,0,0,1)}to{transform:scaleX(1)}}@keyframes rds-checkbox__from-checked-to-indeterminate-indeterminate-mark{0%{animation-timing-function:cubic-bezier(0,0,.2,.1);opacity:0;transform:rotate(-45deg)}to{opacity:1;transform:rotate(0)}}@keyframes rds-checkbox__from-indeterminate-to-checked-indeterminate-mark{0%{animation-timing-function:cubic-bezier(.14,0,0,1);opacity:1;transform:rotate(0)}to{opacity:0;transform:rotate(315deg)}}@keyframes rds-checkbox__from-indeterminate-to-unchecked-indeterminate-mark{0%{animation-timing-function:linear;opacity:1;transform:scaleX(1)}32.8%,to{opacity:0;transform:scaleX(0)}}.rds-checkbox{display:flex;flex-direction:column}.rds-checkbox.rds-checkbox-with-label .rds-checkbox__checkbox-container{margin:auto 10px auto auto}.rds-checkbox__wrapper{align-items:center;display:inline-flex;transition:background .4s cubic-bezier(.25,.8,.25,1);margin:4px 0;height:24px;cursor:pointer}.rds-checkbox__wrapper .rds-checkbox__container{align-items:center;display:inline-flex;-webkit-user-select:none;user-select:none;cursor:inherit;white-space:nowrap}.rds-checkbox__wrapper .rds-checkbox__checkbox-container{position:relative;display:inline-block;margin:auto;height:18px;width:18px}.rds-checkbox__wrapper .rds-checkbox__native-checkbox{bottom:0;left:50%}.rds-checkbox__wrapper .rds-checkbox__overlay{position:absolute;inset:0;transform:translate(-9px,-9px);transition:border-color 90ms cubic-bezier(0,0,.2,.1),background 90ms cubic-bezier(0,0,.2,.1);border:2px solid transparent;border-radius:2px;width:36px;height:36px;background:transparent}.rds-checkbox__wrapper .rds-checkbox__frame{position:absolute;inset:0;transition:border-color 90ms cubic-bezier(0,0,.2,.1);border:2px solid var(--rds-color-grey-3);border-radius:2px;background:transparent}.rds-checkbox__wrapper .rds-checkbox__background{position:absolute;inset:0;justify-content:center;align-items:center;display:inline-flex;opacity:0;transition:opacity 90ms cubic-bezier(0,0,.2,.1);border-radius:2px;background:var(--rds-color-informative)}.rds-checkbox__wrapper .rds-checkbox__checkmark{position:absolute;inset:0;opacity:0;width:100%;fill:var(--rds-color-bg-base-1);stroke:var(--rds-color-bg-base-1)}.rds-checkbox__wrapper .rds-checkbox__checkmark-path{stroke-dashoffset:0;stroke-dasharray:22.910259;stroke-width:2.1333333333px}.rds-checkbox__wrapper .rds-checkbox__indeterminate-mark{opacity:0;transform:scaleX(0) rotate(0) translateY(0);width:calc(100% - 6px);height:2px;background:var(--rds-color-bg-base-1)}.rds-checkbox__wrapper .rds-checkbox__label{color:var(--rds-color-high-contrast)}.rds-checkbox__wrapper .rds-checkbox__label--s{font-size:14px;font-weight:200;line-height:20px;text-transform:none;letter-spacing:.3px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-checkbox__wrapper .rds-checkbox__label--m{font-size:16px;font-weight:200;line-height:24px;text-transform:none;letter-spacing:.2px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-checkbox__wrapper .rds-checkbox__label--l{font-size:18px;font-weight:200;line-height:24px;text-transform:none;letter-spacing:.2px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-checkbox.rds-checkbox--checked .rds-checkbox__checkmark{opacity:1}.rds-checkbox.rds-checkbox--checked .rds-checkbox__checkmark-path{stroke-dashoffset:0}.rds-checkbox.rds-checkbox--checked .rds-checkbox__background{opacity:1}.rds-checkbox.rds-checkbox--checked .rds-checkbox__indeterminate-mark{transform:scaleX(1) rotate(-45deg)}.rds-checkbox.rds-checkbox--indeterminate .rds-checkbox__checkmark{opacity:0;transform:rotate(45deg)}.rds-checkbox.rds-checkbox--indeterminate .rds-checkbox__checkmark-path{stroke-dashoffset:0}.rds-checkbox.rds-checkbox--indeterminate .rds-checkbox__indeterminate-mark{opacity:1;transform:scaleX(1) rotate(0) translateY(0)}.rds-checkbox.rds-checkbox--indeterminate .rds-checkbox__background{opacity:1}.rds-checkbox.cdk-focused.cdk-keyboard-focused .rds-checkbox__overlay{background:transparent;border-color:var(--rds-color-stroke-active-focus)}.rds-checkbox:hover:not(.rds-checkbox--disabled) .rds-checkbox__overlay{background:var(--rds-color-bg-transparent-hover-select)}.rds-checkbox:active:not(.rds-checkbox--disabled) .rds-checkbox__overlay{background:var(--rds-color-bg-transparent-pressed)}.rds-checkbox.rds-checkbox--disabled,.rds-checkbox.rds-checkbox--disabled .rds-checkbox__wrapper{cursor:default}.rds-checkbox.rds-checkbox--disabled.rds-checkbox--checked .rds-checkbox__background,.rds-checkbox.rds-checkbox--disabled.rds-checkbox--indeterminate .rds-checkbox__background{background:var(--rds-color-grey-2)}.rds-checkbox.rds-checkbox--disabled .rds-checkbox__frame{border-color:var(--rds-color-grey-2)}.rds-checkbox.rds-checkbox--disabled .rds-checkbox__label{color:var(--rds-color-disabled)}.rds-checkbox--invalid .rds-checkbox__background{background:var(--rds-color-error)}.rds-checkbox--invalid .rds-checkbox__frame{border-color:var(--rds-color-error)}.rds-checkbox-animation--unchecked-checked .rds-checkbox__background{animation:.18s linear 0ms rds-checkbox__fade-in-background}.rds-checkbox-animation--unchecked-checked .rds-checkbox__checkmark-path{animation:.18s linear 0ms rds-checkbox__from-unchecked-to-checked-checkmark-path}.rds-checkbox-animation--unchecked-indeterminate .rds-checkbox__background{animation:.18s linear 0ms rds-checkbox__fade-in-background}.rds-checkbox-animation--unchecked-indeterminate .rds-checkbox__indeterminate-mark{animation:90ms linear 0ms rds-checkbox__from-unchecked-to-indeterminate-indeterminate-mark}.rds-checkbox-animation--checked-unchecked .rds-checkbox__background{animation:.18s linear 0ms rds-checkbox__fade-out-background}.rds-checkbox-animation--checked-unchecked .rds-checkbox__checkmark-path{animation:90ms linear 0ms rds-checkbox__from-checked-to-unchecked-checkmark-path}.rds-checkbox-animation--checked-indeterminate .rds-checkbox__checkmark{animation:90ms linear 0ms rds-checkbox__from-checked-to-indeterminate-checkmark}.rds-checkbox-animation--checked-indeterminate .rds-checkbox__indeterminate-mark{animation:90ms linear 0ms rds-checkbox__from-checked-to-indeterminate-indeterminate-mark}.rds-checkbox-animation--indeterminate-checked .rds-checkbox__checkmark{animation:.5s linear 0ms rds-checkbox__from-indeterminate-to-checked-checkmark}.rds-checkbox-animation--indeterminate-checked .rds-checkbox__indeterminate-mark{animation:.5s linear 0ms rds-checkbox__from-indeterminate-to-checked-indeterminate-mark}.rds-checkbox-animation--indeterminate-unchecked .rds-checkbox__background{animation:.18s linear 0ms rds-checkbox__fade-out-background}.rds-checkbox-animation--indeterminate-unchecked .rds-checkbox__indeterminate-mark{animation:.3s linear 0ms rds-checkbox__from-indeterminate-to-unchecked-indeterminate-mark}.rds-asterisk{color:var(--rds-color-error)}.rds-checkbox__subscript-wrapper>div:not(:empty){margin-top:4px}.rds-checkbox--disabled .rds-checkbox__subscript{color:var(--rds-color-disabled)}.rds-checkbox__subscript{font-size:12px;font-weight:400;line-height:16px;text-transform:none;letter-spacing:.5px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-align:left}.rds-checkbox__subscript--hint{color:var(--rds-color-low-contrast)}.rds-checkbox__subscript--error{color:var(--rds-color-error)}\n"] }]
        }], propDecorators: { checkboxLabel: [{
                type: ViewChild,
                args: ['checkboxLabel']
            }], hostClass: [{
                type: HostBinding,
                args: ['class']
            }], hostTabindex: [{
                type: HostBinding,
                args: ['tabIndex']
            }], getHostId: [{
                type: HostBinding,
                args: ['attr.id']
            }], hostIndeterminate: [{
                type: HostBinding,
                args: ['class.rds-checkbox--indeterminate']
            }], hostChecked: [{
                type: HostBinding,
                args: ['class.rds-checkbox--checked']
            }], hostDisabled: [{
                type: HostBinding,
                args: ['class.rds-checkbox--disabled']
            }], errorState: [{
                type: HostBinding,
                args: ['class.rds-checkbox--invalid']
            }], id: [{
                type: Input
            }], value: [{
                type: Input
            }], name: [{
                type: Input
            }], size: [{
                type: Input
            }], ariaLabel: [{
                type: Input,
                args: ['aria-label']
            }], ariaLabelledby: [{
                type: Input,
                args: ['aria-labelledby']
            }], ariaDescribedby: [{
                type: Input,
                args: ['aria-describedby']
            }], formControlName: [{
                type: Input
            }], tabIndex: [{
                type: Input
            }], checked: [{
                type: Input,
                args: [{ transform: booleanAttribute }]
            }], disabled: [{
                type: Input,
                args: [{ transform: booleanAttribute }]
            }], indeterminate: [{
                type: Input
            }], attrRequired: [{
                type: HostBinding,
                args: ['attr.required']
            }], required: [{
                type: Input
            }], changed: [{
                type: Output
            }], _inputElement: [{
                type: ViewChild,
                args: ['input']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hlY2tib3guY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vbGlicy9hbmd1bGFyLWNvbXBvbmVudHMvc3JjL2xpYi9jaGVja2JveC9jaGVja2JveC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFtQixZQUFZLEVBQWUsTUFBTSxtQkFBbUIsQ0FBQztBQUUvRSxPQUFPLEVBR0wsZ0JBQWdCLEVBQ2hCLHVCQUF1QixFQUN2QixpQkFBaUIsRUFDakIsU0FBUyxFQUNULFVBQVUsRUFFVixVQUFVLEVBQ1YsWUFBWSxFQUNaLFVBQVUsRUFDVixXQUFXLEVBQ1gsTUFBTSxFQUNOLEtBQUssRUFDTCxNQUFNLEVBQ04sZUFBZSxFQUdmLE1BQU0sRUFDTixTQUFTLEVBQ1QsaUJBQWlCLEdBQ2xCLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFFTCxnQkFBZ0IsRUFFaEIsa0JBQWtCLEVBQ2xCLGlCQUFpQixFQUNqQixNQUFNLEVBQ04sVUFBVSxHQUNYLE1BQU0sZ0JBQWdCLENBQUM7QUFDeEIsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUM1QixPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUNqRSxPQUFPLEVBQ0wsT0FBTyxFQUVQLEtBQUssRUFDTCxLQUFLLEVBQ0wsVUFBVSxFQUNWLE9BQU8sR0FDUixNQUFNLHFCQUFxQixDQUFDO0FBQzdCLE9BQU8sRUFDTCxpQkFBaUIsRUFDakIsdUJBQXVCLEVBQ3ZCLGdCQUFnQixHQUNqQixNQUFNLFVBQVUsQ0FBQztBQUNsQixPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQzs7OztBQUVoRSxJQUFJLFlBQVksR0FBRyxDQUFDLENBQUM7QUFFckIsTUFBTSxDQUFDLE1BQU0scUJBQXFCLEdBRTlCO0lBQ0YsMkVBQTJFO0lBQzNFLGtCQUFrQixFQUFFLE9B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ekMsS0FBSzt1QkFBQyxrQkFBa0I7Z0JBQ2hCLGVBQWU7c0JBQXZCLEtBQUs7Z0JBR0YsUUFBUTtzQkFEWCxLQUFLO2dCQVNrQyxPQUFPO3NCQUE5QyxLQUFLO3VCQUFDLEVBQUUsU0FBUyxFQUFFLGdCQUFnQixFQUFFO2dCQUNFLFFBQVE7c0JBQS9DLEtBQUs7dUJBQUMsRUFBRSxTQUFTLEVBQUUsZ0JBQWdCLEVBQUU7Z0JBR2xDLGFBQWE7c0JBRGhCLEtBQUs7Z0JBc0JGLFlBQVk7c0JBRGYsV0FBVzt1QkFBQyxlQUFlO2dCQVV4QixRQUFRO3NCQURYLEtBQUs7Z0JBU2EsT0FBTztzQkFBekIsTUFBTTtnQkFFYSxhQUFhO3NCQUFoQyxTQUFTO3VCQUFDLE9BQU8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBGb2N1c2FibGVPcHRpb24sIEZvY3VzTW9uaXRvciwgRm9jdXNPcmlnaW4gfSBmcm9tICdAYW5ndWxhci9jZGsvYTExeSc7XG5pbXBvcnQgeyBCb29sZWFuSW5wdXQsIE51bWJlcklucHV0IH0gZnJvbSAnQGFuZ3VsYXIvY2RrL2NvZXJjaW9uJztcbmltcG9ydCB7XG4gIEFmdGVyQ29udGVudEluaXQsXG4gIEFmdGVyVmlld0luaXQsXG4gIGJvb2xlYW5BdHRyaWJ1dGUsXG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxuICBDaGFuZ2VEZXRlY3RvclJlZixcbiAgQ29tcG9uZW50LFxuICBEZXN0cm95UmVmLFxuICBEb0NoZWNrLFxuICBFbGVtZW50UmVmLFxuICBFdmVudEVtaXR0ZXIsXG4gIGZvcndhcmRSZWYsXG4gIEhvc3RCaW5kaW5nLFxuICBpbmplY3QsXG4gIElucHV0LFxuICBOZ1pvbmUsXG4gIG51bWJlckF0dHJpYnV0ZSxcbiAgT25EZXN0cm95LFxuICBPbkluaXQsXG4gIE91dHB1dCxcbiAgVmlld0NoaWxkLFxuICBWaWV3RW5jYXBzdWxhdGlvbixcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1xuICBBYnN0cmFjdENvbnRyb2wsXG4gIENvbnRyb2xDb250YWluZXIsXG4gIENvbnRyb2xWYWx1ZUFjY2Vzc29yLFxuICBGb3JtR3JvdXBEaXJlY3RpdmUsXG4gIE5HX1ZBTFVFX0FDQ0VTU09SLFxuICBOZ0Zvcm0sXG4gIFZhbGlkYXRvcnMsXG59IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCB7IG5vb3AgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IFJkc0NoZWNrYm94Q2hhbmdlRXZlbnQgfSBmcm9tICcuL2NoZWNrYm94LWNoYW5nZS5ldmVudCc7XG5pbXBvcnQge1xuICBhbmltYXRlLFxuICBBbmltYXRpb25UcmlnZ2VyTWV0YWRhdGEsXG4gIHN0YXRlLFxuICBzdHlsZSxcbiAgdHJhbnNpdGlvbixcbiAgdHJpZ2dlcixcbn0gZnJvbSAnQGFuZ3VsYXIvYW5pbWF0aW9ucyc7XG5pbXBvcnQge1xuICBUQUJfSU5ERVhfREVGQVVMVCxcbiAgVEFCX0lOREVYX05PVF9GT0NVU0FCTEUsXG4gIHVwZGF0ZUVycm9yU3RhdGUsXG59IGZyb20gJy4uL3V0aWxzJztcbmltcG9ydCB7IHRha2VVbnRpbERlc3Ryb3llZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUvcnhqcy1pbnRlcm9wJztcblxubGV0IG5leHRVbmlxdWVJZCA9IDA7XG5cbmV4cG9ydCBjb25zdCByZHNDaGVja2JveEFuaW1hdGlvbnM6IHtcbiAgcmVhZG9ubHkgdHJhbnNpdGlvbk1lc3NhZ2VzOiBBbmltYXRpb25UcmlnZ2VyTWV0YWRhdGE7XG59ID0ge1xuICAvKiogQW5pbWF0aW9uIHRoYXQgdHJhbnNpdGlvbnMgdGhlIGZvcm0gZmllbGQncyBlcnJvciBhbmQgaGludCBtZXNzYWdlcy4gKi9cbiAgdHJhbnNpdGlvbk1lc3NhZ2VzOiB0cmlnZ2VyKCd0cmFuc2l0aW9uTWVzc2FnZXMnLCBbXG4gICAgc3RhdGUoJ2VudGVyJywgc3R5bGUoeyBvcGFjaXR5OiAxLCB0cmFuc2Zvcm06ICd0cmFuc2xhdGVZKDAlKScgfSkpLFxuICAgIHRyYW5zaXRpb24oJ3ZvaWQgPT4gZW50ZXInLCBbXG4gICAgICBzdHlsZSh7IG9wYWNpdHk6IDAsIHRyYW5zZm9ybTogJ3RyYW5zbGF0ZVkoLTEwMCUpJyB9KSxcbiAgICAgIGFuaW1hdGUoJzIwMG1zIGN1YmljLWJlemllcigwLjU1LCAwLCAwLjU1LCAwLjIpJyksXG4gICAgXSksXG4gIF0pLFxufTtcblxuZXhwb3J0IHR5cGUgUmRzQ2hlY2tib3hTaXplID0gJ3MnIHwgJ20nIHwgJ2wnO1xuXG5leHBvcnQgY29uc3QgZW51bSBUcmFuc2l0aW9uQ2hlY2tTdGF0ZSB7XG4gIEluaXQsXG4gIENoZWNrZWQsXG4gIFVuY2hlY2tlZCxcbiAgSW5kZXRlcm1pbmF0ZSxcbn1cblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAncmRzLWNoZWNrYm94JyxcbiAgdGVtcGxhdGU6IGBcbiAgICA8ZGl2IGNsYXNzPVwicmRzLWNoZWNrYm94X193cmFwcGVyXCI+XG4gICAgICA8bGFiZWwgW2F0dHIuZm9yXT1cImlucHV0SWRcIiBjbGFzcz1cInJkcy1jaGVja2JveF9fY29udGFpbmVyXCIgI2xhYmVsPlxuICAgICAgICA8ZGl2IGNsYXNzPVwicmRzLWNoZWNrYm94X19jaGVja2JveC1jb250YWluZXJcIj5cbiAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICNpbnB1dFxuICAgICAgICAgICAgY2xhc3M9XCJyZHMtY2hlY2tib3hfX25hdGl2ZS1jaGVja2JveCBjZGstdmlzdWFsbHktaGlkZGVuXCJcbiAgICAgICAgICAgIHR5cGU9XCJjaGVja2JveFwiXG4gICAgICAgICAgICBbaWRdPVwiaW5wdXRJZFwiXG4gICAgICAgICAgICBbcmVxdWlyZWRdPVwicmVxdWlyZWRcIlxuICAgICAgICAgICAgW2NoZWNrZWRdPVwiY2hlY2tlZFwiXG4gICAgICAgICAgICBbYXR0ci52YWx1ZV09XCJ2YWx1ZVwiXG4gICAgICAgICAgICBbZGlzYWJsZWRdPVwiZGlzYWJsZWRcIlxuICAgICAgICAgICAgW2F0dHIubmFtZV09XCJuYW1lXCJcbiAgICAgICAgICAgIFt0YWJJbmRleF09XCJ0YWJJbmRleFwiXG4gICAgICAgICAgICBbYXR0ci5hcmlhLWxhYmVsXT1cImFyaWFMYWJlbCB8fCBudWxsXCJcbiAgICAgICAgICAgIFthdHRyLmFyaWEtbGFiZWxsZWRieV09XCJhcmlhTGFiZWxsZWRieVwiXG4gICAgICAgICAgICBbYXR0ci5hcmlhLWNoZWNrZWRdPVwiYXJpYUNoZWNrZWRcIlxuICAgICAgICAgICAgW2F0dHIuYXJpYS1kZXNjcmliZWRieV09XCJhcmlhRGVzY3JpYmVkYnlcIlxuICAgICAgICAgICAgKGNsaWNrKT1cIm9uSW5wdXRDbGljaygkZXZlbnQpXCJcbiAgICAgICAgICAvPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJyZHMtY2hlY2tib3hfX292ZXJsYXlcIj48L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwicmRzLWNoZWNrYm94X19mcmFtZVwiPjwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJyZHMtY2hlY2tib3hfX2JhY2tncm91bmRcIj5cbiAgICAgICAgICAgIDxzdmdcbiAgICAgICAgICAgICAgZm9jdXNhYmxlPVwiZmFsc2VcIlxuICAgICAgICAgICAgICBjbGFzcz1cInJkcy1jaGVja2JveF9fY2hlY2ttYXJrXCJcbiAgICAgICAgICAgICAgdmlld0JveD1cIjAgMCAyNCAyNFwiXG4gICAgICAgICAgICAgIHhtbDpzcGFjZT1cInByZXNlcnZlXCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPHBhdGhcbiAgICAgICAgICAgICAgICBjbGFzcz1cInJkcy1jaGVja2JveF9fY2hlY2ttYXJrLXBhdGhcIlxuICAgICAgICAgICAgICAgIGZpbGw9XCJub25lXCJcbiAgICAgICAgICAgICAgICBkPVwiTTQuMSwxMi43IDksMTcuNiAyMC4zLDYuM1wiXG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJyZHMtY2hlY2tib3hfX2luZGV0ZXJtaW5hdGUtbWFya1wiPjwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPHNwYW5cbiAgICAgICAgICBjbGFzcz1cInJkcy1jaGVja2JveF9fbGFiZWxcIlxuICAgICAgICAgIFtuZ0NsYXNzXT1cIidyZHMtY2hlY2tib3hfX2xhYmVsLS0nICsgc2l6ZVwiXG4gICAgICAgICAgI2NoZWNrYm94TGFiZWxcbiAgICAgICAgICAoY2RrT2JzZXJ2ZUNvbnRlbnQpPVwib25MYWJlbFRleHRDaGFuZ2UoKVwiXG4gICAgICAgID5cbiAgICAgICAgICBAaWYgKHJlcXVpcmVkICYmICFkaXNhYmxlZCkge1xuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJyZHMtYXN0ZXJpc2tcIj4mIzMyOyogPC9zcGFuPlxuICAgICAgICAgIH1cbiAgICAgICAgICA8IS0tIEFkZCBhbiBpbnZpc2libGUgc3BhbiBzbyBKQVdTIGNhbiByZWFkIHRoZSBsYWJlbCAtLT5cbiAgICAgICAgICA8c3BhbiBzdHlsZT1cImRpc3BsYXk6bm9uZVwiPiZuYnNwOzwvc3Bhbj5cbiAgICAgICAgICA8bmctY29udGVudCAvPlxuICAgICAgICA8L3NwYW4+XG4gICAgICA8L2xhYmVsPlxuICAgIDwvZGl2PlxuICAgIDxkaXYgY2xhc3M9XCJyZHMtY2hlY2tib3hfX3N1YnNjcmlwdC13cmFwcGVyXCI+XG4gICAgICBAc3dpdGNoIChpc0Vycm9yTWVzc2FnZVZpc2libGUpIHtcbiAgICAgICAgQGNhc2UgKHRydWUpIHtcbiAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICBjbGFzcz1cInJkcy1jaGVja2JveF9fc3Vic2NyaXB0IHJkcy1jaGVja2JveF9fc3Vic2NyaXB0LS1lcnJvclwiXG4gICAgICAgICAgICBbQHRyYW5zaXRpb25NZXNzYWdlc109XCJzdWJzY3JpcHRBbmltYXRpb25TdGF0ZVwiXG4gICAgICAgICAgPlxuICAgICAgICAgICAgPG5nLWNvbnRlbnQgc2VsZWN0PVwicmRzLWNvbnRyb2wtZXJyb3JcIiAvPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICB9XG4gICAgICAgIEBjYXNlIChmYWxzZSkge1xuICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgIGNsYXNzPVwicmRzLWNoZWNrYm94X19zdWJzY3JpcHQgcmRzLWNoZWNrYm94X19zdWJzY3JpcHQtLWhpbnRcIlxuICAgICAgICAgICAgW0B0cmFuc2l0aW9uTWVzc2FnZXNdPVwic3Vic2NyaXB0QW5pbWF0aW9uU3RhdGVcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxuZy1jb250ZW50IHNlbGVjdD1cInJkcy1jb250cm9sLWhpbnRcIiAvPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICB9XG4gICAgICB9XG4gICAgPC9kaXY+XG4gIGAsXG4gIHByb3ZpZGVyczogW1xuICAgIHtcbiAgICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxuICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gUmRzQ2hlY2tib3hDb21wb25lbnQpLFxuICAgICAgbXVsdGk6IHRydWUsXG4gICAgfSxcbiAgXSxcbiAgc3R5bGVVcmxzOiBbJy4vY2hlY2tib3guY29tcG9uZW50LnNjc3MnXSxcbiAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZSxcbiAgYW5pbWF0aW9uczogW3Jkc0NoZWNrYm94QW5pbWF0aW9ucy50cmFuc2l0aW9uTWVzc2FnZXNdLFxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbn0pXG5leHBvcnQgY2xhc3MgUmRzQ2hlY2tib3hDb21wb25lbnRcbiAgaW1wbGVtZW50c1xuICAgIENvbnRyb2xWYWx1ZUFjY2Vzc29yLFxuICAgIEFmdGVyVmlld0luaXQsXG4gICAgQWZ0ZXJDb250ZW50SW5pdCxcbiAgICBEb0NoZWNrLFxuICAgIE9uRGVzdHJveSxcbiAgICBPbkluaXQsXG4gICAgRm9jdXNhYmxlT3B0aW9uXG57XG4gIHByaXZhdGUgcmVhZG9ubHkgZGVzdHJveVJlZiA9IGluamVjdChEZXN0cm95UmVmKTtcbiAgcHJpdmF0ZSByZWFkb25seSBlbGVtZW50UmVmID0gaW5qZWN0PEVsZW1lbnRSZWY8SFRNTEVsZW1lbnQ+PihFbGVtZW50UmVmKTtcbiAgcHJpdmF0ZSByZWFkb25seSBjZHIgPSBpbmplY3QoQ2hhbmdlRGV0ZWN0b3JSZWYpO1xuICBwcml2YXRlIHJlYWRvbmx5IGZvY3VzTW9uaXRvciA9IGluamVjdChGb2N1c01vbml0b3IpO1xuICBwcml2YXRlIHJlYWRvbmx5IG5nWm9uZSA9IGluamVjdChOZ1pvbmUpO1xuICBwcml2YXRlIHJlYWRvbmx5IHBhcmVudEZvcm0gPSBpbmplY3QoTmdGb3JtLCB7IG9wdGlvbmFsOiB0cnVlIH0pO1xuICBwcml2YXRlIHJlYWRvbmx5IHBhcmVudEZvcm1Hcm91cCA9IGluamVjdChGb3JtR3JvdXBEaXJlY3RpdmUsIHtcbiAgICBvcHRpb25hbDogdHJ1ZSxcbiAgfSk7XG4gIHByaXZhdGUgcmVhZG9ubHkgY29udHJvbENvbnRhaW5lciA9IGluamVjdChDb250cm9sQ29udGFpbmVyLCB7XG4gICAgb3B0aW9uYWw6IHRydWUsXG4gICAgaG9zdDogdHJ1ZSxcbiAgICBza2lwU2VsZjogdHJ1ZSxcbiAgfSk7XG5cbiAgcHJpdmF0ZSBfcmVxdWlyZWQ6IGJvb2xlYW47XG4gIHByaXZhdGUgX3VuaXF1ZUlkID0gYHJkcy1jaGVja2JveC0keysrbmV4dFVuaXF1ZUlkfWA7XG4gIHByaXZhdGUgX2N1cnJlbnRBbmltYXRpb25DbGFzcyA9ICcnO1xuICBwcml2YXRlIF9lcnJvclN0YXRlID0gZmFsc2U7XG4gIHByaXZhdGUgX3RhYkluZGV4ID0gVEFCX0lOREVYX0RFRkFVTFQ7XG4gIHByaXZhdGUgX2luZGV0ZXJtaW5hdGUgPSBmYWxzZTtcbiAgcHJpdmF0ZSBfY29udHJvbDogQWJzdHJhY3RDb250cm9sIHwgbnVsbCB8IHVuZGVmaW5lZDtcblxuICBwcml2YXRlIF9jdXJyZW50Q2hlY2tTdGF0ZSA9IFRyYW5zaXRpb25DaGVja1N0YXRlLkluaXQ7XG5cbiAgc3Vic2NyaXB0QW5pbWF0aW9uU3RhdGU6ICcnIHwgJ2VudGVyJyA9ICcnO1xuXG4gIEBWaWV3Q2hpbGQoJ2NoZWNrYm94TGFiZWwnKSBjaGVja2JveExhYmVsOiBFbGVtZW50UmVmO1xuXG4gIEBIb3N0QmluZGluZygnY2xhc3MnKSByZWFkb25seSBob3N0Q2xhc3MgPSAncmRzLWNoZWNrYm94JztcbiAgQEhvc3RCaW5kaW5nKCd0YWJJbmRleCcpIHJlYWRvbmx5IGhvc3RUYWJpbmRleDogc3RyaW5nO1xuXG4gIEBIb3N0QmluZGluZygnYXR0ci5pZCcpIGdldCBnZXRIb3N0SWQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5fdW5pcXVlSWQ7XG4gIH1cblxuICBASG9zdEJpbmRpbmcoJ2NsYXNzLnJkcy1jaGVja2JveC0taW5kZXRlcm1pbmF0ZScpXG4gIGdldCBob3N0SW5kZXRlcm1pbmF0ZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5pbmRldGVybWluYXRlO1xuICB9XG5cbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5yZHMtY2hlY2tib3gtLWNoZWNrZWQnKSBnZXQgaG9zdENoZWNrZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuY2hlY2tlZDtcbiAgfVxuXG4gIEBIb3N0QmluZGluZygnY2xhc3MucmRzLWNoZWNrYm94LS1kaXNhYmxlZCcpIGdldCBob3N0RGlzYWJsZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuZGlzYWJsZWQ7XG4gIH1cblxuICBASG9zdEJpbmRpbmcoJ2NsYXNzLnJkcy1jaGVja2JveC0taW52YWxpZCcpXG4gIGdldCBlcnJvclN0YXRlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9lcnJvclN0YXRlO1xuICB9XG5cbiAgQElucHV0KCkgaWQgPSB0aGlzLl91bmlxdWVJZDtcbiAgQElucHV0KCkgdmFsdWU6IHN0cmluZztcbiAgQElucHV0KCkgbmFtZTogc3RyaW5nO1xuICBASW5wdXQoKSBzaXplOiBSZHNDaGVja2JveFNpemUgPSAnbCc7XG5cbiAgQElucHV0KCdhcmlhLWxhYmVsJykgYXJpYUxhYmVsID0gJyc7XG4gIEBJbnB1dCgnYXJpYS1sYWJlbGxlZGJ5JykgYXJpYUxhYmVsbGVkYnk6IHN0cmluZztcbiAgQElucHV0KCdhcmlhLWRlc2NyaWJlZGJ5JykgYXJpYURlc2NyaWJlZGJ5OiBzdHJpbmc7XG4gIEBJbnB1dCgpIGZvcm1Db250cm9sTmFtZTogc3RyaW5nO1xuXG4gIEBJbnB1dCgpXG4gIHNldCB0YWJJbmRleCh2YWx1ZTogTnVtYmVySW5wdXQpIHtcbiAgICB0aGlzLl90YWJJbmRleCA9IG51bWJlckF0dHJpYnV0ZSh2YWx1ZSwgVEFCX0lOREVYX0RFRkFVTFQpO1xuICB9XG5cbiAgZ2V0IHRhYkluZGV4KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuZGlzYWJsZWQgPyBUQUJfSU5ERVhfTk9UX0ZPQ1VTQUJMRSA6IHRoaXMuX3RhYkluZGV4O1xuICB9XG5cbiAgQElucHV0KHsgdHJhbnNmb3JtOiBib29sZWFuQXR0cmlidXRlIH0pIGNoZWNrZWQgPSBmYWxzZTtcbiAgQElucHV0KHsgdHJhbnNmb3JtOiBib29sZWFuQXR0cmlidXRlIH0pIGRpc2FibGVkID0gZmFsc2U7XG5cbiAgQElucHV0KClcbiAgc2V0IGluZGV0ZXJtaW5hdGUodmFsdWU6IEJvb2xlYW5JbnB1dCkge1xuICAgIHRoaXMuX2luZGV0ZXJtaW5hdGUgPSBib29sZWFuQXR0cmlidXRlKHZhbHVlKTtcblxuICAgIGlmICh0aGlzLmluZGV0ZXJtaW5hdGUpIHtcbiAgICAgIHRoaXMudHJhbnNpdGlvbkNoZWNrU3RhdGUoVHJhbnNpdGlvbkNoZWNrU3RhdGUuSW5kZXRlcm1pbmF0ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMudHJhbnNpdGlvbkNoZWNrU3RhdGUoXG4gICAgICAgIHRoaXMuY2hlY2tlZFxuICAgICAgICAgID8gVHJhbnNpdGlvbkNoZWNrU3RhdGUuQ2hlY2tlZFxuICAgICAgICAgIDogVHJhbnNpdGlvbkNoZWNrU3RhdGUuVW5jaGVja2VkLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICB0aGlzLnN5bmNJbmRldGVybWluYXRlKHRoaXMuaW5kZXRlcm1pbmF0ZSk7XG4gIH1cblxuICBnZXQgaW5kZXRlcm1pbmF0ZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5faW5kZXRlcm1pbmF0ZTtcbiAgfVxuXG4gIEBIb3N0QmluZGluZygnYXR0ci5yZXF1aXJlZCcpXG4gIGdldCBhdHRyUmVxdWlyZWQoKTogYm9vbGVhbiB8IG51bGwge1xuICAgIGlmICh0aGlzLl9jb250cm9sICYmIHRoaXMuX2NvbnRyb2w/Lmhhc1ZhbGlkYXRvcihWYWxpZGF0b3JzLnJlcXVpcmVkKSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NvbnRyb2w/Lmhhc1ZhbGlkYXRvcihWYWxpZGF0b3JzLnJlcXVpcmVkKSA/PyBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLl9yZXF1aXJlZCA/PyBudWxsO1xuICB9XG5cbiAgQElucHV0KClcbiAgc2V0IHJlcXVpcmVkKHZhbHVlOiBCb29sZWFuSW5wdXQpIHtcbiAgICB0aGlzLl9yZXF1aXJlZCA9IGJvb2xlYW5BdHRyaWJ1dGUodmFsdWUpO1xuICB9XG5cbiAgZ2V0IHJlcXVpcmVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmF0dHJSZXF1aXJlZCA/PyBmYWxzZTtcbiAgfVxuXG4gIEBPdXRwdXQoKSByZWFkb25seSBjaGFuZ2VkID0gbmV3IEV2ZW50RW1pdHRlcjxSZHNDaGVja2JveENoYW5nZUV2ZW50PigpO1xuXG4gIEBWaWV3Q2hpbGQoJ2lucHV0JykgX2lucHV0RWxlbWVudDogRWxlbWVudFJlZjxIVE1MSW5wdXRFbGVtZW50PjtcblxuICBfb25DaGFuZ2U6ICh2YWx1ZTogYm9vbGVhbikgPT4gdm9pZCA9IG5vb3A7XG4gIC8qIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55ICovXG4gIF9vblRvdWNoZWQ6ICgpID0+IGFueSA9IG5vb3A7XG5cbiAgZ2V0IGlucHV0SWQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYCR7dGhpcy5pZCB8fCB0aGlzLl91bmlxdWVJZH0taW5wdXRgO1xuICB9XG5cbiAgZ2V0IGFyaWFDaGVja2VkKCk6ICd0cnVlJyB8ICdmYWxzZScgfCAnbWl4ZWQnIHtcbiAgICBpZiAodGhpcy5jaGVja2VkKSB7XG4gICAgICByZXR1cm4gJ3RydWUnO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmluZGV0ZXJtaW5hdGUgPyAnbWl4ZWQnIDogJ2ZhbHNlJztcbiAgfVxuXG4gIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmNvbnRyb2xDb250YWluZXIpIHtcbiAgICAgIGlmICh0aGlzLmZvcm1Db250cm9sTmFtZSkge1xuICAgICAgICB0aGlzLl9jb250cm9sID0gdGhpcy5jb250cm9sQ29udGFpbmVyLmNvbnRyb2w/LmdldChcbiAgICAgICAgICB0aGlzLmZvcm1Db250cm9sTmFtZSxcbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIE1pc3NpbmcgRm9ybUNvbnRyb2xOYW1lIGRpcmVjdGl2ZSBmcm9tIGhvc3QgZWxlbWVudCBvZiB0aGUgY29tcG9uZW50XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIENhbid0IGZpbmQgcGFyZW50IEZvcm1Hcm91cCBkaXJlY3RpdmVcbiAgICB9XG4gIH1cblxuICBuZ0RvQ2hlY2soKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuX2NvbnRyb2wpIHtcbiAgICAgIC8vIFdlIG5lZWQgdG8gcmUtZXZhbHVhdGUgdGhpcyBvbiBldmVyeSBjaGFuZ2UgZGV0ZWN0aW9uIGN5Y2xlLCBiZWNhdXNlIHRoZXJlIGFyZSBzb21lXG4gICAgICAvLyBlcnJvciB0cmlnZ2VycyB0aGF0IHdlIGNhbid0IHN1YnNjcmliZSB0byAoZS5nLiBwYXJlbnQgZm9ybSBzdWJtaXNzaW9ucykuIFRoaXMgbWVhbnNcbiAgICAgIC8vIHRoYXQgd2hhdGV2ZXIgbG9naWMgaXMgaW4gaGVyZSBoYXMgdG8gYmUgc3VwZXIgbGVhbiBvciB3ZSByaXNrIGRlc3Ryb3lpbmcgdGhlIHBlcmZvcm1hbmNlLlxuICAgICAgdGhpcy5fZXJyb3JTdGF0ZSA9IHVwZGF0ZUVycm9yU3RhdGUoXG4gICAgICAgIHRoaXMuZXJyb3JTdGF0ZSxcbiAgICAgICAgdGhpcy5wYXJlbnRGb3JtR3JvdXAsXG4gICAgICAgIHRoaXMucGFyZW50Rm9ybSxcbiAgICAgICAgdGhpcy5fY29udHJvbCxcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgbmdBZnRlckNvbnRlbnRJbml0KCk6IHZvaWQge1xuICAgIGNvbnN0IGNvbnRyb2wgPSB0aGlzLl9jb250cm9sO1xuXG4gICAgaWYgKGNvbnRyb2wgJiYgY29udHJvbC52YWx1ZUNoYW5nZXMpIHtcbiAgICAgIGNvbnRyb2wudmFsdWVDaGFuZ2VzXG4gICAgICAgIC5waXBlKHRha2VVbnRpbERlc3Ryb3llZCh0aGlzLmRlc3Ryb3lSZWYpKVxuICAgICAgICAuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICBjb250cm9sPy5tYXJrQXNEaXJ0eSgpO1xuICAgICAgICAgIGNvbnRyb2w/Lm1hcmtBc1RvdWNoZWQoKTtcbiAgICAgICAgICB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgcGFyZW50ID0gdGhpcy5wYXJlbnRGb3JtR3JvdXAgfHwgdGhpcy5wYXJlbnRGb3JtO1xuXG4gICAgaWYgKHBhcmVudCkge1xuICAgICAgcGFyZW50Lm5nU3VibWl0XG4gICAgICAgIC5waXBlKHRha2VVbnRpbERlc3Ryb3llZCh0aGlzLmRlc3Ryb3lSZWYpKVxuICAgICAgICAuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmNoZWNrYm94TGFiZWwubmF0aXZlRWxlbWVudC5pbm5lclRleHQpIHtcbiAgICAgIHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3Jkcy1jaGVja2JveC13aXRoLWxhYmVsJyk7XG4gICAgfVxuXG4gICAgdGhpcy5mb2N1c01vbml0b3JcbiAgICAgIC5tb25pdG9yKHRoaXMuZWxlbWVudFJlZiwgdHJ1ZSlcbiAgICAgIC5zdWJzY3JpYmUoKGZvY3VzT3JpZ2luKSA9PiB7XG4gICAgICAgIGlmICghZm9jdXNPcmlnaW4pIHtcbiAgICAgICAgICAvLyBXaGVuIGEgZm9jdXNlZCBlbGVtZW50IGJlY29tZXMgZGlzYWJsZWQsIHRoZSBicm93c2VyICppbW1lZGlhdGVseSogZmlyZXMgYSBibHVyIGV2ZW50LlxuICAgICAgICAgIC8vIEFuZ3VsYXIgZG9lcyBub3QgZXhwZWN0IGV2ZW50cyB0byBiZSByYWlzZWQgZHVyaW5nIGNoYW5nZSBkZXRlY3Rpb24sIHNvIGFueSBzdGF0ZSBjaGFuZ2VcbiAgICAgICAgICAvLyAoc3VjaCBhcyBhIGZvcm0gY29udHJvbCdzICduZy10b3VjaGVkJykgd2lsbCBjYXVzZSBhIGNoYW5nZWQtYWZ0ZXItY2hlY2tlZCBlcnJvci5cbiAgICAgICAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvYW5ndWxhci9pc3N1ZXMvMTc3OTMuIFRvIHdvcmsgYXJvdW5kIHRoaXMsIHdlIGRlZmVyXG4gICAgICAgICAgLy8gdGVsbGluZyB0aGUgZm9ybSBjb250cm9sIGl0IGhhcyBiZWVuIHRvdWNoZWQgdW50aWwgdGhlIG5leHQgdGljay5cbiAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX29uVG91Y2hlZCgpO1xuICAgICAgICAgICAgdGhpcy5jZHIubWFya0ZvckNoZWNrKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgdGhpcy5zdWJzY3JpcHRBbmltYXRpb25TdGF0ZSA9ICdlbnRlcic7IC8vIEF2b2lkIGFuaW1hdGlvbnMgb24gbG9hZC5cbiAgICB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XG5cbiAgICB0aGlzLnN5bmNJbmRldGVybWluYXRlKHRoaXMuaW5kZXRlcm1pbmF0ZSk7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcbiAgICB0aGlzLmZvY3VzTW9uaXRvci5zdG9wTW9uaXRvcmluZyh0aGlzLmVsZW1lbnRSZWYpO1xuICB9XG5cbiAgZ2V0IGlzRXJyb3JNZXNzYWdlVmlzaWJsZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5lcnJvclN0YXRlO1xuICB9XG5cbiAgb25MYWJlbFRleHRDaGFuZ2UoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuY2hlY2tib3hMYWJlbC5uYXRpdmVFbGVtZW50LmlubmVyVGV4dCkge1xuICAgICAgdGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgncmRzLWNoZWNrYm94LXdpdGgtbGFiZWwnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncmRzLWNoZWNrYm94LXdpdGgtbGFiZWwnKTtcbiAgICB9XG5cbiAgICB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XG4gIH1cblxuICAvLyBzdGFydCBDb250cm9sVmFsdWVBY2Nlc3NvciAtIHBhcnRcbiAgd3JpdGVWYWx1ZSh2YWx1ZTogYm9vbGVhbik6IHZvaWQge1xuICAgIHRoaXMuY2hlY2tlZCA9IHZhbHVlO1xuICB9XG5cbiAgcmVnaXN0ZXJPbkNoYW5nZShmbjogKHZhbHVlOiBib29sZWFuKSA9PiB2b2lkKTogdm9pZCB7XG4gICAgdGhpcy5fb25DaGFuZ2UgPSBmbjtcbiAgfVxuXG4gIC8qIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55ICovXG4gIHJlZ2lzdGVyT25Ub3VjaGVkKGZuOiBhbnkpOiB2b2lkIHtcbiAgICB0aGlzLl9vblRvdWNoZWQgPSBmbjtcbiAgfVxuXG4gIHNldERpc2FibGVkU3RhdGUoaXNEaXNhYmxlZDogYm9vbGVhbik6IHZvaWQge1xuICAgIGlmICh0aGlzLmRpc2FibGVkICE9PSBpc0Rpc2FibGVkKSB7XG4gICAgICB0aGlzLmRpc2FibGVkID0gaXNEaXNhYmxlZDtcbiAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgfVxuXG4gIC8vIGVuZCBDb250cm9sVmFsdWVBY2Nlc3NvciAtIHBhcnRcblxuICBvbklucHV0Q2xpY2soZXZlbnQ6IEV2ZW50KTogdm9pZCB7XG4gICAgLy8gV2UgaGF2ZSB0byBzdG9wIHByb3BhZ2F0aW9uIGZvciBjbGljayBldmVudHMgb24gdGhlIHZpc3VhbCBoaWRkZW4gaW5wdXQgZWxlbWVudC5cbiAgICAvLyBCeSBkZWZhdWx0LCB3aGVuIGEgdXNlciBjbGlja3Mgb24gYSBsYWJlbCBlbGVtZW50LCBhIGdlbmVyYXRlZCBjbGljayBldmVudCB3aWxsIGJlXG4gICAgLy8gZGlzcGF0Y2hlZCBvbiB0aGUgYXNzb2NpYXRlZCBpbnB1dCBlbGVtZW50LiBTaW5jZSB3ZSBhcmUgdXNpbmcgYSBsYWJlbCBlbGVtZW50IGFzIG91clxuICAgIC8vIHJvb3QgY29udGFpbmVyLCB0aGUgY2xpY2sgZXZlbnQgb24gdGhlIGBjaGVja2JveGAgd2lsbCBiZSBleGVjdXRlZCB0d2ljZS5cbiAgICAvLyBUaGUgcmVhbCBjbGljayBldmVudCB3aWxsIGJ1YmJsZSB1cCwgYW5kIHRoZSBnZW5lcmF0ZWQgY2xpY2sgZXZlbnQgYWxzbyB0cmllcyB0byBidWJibGUgdXAuXG4gICAgLy8gVGhpcyB3aWxsIGxlYWQgdG8gbXVsdGlwbGUgY2xpY2sgZXZlbnRzLlxuICAgIC8vIFByZXZlbnRpbmcgYnViYmxpbmcgZm9yIHRoZSBzZWNvbmQgZXZlbnQgd2lsbCBzb2x2ZSB0aGF0IGlzc3VlLlxuICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgaWYgKHRoaXMuZGlzYWJsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKCgpID0+ICh0aGlzLmluZGV0ZXJtaW5hdGUgPSBmYWxzZSkpO1xuXG4gICAgdGhpcy50b2dnbGUoKTtcbiAgICB0aGlzLnRyYW5zaXRpb25DaGVja1N0YXRlKFxuICAgICAgdGhpcy5jaGVja2VkXG4gICAgICAgID8gVHJhbnNpdGlvbkNoZWNrU3RhdGUuQ2hlY2tlZFxuICAgICAgICA6IFRyYW5zaXRpb25DaGVja1N0YXRlLlVuY2hlY2tlZCxcbiAgICApO1xuICAgIHRoaXMuZW1pdENoYW5nZWRFdmVudCgpO1xuICB9XG5cbiAgZm9jdXMob3JpZ2luOiBGb2N1c09yaWdpbiA9ICdrZXlib2FyZCcsIG9wdGlvbnM/OiBGb2N1c09wdGlvbnMpOiB2b2lkIHtcbiAgICB0aGlzLmZvY3VzTW9uaXRvci5mb2N1c1ZpYSh0aGlzLl9pbnB1dEVsZW1lbnQsIG9yaWdpbiwgb3B0aW9ucyk7XG4gIH1cblxuICBwcml2YXRlIGdldEFuaW1hdGlvbkNsYXNzRm9yQ2hlY2tTdGF0ZVRyYW5zaXRpb24oXG4gICAgb2xkU3RhdGU6IFRyYW5zaXRpb25DaGVja1N0YXRlLFxuICAgIG5ld1N0YXRlOiBUcmFuc2l0aW9uQ2hlY2tTdGF0ZSxcbiAgKTogc3RyaW5nIHtcbiAgICBsZXQgYW5pbVN1ZmZpeCA9ICcnO1xuXG4gICAgc3dpdGNoIChvbGRTdGF0ZSkge1xuICAgICAgY2FzZSBUcmFuc2l0aW9uQ2hlY2tTdGF0ZS5Jbml0OlxuICAgICAgICBpZiAobmV3U3RhdGUgPT09IFRyYW5zaXRpb25DaGVja1N0YXRlLkNoZWNrZWQpIHtcbiAgICAgICAgICBhbmltU3VmZml4ID0gJ3VuY2hlY2tlZC1jaGVja2VkJztcbiAgICAgICAgfSBlbHNlIGlmIChuZXdTdGF0ZSA9PT0gVHJhbnNpdGlvbkNoZWNrU3RhdGUuSW5kZXRlcm1pbmF0ZSkge1xuICAgICAgICAgIGFuaW1TdWZmaXggPSAndW5jaGVja2VkLWluZGV0ZXJtaW5hdGUnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgfVxuXG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBUcmFuc2l0aW9uQ2hlY2tTdGF0ZS5VbmNoZWNrZWQ6XG4gICAgICAgIGFuaW1TdWZmaXggPVxuICAgICAgICAgIG5ld1N0YXRlID09PSBUcmFuc2l0aW9uQ2hlY2tTdGF0ZS5DaGVja2VkXG4gICAgICAgICAgICA/ICd1bmNoZWNrZWQtY2hlY2tlZCdcbiAgICAgICAgICAgIDogJ3VuY2hlY2tlZC1pbmRldGVybWluYXRlJztcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFRyYW5zaXRpb25DaGVja1N0YXRlLkNoZWNrZWQ6XG4gICAgICAgIGFuaW1TdWZmaXggPVxuICAgICAgICAgIG5ld1N0YXRlID09PSBUcmFuc2l0aW9uQ2hlY2tTdGF0ZS5VbmNoZWNrZWRcbiAgICAgICAgICAgID8gJ2NoZWNrZWQtdW5jaGVja2VkJ1xuICAgICAgICAgICAgOiAnY2hlY2tlZC1pbmRldGVybWluYXRlJztcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFRyYW5zaXRpb25DaGVja1N0YXRlLkluZGV0ZXJtaW5hdGU6XG4gICAgICAgIGFuaW1TdWZmaXggPVxuICAgICAgICAgIG5ld1N0YXRlID09PSBUcmFuc2l0aW9uQ2hlY2tTdGF0ZS5DaGVja2VkXG4gICAgICAgICAgICA/ICdpbmRldGVybWluYXRlLWNoZWNrZWQnXG4gICAgICAgICAgICA6ICdpbmRldGVybWluYXRlLXVuY2hlY2tlZCc7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIHJldHVybiBgcmRzLWNoZWNrYm94LWFuaW1hdGlvbi0tJHthbmltU3VmZml4fWA7XG4gIH1cblxuICBwcml2YXRlIHRyYW5zaXRpb25DaGVja1N0YXRlKG5ld1N0YXRlOiBUcmFuc2l0aW9uQ2hlY2tTdGF0ZSk6IHZvaWQge1xuICAgIGNvbnN0IG9sZFN0YXRlID0gdGhpcy5fY3VycmVudENoZWNrU3RhdGU7XG4gICAgY29uc3QgZWxlbWVudDogSFRNTEVsZW1lbnQgPSB0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudDtcblxuICAgIGlmIChvbGRTdGF0ZSA9PT0gbmV3U3RhdGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5fY3VycmVudEFuaW1hdGlvbkNsYXNzLmxlbmd0aCA+IDApIHtcbiAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jdXJyZW50QW5pbWF0aW9uQ2xhc3MpO1xuICAgIH1cblxuICAgIHRoaXMuX2N1cnJlbnRBbmltYXRpb25DbGFzcyA9IHRoaXMuZ2V0QW5pbWF0aW9uQ2xhc3NGb3JDaGVja1N0YXRlVHJhbnNpdGlvbihcbiAgICAgIG9sZFN0YXRlLFxuICAgICAgbmV3U3RhdGUsXG4gICAgKTtcbiAgICB0aGlzLl9jdXJyZW50Q2hlY2tTdGF0ZSA9IG5ld1N0YXRlO1xuXG4gICAgaWYgKHRoaXMuX2N1cnJlbnRBbmltYXRpb25DbGFzcy5sZW5ndGggPiAwKSB7XG4gICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY3VycmVudEFuaW1hdGlvbkNsYXNzKTtcblxuICAgICAgLy8gUmVtb3ZlIHRoZSBhbmltYXRpb24gY2xhc3MgdG8gYXZvaWQgYW5pbWF0aW9uIHdoZW4gdGhlIGNoZWNrYm94IGlzIG1vdmVkIGJldHdlZW4gY29udGFpbmVyc1xuICAgICAgY29uc3QgYW5pbWF0aW9uQ2xhc3MgPSB0aGlzLl9jdXJyZW50QW5pbWF0aW9uQ2xhc3M7XG5cbiAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGFuaW1hdGlvbkNsYXNzKTtcbiAgICAgICAgfSwgMTAwMCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHRvZ2dsZSgpOiB2b2lkIHtcbiAgICB0aGlzLmNoZWNrZWQgPSAhdGhpcy5jaGVja2VkO1xuICB9XG5cbiAgcHJpdmF0ZSBlbWl0Q2hhbmdlZEV2ZW50KCk6IHZvaWQge1xuICAgIGNvbnN0IGV2ZW50ID0gbmV3IFJkc0NoZWNrYm94Q2hhbmdlRXZlbnQoKTtcbiAgICBldmVudC5zb3VyY2UgPSB0aGlzO1xuICAgIGV2ZW50LmNoZWNrZWQgPSB0aGlzLmNoZWNrZWQ7XG5cbiAgICB0aGlzLl9vbkNoYW5nZSh0aGlzLmNoZWNrZWQpO1xuICAgIHRoaXMuY2hhbmdlZC5lbWl0KGV2ZW50KTtcbiAgfVxuXG4gIHByaXZhdGUgc3luY0luZGV0ZXJtaW5hdGUodmFsdWU6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICBjb25zdCBuYXRpdmVDaGVja2JveCA9IHRoaXMuX2lucHV0RWxlbWVudDtcblxuICAgIGlmIChuYXRpdmVDaGVja2JveCkge1xuICAgICAgbmF0aXZlQ2hlY2tib3gubmF0aXZlRWxlbWVudC5pbmRldGVybWluYXRlID0gdmFsdWU7XG4gICAgfVxuICB9XG59XG4iXX0=