// this basically is rdsTooltip directive, it's needed only to provide rdsPopover* input names
// and make sure that hide and show delays are = 0
import { Directive, HostBinding, Input } from '@angular/core';
import { RdsTooltipDirective } from '../tooltip';
import { fromEvent } from 'rxjs';
import { takeUntilDestroyed } from '@angular/core/rxjs-interop';
import * as i0 from "@angular/core";
export class RdsPopoverDirective extends RdsTooltipDirective {
    constructor() {
        super(...arguments);
        this._hasBackdrop = true;
        this.isPopover = true;
        this.showDelay = 0;
        this.hideDelay = 0;
        this.rdsPopoverRole = 'dialog';
        this.ariaDescription = '';
        this.touchGestures = 'auto';
        this.ariaExpanded = false;
        this._hideArrow = false;
    }
    get hideArrow() {
        return super.hideArrow;
    }
    set hideArrow(shouldHideArrow) {
        super.hideArrow = shouldHideArrow;
    }
    get position() {
        return super.position;
    }
    set position(value) {
        super.position = value;
    }
    set disabled(value) {
        super.disabled = value;
    }
    get disabled() {
        return super.disabled;
    }
    get content() {
        return super.content;
    }
    set content(value) {
        super.content = value;
    }
    get tooltipClass() {
        return super.tooltipClass;
    }
    set tooltipClass(value) {
        super.tooltipClass = value;
    }
    set hasBackdrop(v) {
        super.hasBackdrop = v;
    }
    get hasBackdrop() {
        return this._hasBackdrop;
    }
    set showCloseButton(v) {
        super.showCloseButton = v;
    }
    get showCloseButton() {
        return super.showCloseButton;
    }
    handleFocus() {
        setTimeout(() => {
            if (!this._tooltipInstance) {
                return;
            }
            const firstInteractive = this._tooltipInstance.getFirstFocusableElement();
            const lastInteractive = this._tooltipInstance.getLastFocusableElement();
            if (!firstInteractive) {
                return;
            }
            this.focusMonitor.focusVia(firstInteractive, this.origin);
            this.createTabHandler(firstInteractive, true);
            if (lastInteractive) {
                this.createTabHandler(lastInteractive, false);
            }
        });
    }
    createTabHandler(el, withShiftKey) {
        fromEvent(el, 'keydown')
            .pipe(takeUntilDestroyed(this.destroyRef))
            .subscribe((event) => {
            const { code, shiftKey } = event;
            if (code === 'Tab' && shiftKey === withShiftKey) {
                event.preventDefault();
                this.hide();
            }
        });
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.1", ngImport: i0, type: RdsPopoverDirective, deps: null, target: i0.ɵɵFactoryTarget.Directive }); }
    static { this.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "14.0.0", version: "17.3.1", type: RdsPopoverDirective, selector: "[rdsPopover], [rds-popover]", inputs: { rdsPopoverRole: "rdsPopoverRole", ariaDescription: ["rdsPopoverAriaDescription", "ariaDescription"], touchGestures: ["rdsPopoverTouchGestures", "touchGestures"], position: ["rdsPopoverPosition", "position"], disabled: ["rdsPopoverDisabled", "disabled"], content: ["rdsPopover", "content"], tooltipClass: ["rdsPopoverClass", "tooltipClass"], hasBackdrop: ["rdsPopoverHasBackdrop", "hasBackdrop"], showCloseButton: ["rdsPopoverShowCloseButton", "showCloseButton"] }, host: { properties: { "attr.aria-haspopup": "this.rdsPopoverRole", "attr.aria-expanded": "this.ariaExpanded" } }, exportAs: ["rdsPopover"], usesInheritance: true, ngImport: i0 }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.1", ngImport: i0, type: RdsPopoverDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: '[rdsPopover], [rds-popover]',
                    exportAs: 'rdsPopover',
                }]
        }], propDecorators: { rdsPopoverRole: [{
                type: Input
            }, {
                type: HostBinding,
                args: ['attr.aria-haspopup']
            }], ariaDescription: [{
                type: Input,
                args: ['rdsPopoverAriaDescription']
            }], touchGestures: [{
                type: Input,
                args: ['rdsPopoverTouchGestures']
            }], position: [{
                type: Input,
                args: ['rdsPopoverPosition']
            }], disabled: [{
                type: Input,
                args: ['rdsPopoverDisabled']
            }], content: [{
                type: Input,
                args: ['rdsPopover']
            }], tooltipClass: [{
                type: Input,
                args: ['rdsPopoverClass']
            }], hasBackdrop: [{
                type: Input,
                args: ['rdsPopoverHasBackdrop']
            }], showCloseButton: [{
                type: Input,
                args: ['rdsPopoverShowCloseButton']
            }], ariaExpanded: [{
                type: HostBinding,
                args: ['attr.aria-expanded']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG9wb3Zlci5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9saWJzL2FuZ3VsYXItY29tcG9uZW50cy9zcmMvbGliL3BvcG92ZXIvcG9wb3Zlci5kaXJlY3RpdmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsOEZBQThGO0FBQzlGLGtEQUFrRDtBQUNsRCxPQUFPLEVBQUUsU0FBUyxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQWUsTUFBTSxlQUFlLENBQUM7QUFFM0UsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sWUFBWSxDQUFDO0FBTWpELE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDakMsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sNEJBQTRCLENBQUM7O0FBTWhFLE1BQU0sT0FBTyxtQkFBb0IsU0FBUSxtQkFBbUI7SUFKNUQ7O1FBS3FCLGlCQUFZLEdBQUcsSUFBSSxDQUFDO1FBQ1gsY0FBUyxHQUFHLElBQUksQ0FBQztRQUNwQyxjQUFTLEdBQUcsQ0FBQyxDQUFDO1FBQ2QsY0FBUyxHQUFHLENBQUMsQ0FBQztRQUl2QixtQkFBYyxHQUFHLFFBQVEsQ0FBQztRQUVtQixvQkFBZSxHQUFHLEVBQUUsQ0FBQztRQVd6RCxrQkFBYSxHQUE0QixNQUFNLENBQUM7UUF1RHRDLGlCQUFZLEdBQW1CLEtBQUssQ0FBQztRQUVyQyxlQUFVLEdBQUcsS0FBSyxDQUFDO0tBb0N2QztJQXRHQyxJQUFhLFNBQVM7UUFDcEIsT0FBTyxLQUFLLENBQUMsU0FBUyxDQUFDO0lBQ3pCLENBQUM7SUFFRCxJQUFhLFNBQVMsQ0FBQyxlQUE2QjtRQUNsRCxLQUFLLENBQUMsU0FBUyxHQUFHLGVBQWUsQ0FBQztJQUNwQyxDQUFDO0lBS0QsSUFDYSxRQUFRO1FBQ25CLE9BQU8sS0FBSyxDQUFDLFFBQVEsQ0FBQztJQUN4QixDQUFDO0lBRUQsSUFBYSxRQUFRLENBQUMsS0FBeUI7UUFDN0Ms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QUFLO3VCQUFDLHlCQUF5QjtnQkFJbkIsUUFBUTtzQkFEcEIsS0FBSzt1QkFBQyxvQkFBb0I7Z0JBVWQsUUFBUTtzQkFEcEIsS0FBSzt1QkFBQyxvQkFBb0I7Z0JBVWQsT0FBTztzQkFEbkIsS0FBSzt1QkFBQyxZQUFZO2dCQVVOLFlBQVk7c0JBRHhCLEtBQUs7dUJBQUMsaUJBQWlCO2dCQVVYLFdBQVc7c0JBRHZCLEtBQUs7dUJBQUMsdUJBQXVCO2dCQVNqQixlQUFlO3NCQUQzQixLQUFLO3VCQUFDLDJCQUEyQjtnQkFTZixZQUFZO3NCQUQ5QixXQUFXO3VCQUFDLG9CQUFvQiIsInNvdXJjZXNDb250ZW50IjpbIi8vIHRoaXMgYmFzaWNhbGx5IGlzIHJkc1Rvb2x0aXAgZGlyZWN0aXZlLCBpdCdzIG5lZWRlZCBvbmx5IHRvIHByb3ZpZGUgcmRzUG9wb3ZlciogaW5wdXQgbmFtZXNcbi8vIGFuZCBtYWtlIHN1cmUgdGhhdCBoaWRlIGFuZCBzaG93IGRlbGF5cyBhcmUgPSAwXG5pbXBvcnQgeyBEaXJlY3RpdmUsIEhvc3RCaW5kaW5nLCBJbnB1dCwgVGVtcGxhdGVSZWYgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEJvb2xlYW5JbnB1dCB9IGZyb20gJ0Bhbmd1bGFyL2Nkay9jb2VyY2lvbic7XG5pbXBvcnQgeyBSZHNUb29sdGlwRGlyZWN0aXZlIH0gZnJvbSAnLi4vdG9vbHRpcCc7XG5pbXBvcnQge1xuICBSZHNQb3BvdmVyQ2xhc3MsXG4gIFJkc1BvcG92ZXJQb3NpdGlvbixcbiAgUmRzUG9wb3ZlclRvdWNoR2VzdHVyZXMsXG59IGZyb20gJy4vcG9wb3Zlci50eXBlcyc7XG5pbXBvcnQgeyBmcm9tRXZlbnQgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IHRha2VVbnRpbERlc3Ryb3llZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUvcnhqcy1pbnRlcm9wJztcblxuQERpcmVjdGl2ZSh7XG4gIHNlbGVjdG9yOiAnW3Jkc1BvcG92ZXJdLCBbcmRzLXBvcG92ZXJdJyxcbiAgZXhwb3J0QXM6ICdyZHNQb3BvdmVyJyxcbn0pXG5leHBvcnQgY2xhc3MgUmRzUG9wb3ZlckRpcmVjdGl2ZSBleHRlbmRzIFJkc1Rvb2x0aXBEaXJlY3RpdmUge1xuICBwcm90ZWN0ZWQgb3ZlcnJpZGUgX2hhc0JhY2tkcm9wID0gdHJ1ZTtcbiAgcHJvdGVjdGVkIG92ZXJyaWRlIHJlYWRvbmx5IGlzUG9wb3ZlciA9IHRydWU7XG4gIG92ZXJyaWRlIHNob3dEZWxheSA9IDA7XG4gIG92ZXJyaWRlIGhpZGVEZWxheSA9IDA7XG5cbiAgQElucHV0KClcbiAgQEhvc3RCaW5kaW5nKCdhdHRyLmFyaWEtaGFzcG9wdXAnKVxuICByZHNQb3BvdmVyUm9sZSA9ICdkaWFsb2cnO1xuXG4gIEBJbnB1dCgncmRzUG9wb3ZlckFyaWFEZXNjcmlwdGlvbicpIG92ZXJyaWRlIGFyaWFEZXNjcmlwdGlvbiA9ICcnO1xuXG4gIG92ZXJyaWRlIGdldCBoaWRlQXJyb3coKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHN1cGVyLmhpZGVBcnJvdztcbiAgfVxuXG4gIG92ZXJyaWRlIHNldCBoaWRlQXJyb3coc2hvdWxkSGlkZUFycm93OiBCb29sZWFuSW5wdXQpIHtcbiAgICBzdXBlci5oaWRlQXJyb3cgPSBzaG91bGRIaWRlQXJyb3c7XG4gIH1cblxuICBASW5wdXQoJ3Jkc1BvcG92ZXJUb3VjaEdlc3R1cmVzJylcbiAgb3ZlcnJpZGUgdG91Y2hHZXN0dXJlczogUmRzUG9wb3ZlclRvdWNoR2VzdHVyZXMgPSAnYXV0byc7XG5cbiAgQElucHV0KCdyZHNQb3BvdmVyUG9zaXRpb24nKVxuICBvdmVycmlkZSBnZXQgcG9zaXRpb24oKTogUmRzUG9wb3ZlclBvc2l0aW9uIHtcbiAgICByZXR1cm4gc3VwZXIucG9zaXRpb247XG4gIH1cblxuICBvdmVycmlkZSBzZXQgcG9zaXRpb24odmFsdWU6IFJkc1BvcG92ZXJQb3NpdGlvbikge1xuICAgIHN1cGVyLnBvc2l0aW9uID0gdmFsdWU7XG4gIH1cblxuICBASW5wdXQoJ3Jkc1BvcG92ZXJEaXNhYmxlZCcpXG4gIG92ZXJyaWRlIHNldCBkaXNhYmxlZCh2YWx1ZTogQm9vbGVhbklucHV0KSB7XG4gICAgc3VwZXIuZGlzYWJsZWQgPSB2YWx1ZTtcbiAgfVxuXG4gIG92ZXJyaWRlIGdldCBkaXNhYmxlZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gc3VwZXIuZGlzYWJsZWQ7XG4gIH1cblxuICBASW5wdXQoJ3Jkc1BvcG92ZXInKVxuICBvdmVycmlkZSBnZXQgY29udGVudCgpOiBzdHJpbmcgfCBUZW1wbGF0ZVJlZjx1bmtub3duPiB7XG4gICAgcmV0dXJuIHN1cGVyLmNvbnRlbnQ7XG4gIH1cblxuICBvdmVycmlkZSBzZXQgY29udGVudCh2YWx1ZTogc3RyaW5nIHwgVGVtcGxhdGVSZWY8dW5rbm93bj4pIHtcbiAgICBzdXBlci5jb250ZW50ID0gdmFsdWU7XG4gIH1cblxuICBASW5wdXQoJ3Jkc1BvcG92ZXJDbGFzcycpXG4gIG92ZXJyaWRlIGdldCB0b29sdGlwQ2xhc3MoKTogUmRzUG9wb3ZlckNsYXNzIHtcbiAgICByZXR1cm4gc3VwZXIudG9vbHRpcENsYXNzO1xuICB9XG5cbiAgb3ZlcnJpZGUgc2V0IHRvb2x0aXBDbGFzcyh2YWx1ZTogUmRzUG9wb3ZlckNsYXNzKSB7XG4gICAgc3VwZXIudG9vbHRpcENsYXNzID0gdmFsdWU7XG4gIH1cblxuICBASW5wdXQoJ3Jkc1BvcG92ZXJIYXNCYWNrZHJvcCcpXG4gIG92ZXJyaWRlIHNldCBoYXNCYWNrZHJvcCh2OiBCb29sZWFuSW5wdXQpIHtcbiAgICBzdXBlci5oYXNCYWNrZHJvcCA9IHY7XG4gIH1cbiAgb3ZlcnJpZGUgZ2V0IGhhc0JhY2tkcm9wKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9oYXNCYWNrZHJvcDtcbiAgfVxuXG4gIEBJbnB1dCgncmRzUG9wb3ZlclNob3dDbG9zZUJ1dHRvbicpXG4gIG92ZXJyaWRlIHNldCBzaG93Q2xvc2VCdXR0b24odjogQm9vbGVhbklucHV0KSB7XG4gICAgc3VwZXIuc2hvd0Nsb3NlQnV0dG9uID0gdjtcbiAgfVxuXG4gIG92ZXJyaWRlIGdldCBzaG93Q2xvc2VCdXR0b24oKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHN1cGVyLnNob3dDbG9zZUJ1dHRvbjtcbiAgfVxuICBASG9zdEJpbmRpbmcoJ2F0dHIuYXJpYS1leHBhbmRlZCcpXG4gIHByb3RlY3RlZCBvdmVycmlkZSBhcmlhRXhwYW5kZWQ6IGJvb2xlYW4gfCBudWxsID0gZmFsc2U7XG5cbiAgcHJvdGVjdGVkIG92ZXJyaWRlIF9oaWRlQXJyb3cgPSBmYWxzZTtcblxuICBwcm90ZWN0ZWQgb3ZlcnJpZGUgaGFuZGxlRm9jdXMoKTogdm9pZCB7XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuX3Rvb2x0aXBJbnN0YW5jZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGZpcnN0SW50ZXJhY3RpdmUgPSB0aGlzLl90b29sdGlwSW5zdGFuY2UuZ2V0Rmlyc3RGb2N1c2FibGVFbGVtZW50KCk7XG4gICAgICBjb25zdCBsYXN0SW50ZXJhY3RpdmUgPSB0aGlzLl90b29sdGlwSW5zdGFuY2UuZ2V0TGFzdEZvY3VzYWJsZUVsZW1lbnQoKTtcblxuICAgICAgaWYgKCFmaXJzdEludGVyYWN0aXZlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5mb2N1c01vbml0b3IuZm9jdXNWaWEoZmlyc3RJbnRlcmFjdGl2ZSwgdGhpcy5vcmlnaW4pO1xuICAgICAgdGhpcy5jcmVhdGVUYWJIYW5kbGVyKGZpcnN0SW50ZXJhY3RpdmUsIHRydWUpO1xuXG4gICAgICBpZiAobGFzdEludGVyYWN0aXZlKSB7XG4gICAgICAgIHRoaXMuY3JlYXRlVGFiSGFuZGxlcihsYXN0SW50ZXJhY3RpdmUsIGZhbHNlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlVGFiSGFuZGxlcihlbDogSFRNTEVsZW1lbnQsIHdpdGhTaGlmdEtleTogYm9vbGVhbik6IHZvaWQge1xuICAgIGZyb21FdmVudChlbCwgJ2tleWRvd24nKVxuICAgICAgLnBpcGUodGFrZVVudGlsRGVzdHJveWVkKHRoaXMuZGVzdHJveVJlZikpXG4gICAgICAuc3Vic2NyaWJlKChldmVudDogRXZlbnQpID0+IHtcbiAgICAgICAgY29uc3QgeyBjb2RlLCBzaGlmdEtleSB9ID0gZXZlbnQgYXMgS2V5Ym9hcmRFdmVudDtcblxuICAgICAgICBpZiAoY29kZSA9PT0gJ1RhYicgJiYgc2hpZnRLZXkgPT09IHdpdGhTaGlmdEtleSkge1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgdGhpcy5oaWRlKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9XG59XG4iXX0=