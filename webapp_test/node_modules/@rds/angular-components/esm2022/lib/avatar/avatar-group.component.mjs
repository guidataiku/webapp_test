import { ContentObserver } from '@angular/cdk/observers';
import { booleanAttribute, ChangeDetectionStrategy, ChangeDetectorRef, Component, ContentChildren, DestroyRef, ElementRef, HostBinding, inject, Input, numberAttribute, QueryList, ViewEncapsulation, } from '@angular/core';
import { merge, Subject } from 'rxjs';
import { RDS_AVATAR_MAX_IN_GROUP } from './avatar-group-max-items';
import { RdsAvatarComponent } from './avatar.component';
import { startWith } from 'rxjs/operators';
import { takeUntilDestroyed } from '@angular/core/rxjs-interop';
import * as i0 from "@angular/core";
export class RdsAvatarGroupComponent {
    constructor() {
        this.cdr = inject(ChangeDetectorRef);
        this.contentObserver = inject(ContentObserver);
        this.elementRef = inject(ElementRef);
        this.destroyRef = inject(DestroyRef);
        this.defaultMaxInGroup = inject(RDS_AVATAR_MAX_IN_GROUP);
        this._stateChanges = new Subject();
        this.class = 'rds-avatar-group';
        this.hiddenElements = 0;
        this.size = 'm';
        this._disableInteractions = false;
        this._maxInGroup = this.defaultMaxInGroup;
    }
    set disableInteractions(value) {
        this._disableInteractions = booleanAttribute(value);
        this.checkChildInputs();
    }
    get disableInteractions() {
        return this._disableInteractions;
    }
    set maxInGroup(maxInGroup) {
        const value = numberAttribute(maxInGroup, -1);
        const previousValue = this._maxInGroup;
        this._maxInGroup = value >= 0 ? value : this.defaultMaxInGroup;
        if (this._maxInGroup !== previousValue) {
            this._stateChanges.next();
        }
    }
    get maxInGroup() {
        return this._maxInGroup;
    }
    ngAfterContentInit() {
        merge(this._stateChanges, this.avatarList.changes, this.contentObserver.observe(this.elementRef))
            .pipe(startWith(null), takeUntilDestroyed(this.destroyRef))
            .subscribe(() => {
            const visibilityChanged = this.checkVisibility();
            if (visibilityChanged) {
                this.cdr.markForCheck();
            }
        });
    }
    ngOnDestroy() {
        this._stateChanges.complete();
    }
    checkVisibility() {
        let visibilityChanged = this.checkHiddenElements();
        this.avatarList.forEach((item, index) => {
            if (index < this.maxInGroup) {
                if (item._hasHiddenStyle()) {
                    item._clearHiddenStyles();
                    visibilityChanged = true;
                }
            }
            else if (!item._hasHiddenStyle()) {
                item._setHiddenStyles();
                visibilityChanged = true;
            }
        });
        this.checkChildInputs();
        return visibilityChanged;
    }
    checkChildInputs() {
        Promise.resolve().then(() => {
            this.avatarList
                .filter((i) => i.size !== this.size)
                .forEach((i) => (i.size = this.size));
            this.avatarList
                .filter((i) => i.disableInteractions !== this.disableInteractions)
                .forEach((i) => (i.disableInteractions = this.disableInteractions));
        });
    }
    checkHiddenElements() {
        const previous = this.hiddenElements;
        this.hiddenElements =
            this.avatarList?.length > this.maxInGroup
                ? this.avatarList.length - this.maxInGroup
                : 0;
        return previous !== this.hiddenElements;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.1", ngImport: i0, type: RdsAvatarGroupComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "17.3.1", type: RdsAvatarGroupComponent, isStandalone: true, selector: "rds-avatar-group", inputs: { size: "size", disableInteractions: "disableInteractions", maxInGroup: "maxInGroup" }, host: { properties: { "class": "this.class" } }, queries: [{ propertyName: "avatarList", predicate: RdsAvatarComponent }], ngImport: i0, template: `
    <ng-content select="rds-avatar" />
    @if (hiddenElements) {
      <rds-avatar [size]="size" [disableInteractions]="disableInteractions">
        <span rds-avatar-initials>+{{ hiddenElements }}</span>
      </rds-avatar>
    }
  `, isInline: true, styles: [".rds-avatar{display:flex;align-items:center}.rds-avatar.rds-avatar-xs{column-gap:8px}.rds-avatar.rds-avatar-xs .rds-avatar__container{font-size:12px;font-weight:400;line-height:16px;text-transform:none;letter-spacing:.5px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;border:1px solid var(--rds-color-avatar-stroke);width:24px;height:24px;flex-shrink:0}.rds-avatar.rds-avatar-xs .rds-avatar__container .rds-icon{width:16px;height:16px}.rds-avatar.rds-avatar-xs .rds-avatar__name-wrapper .rds-avatar-label{font-size:14px;font-weight:400;line-height:20px;text-transform:none;letter-spacing:.3px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-avatar.rds-avatar-xs .rds-avatar__name-wrapper .rds-avatar-description{font-size:14px;font-weight:200;line-height:20px;text-transform:none;letter-spacing:.3px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-avatar.rds-avatar-s{column-gap:8px}.rds-avatar.rds-avatar-s .rds-avatar__container{font-size:12px;font-weight:400;line-height:16px;text-transform:none;letter-spacing:.5px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;border:1px solid var(--rds-color-avatar-stroke);width:28px;height:28px;flex-shrink:0}.rds-avatar.rds-avatar-s .rds-avatar__container .rds-icon{width:18px;height:18px}.rds-avatar.rds-avatar-s .rds-avatar__name-wrapper .rds-avatar-label{font-size:14px;font-weight:400;line-height:20px;text-transform:none;letter-spacing:.3px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-avatar.rds-avatar-s .rds-avatar__name-wrapper .rds-avatar-description{font-size:14px;font-weight:200;line-height:20px;text-transform:none;letter-spacing:.3px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-avatar.rds-avatar-m{column-gap:12px}.rds-avatar.rds-avatar-m .rds-avatar__container{font-size:14px;font-weight:400;line-height:20px;text-transform:none;letter-spacing:.3px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;border:2px solid var(--rds-color-avatar-stroke);width:40px;height:40px;flex-shrink:0}.rds-avatar.rds-avatar-m .rds-avatar__container .rds-icon{width:24px;height:24px}.rds-avatar.rds-avatar-m .rds-avatar__name-wrapper .rds-avatar-label{font-size:16px;font-weight:400;line-height:24px;text-transform:none;letter-spacing:.2px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-avatar.rds-avatar-m .rds-avatar__name-wrapper .rds-avatar-description{font-size:14px;font-weight:200;line-height:20px;text-transform:none;letter-spacing:.3px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-avatar.rds-avatar-l{column-gap:16px}.rds-avatar.rds-avatar-l .rds-avatar__container{font-size:18px;font-weight:400;line-height:24px;text-transform:none;letter-spacing:.2px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;border:2px solid var(--rds-color-avatar-stroke);width:56px;height:56px;flex-shrink:0}.rds-avatar.rds-avatar-l .rds-avatar__container .rds-icon{width:32px;height:32px}.rds-avatar.rds-avatar-l .rds-avatar__name-wrapper .rds-avatar-label{font-size:16px;font-weight:400;line-height:24px;text-transform:none;letter-spacing:.2px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-avatar.rds-avatar-l .rds-avatar__name-wrapper .rds-avatar-description{font-size:14px;font-weight:200;line-height:20px;text-transform:none;letter-spacing:.3px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-avatar.rds-avatar-xl{column-gap:16px}.rds-avatar.rds-avatar-xl .rds-avatar__container{font-size:24px;font-weight:400;line-height:32px;text-transform:none;letter-spacing:0;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;border:2px solid var(--rds-color-avatar-stroke);width:80px;height:80px;flex-shrink:0}.rds-avatar.rds-avatar-xl .rds-avatar__container .rds-icon{width:48px;height:48px}.rds-avatar.rds-avatar-xl .rds-avatar__name-wrapper .rds-avatar-label{font-size:18px;font-weight:400;line-height:24px;text-transform:none;letter-spacing:.2px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-avatar.rds-avatar-xl .rds-avatar__name-wrapper .rds-avatar-description{font-size:16px;font-weight:200;line-height:24px;text-transform:none;letter-spacing:.2px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-avatar .rds-avatar__container{position:relative;display:flex;justify-content:center;align-items:center;border-radius:50%;background:var(--rds-color-avatar-bg);color:var(--rds-color-brand)}.rds-avatar .rds-avatar__name-wrapper{display:flex;flex-direction:column}.rds-avatar .rds-avatar-image{object-fit:cover;border-radius:50%;width:100%;height:100%}.rds-avatar.cdk-focused.cdk-keyboard-focused{outline:none}.rds-avatar.cdk-focused.cdk-keyboard-focused .rds-avatar__container{outline:2px solid var(--rds-color-stroke-active-focus)}.rds-avatar:hover .rds-avatar-overlay{display:block}.rds-avatar.rds-avatar-disable-interactions{pointer-events:none}.rds-avatar-group{display:flex;flex-direction:row}.rds-avatar-group .rds-avatar{display:unset}.rds-avatar-group .rds-avatar-xs:not(:first-child){margin-left:-8px}.rds-avatar-group .rds-avatar-s:not(:first-child){margin-left:-8px}.rds-avatar-group .rds-avatar-m:not(:first-child){margin-left:-16px}.rds-avatar-group .rds-avatar-l:not(:first-child){margin-left:-24px}.rds-avatar-group .rds-avatar-xl:not(:first-child){margin-left:-32px}.rds-avatar-group .rds-avatar__container.cdk-focused.cdk-keyboard-focused{outline:2px solid var(--rds-color-stroke-active-focus)}.rds-avatar-overlay{position:absolute;background:var(--rds-color-bg-transparent-hover-select);width:100%;height:100%;top:0;left:0;border-radius:50%;display:none}\n"], dependencies: [{ kind: "component", type: RdsAvatarComponent, selector: "rds-avatar", inputs: ["tabIndex", "size", "disableInteractions"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush, encapsulation: i0.ViewEncapsulation.None }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.1", ngImport: i0, type: RdsAvatarGroupComponent, decorators: [{
            type: Component,
            args: [{ selector: 'rds-avatar-group', template: `
    <ng-content select="rds-avatar" />
    @if (hiddenElements) {
      <rds-avatar [size]="size" [disableInteractions]="disableInteractions">
        <span rds-avatar-initials>+{{ hiddenElements }}</span>
      </rds-avatar>
    }
  `, encapsulation: ViewEncapsulation.None, changeDetection: ChangeDetectionStrategy.OnPush, standalone: true, imports: [RdsAvatarComponent], styles: [".rds-avatar{display:flex;align-items:center}.rds-avatar.rds-avatar-xs{column-gap:8px}.rds-avatar.rds-avatar-xs .rds-avatar__container{font-size:12px;font-weight:400;line-height:16px;text-transform:none;letter-spacing:.5px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;border:1px solid var(--rds-color-avatar-stroke);width:24px;height:24px;flex-shrink:0}.rds-avatar.rds-avatar-xs .rds-avatar__container .rds-icon{width:16px;height:16px}.rds-avatar.rds-avatar-xs .rds-avatar__name-wrapper .rds-avatar-label{font-size:14px;font-weight:400;line-height:20px;text-transform:none;letter-spacing:.3px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-avatar.rds-avatar-xs .rds-avatar__name-wrapper .rds-avatar-description{font-size:14px;font-weight:200;line-height:20px;text-transform:none;letter-spacing:.3px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-avatar.rds-avatar-s{column-gap:8px}.rds-avatar.rds-avatar-s .rds-avatar__container{font-size:12px;font-weight:400;line-height:16px;text-transform:none;letter-spacing:.5px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;border:1px solid var(--rds-color-avatar-stroke);width:28px;height:28px;flex-shrink:0}.rds-avatar.rds-avatar-s .rds-avatar__container .rds-icon{width:18px;height:18px}.rds-avatar.rds-avatar-s .rds-avatar__name-wrapper .rds-avatar-label{font-size:14px;font-weight:400;line-height:20px;text-transform:none;letter-spacing:.3px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-avatar.rds-avatar-s .rds-avatar__name-wrapper .rds-avatar-description{font-size:14px;font-weight:200;line-height:20px;text-transform:none;letter-spacing:.3px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-avatar.rds-avatar-m{column-gap:12px}.rds-avatar.rds-avatar-m .rds-avatar__container{font-size:14px;font-weight:400;line-height:20px;text-transform:none;letter-spacing:.3px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;border:2px solid var(--rds-color-avatar-stroke);width:40px;height:40px;flex-shrink:0}.rds-avatar.rds-avatar-m .rds-avatar__container .rds-icon{width:24px;height:24px}.rds-avatar.rds-avatar-m .rds-avatar__name-wrapper .rds-avatar-label{font-size:16px;font-weight:400;line-height:24px;text-transform:none;letter-spacing:.2px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-avatar.rds-avatar-m .rds-avatar__name-wrapper .rds-avatar-description{font-size:14px;font-weight:200;line-height:20px;text-transform:none;letter-spacing:.3px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-avatar.rds-avatar-l{column-gap:16px}.rds-avatar.rds-avatar-l .rds-avatar__container{font-size:18px;font-weight:400;line-height:24px;text-transform:none;letter-spacing:.2px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;border:2px solid var(--rds-color-avatar-stroke);width:56px;height:56px;flex-shrink:0}.rds-avatar.rds-avatar-l .rds-avatar__container .rds-icon{width:32px;height:32px}.rds-avatar.rds-avatar-l .rds-avatar__name-wrapper .rds-avatar-label{font-size:16px;font-weight:400;line-height:24px;text-transform:none;letter-spacing:.2px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-avatar.rds-avatar-l .rds-avatar__name-wrapper .rds-avatar-description{font-size:14px;font-weight:200;line-height:20px;text-transform:none;letter-spacing:.3px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-avatar.rds-avatar-xl{column-gap:16px}.rds-avatar.rds-avatar-xl .rds-avatar__container{font-size:24px;font-weight:400;line-height:32px;text-transform:none;letter-spacing:0;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;border:2px solid var(--rds-color-avatar-stroke);width:80px;height:80px;flex-shrink:0}.rds-avatar.rds-avatar-xl .rds-avatar__container .rds-icon{width:48px;height:48px}.rds-avatar.rds-avatar-xl .rds-avatar__name-wrapper .rds-avatar-label{font-size:18px;font-weight:400;line-height:24px;text-transform:none;letter-spacing:.2px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-avatar.rds-avatar-xl .rds-avatar__name-wrapper .rds-avatar-description{font-size:16px;font-weight:200;line-height:24px;text-transform:none;letter-spacing:.2px;font-family:roche-sans;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.rds-avatar .rds-avatar__container{position:relative;display:flex;justify-content:center;align-items:center;border-radius:50%;background:var(--rds-color-avatar-bg);color:var(--rds-color-brand)}.rds-avatar .rds-avatar__name-wrapper{display:flex;flex-direction:column}.rds-avatar .rds-avatar-image{object-fit:cover;border-radius:50%;width:100%;height:100%}.rds-avatar.cdk-focused.cdk-keyboard-focused{outline:none}.rds-avatar.cdk-focused.cdk-keyboard-focused .rds-avatar__container{outline:2px solid var(--rds-color-stroke-active-focus)}.rds-avatar:hover .rds-avatar-overlay{display:block}.rds-avatar.rds-avatar-disable-interactions{pointer-events:none}.rds-avatar-group{display:flex;flex-direction:row}.rds-avatar-group .rds-avatar{display:unset}.rds-avatar-group .rds-avatar-xs:not(:first-child){margin-left:-8px}.rds-avatar-group .rds-avatar-s:not(:first-child){margin-left:-8px}.rds-avatar-group .rds-avatar-m:not(:first-child){margin-left:-16px}.rds-avatar-group .rds-avatar-l:not(:first-child){margin-left:-24px}.rds-avatar-group .rds-avatar-xl:not(:first-child){margin-left:-32px}.rds-avatar-group .rds-avatar__container.cdk-focused.cdk-keyboard-focused{outline:2px solid var(--rds-color-stroke-active-focus)}.rds-avatar-overlay{position:absolute;background:var(--rds-color-bg-transparent-hover-select);width:100%;height:100%;top:0;left:0;border-radius:50%;display:none}\n"] }]
        }], propDecorators: { class: [{
                type: HostBinding,
                args: ['class']
            }], size: [{
                type: Input
            }], disableInteractions: [{
                type: Input
            }], maxInGroup: [{
                type: Input
            }], avatarList: [{
                type: ContentChildren,
                args: [RdsAvatarComponent]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXZhdGFyLWdyb3VwLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL2xpYnMvYW5ndWxhci1jb21wb25lbnRzL3NyYy9saWIvYXZhdGFyL2F2YXRhci1ncm91cC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQ3pELE9BQU8sRUFFTCxnQkFBZ0IsRUFDaEIsdUJBQXVCLEVBQ3ZCLGlCQUFpQixFQUNqQixTQUFTLEVBQ1QsZUFBZSxFQUNmLFVBQVUsRUFDVixVQUFVLEVBQ1YsV0FBVyxFQUNYLE1BQU0sRUFDTixLQUFLLEVBQ0wsZUFBZSxFQUVmLFNBQVMsRUFDVCxpQkFBaUIsR0FDbEIsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDdEMsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFDbkUsT0FBTyxFQUFFLGtCQUFrQixFQUFpQixNQUFNLG9CQUFvQixDQUFDO0FBQ3ZFLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUMzQyxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQzs7QUFtQmhFLE1BQU0sT0FBTyx1QkFBdUI7SUFoQnBDO1FBaUJtQixRQUFHLEdBQUcsTUFBTSxDQUFDLGlCQUFpQixDQUFDLENBQUM7UUFDaEMsb0JBQWUsR0FBRyxNQUFNLENBQUMsZUFBZSxDQUFDLENBQUM7UUFDMUMsZUFBVSxHQUFHLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNoQyxlQUFVLEdBQUcsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ2hDLHNCQUFpQixHQUFHLE1BQU0sQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO1FBQ3BELGtCQUFhLEdBQUcsSUFBSSxPQUFP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QkFBMUIsV0FBVzt1QkFBQyxPQUFPO2dCQUlYLElBQUk7c0JBQVosS0FBSztnQkFHRixtQkFBbUI7c0JBRHRCLEtBQUs7Z0JBYUYsVUFBVTtzQkFEYixLQUFLO2dCQWtCTixVQUFVO3NCQURULGVBQWU7dUJBQUMsa0JBQWtCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29udGVudE9ic2VydmVyIH0gZnJvbSAnQGFuZ3VsYXIvY2RrL29ic2VydmVycyc7XG5pbXBvcnQge1xuICBBZnRlckNvbnRlbnRJbml0LFxuICBib29sZWFuQXR0cmlidXRlLFxuICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcbiAgQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gIENvbXBvbmVudCxcbiAgQ29udGVudENoaWxkcmVuLFxuICBEZXN0cm95UmVmLFxuICBFbGVtZW50UmVmLFxuICBIb3N0QmluZGluZyxcbiAgaW5qZWN0LFxuICBJbnB1dCxcbiAgbnVtYmVyQXR0cmlidXRlLFxuICBPbkRlc3Ryb3ksXG4gIFF1ZXJ5TGlzdCxcbiAgVmlld0VuY2Fwc3VsYXRpb24sXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgbWVyZ2UsIFN1YmplY3QgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IFJEU19BVkFUQVJfTUFYX0lOX0dST1VQIH0gZnJvbSAnLi9hdmF0YXItZ3JvdXAtbWF4LWl0ZW1zJztcbmltcG9ydCB7IFJkc0F2YXRhckNvbXBvbmVudCwgUmRzQXZhdGFyU2l6ZSB9IGZyb20gJy4vYXZhdGFyLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBzdGFydFdpdGggfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyB0YWtlVW50aWxEZXN0cm95ZWQgfSBmcm9tICdAYW5ndWxhci9jb3JlL3J4anMtaW50ZXJvcCc7XG5pbXBvcnQgeyBCb29sZWFuSW5wdXQsIE51bWJlcklucHV0IH0gZnJvbSAnQGFuZ3VsYXIvY2RrL2NvZXJjaW9uJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAncmRzLWF2YXRhci1ncm91cCcsXG4gIHRlbXBsYXRlOiBgXG4gICAgPG5nLWNvbnRlbnQgc2VsZWN0PVwicmRzLWF2YXRhclwiIC8+XG4gICAgQGlmIChoaWRkZW5FbGVtZW50cykge1xuICAgICAgPHJkcy1hdmF0YXIgW3NpemVdPVwic2l6ZVwiIFtkaXNhYmxlSW50ZXJhY3Rpb25zXT1cImRpc2FibGVJbnRlcmFjdGlvbnNcIj5cbiAgICAgICAgPHNwYW4gcmRzLWF2YXRhci1pbml0aWFscz4re3sgaGlkZGVuRWxlbWVudHMgfX08L3NwYW4+XG4gICAgICA8L3Jkcy1hdmF0YXI+XG4gICAgfVxuICBgLFxuICBzdHlsZVVybHM6IFsnLi9hdmF0YXIuY29tcG9uZW50LnNjc3MnXSxcbiAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZSxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG4gIHN0YW5kYWxvbmU6IHRydWUsXG4gIGltcG9ydHM6IFtSZHNBdmF0YXJDb21wb25lbnRdLFxufSlcbmV4cG9ydCBjbGFzcyBSZHNBdmF0YXJHcm91cENvbXBvbmVudCBpbXBsZW1lbnRzIEFmdGVyQ29udGVudEluaXQsIE9uRGVzdHJveSB7XG4gIHByaXZhdGUgcmVhZG9ubHkgY2RyID0gaW5qZWN0KENoYW5nZURldGVjdG9yUmVmKTtcbiAgcHJpdmF0ZSByZWFkb25seSBjb250ZW50T2JzZXJ2ZXIgPSBpbmplY3QoQ29udGVudE9ic2VydmVyKTtcbiAgcHJpdmF0ZSByZWFkb25seSBlbGVtZW50UmVmID0gaW5qZWN0KEVsZW1lbnRSZWYpO1xuICBwcml2YXRlIHJlYWRvbmx5IGRlc3Ryb3lSZWYgPSBpbmplY3QoRGVzdHJveVJlZik7XG4gIHByaXZhdGUgcmVhZG9ubHkgZGVmYXVsdE1heEluR3JvdXAgPSBpbmplY3QoUkRTX0FWQVRBUl9NQVhfSU5fR1JPVVApO1xuICBwcml2YXRlIHJlYWRvbmx5IF9zdGF0ZUNoYW5nZXMgPSBuZXcgU3ViamVjdDx2b2lkPigpO1xuXG4gIEBIb3N0QmluZGluZygnY2xhc3MnKSBjbGFzcyA9ICdyZHMtYXZhdGFyLWdyb3VwJztcblxuICBoaWRkZW5FbGVtZW50cyA9IDA7XG5cbiAgQElucHV0KCkgc2l6ZTogUmRzQXZhdGFyU2l6ZSA9ICdtJztcblxuICBASW5wdXQoKVxuICBzZXQgZGlzYWJsZUludGVyYWN0aW9ucyh2YWx1ZTogQm9vbGVhbklucHV0KSB7XG4gICAgdGhpcy5fZGlzYWJsZUludGVyYWN0aW9ucyA9IGJvb2xlYW5BdHRyaWJ1dGUodmFsdWUpO1xuICAgIHRoaXMuY2hlY2tDaGlsZElucHV0cygpO1xuICB9XG5cbiAgZ2V0IGRpc2FibGVJbnRlcmFjdGlvbnMoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX2Rpc2FibGVJbnRlcmFjdGlvbnM7XG4gIH1cblxuICBwcml2YXRlIF9kaXNhYmxlSW50ZXJhY3Rpb25zID0gZmFsc2U7XG5cbiAgQElucHV0KClcbiAgc2V0IG1heEluR3JvdXAobWF4SW5Hcm91cDogTnVtYmVySW5wdXQpIHtcbiAgICBjb25zdCB2YWx1ZSA9IG51bWJlckF0dHJpYnV0ZShtYXhJbkdyb3VwLCAtMSk7XG4gICAgY29uc3QgcHJldmlvdXNWYWx1ZSA9IHRoaXMuX21heEluR3JvdXA7XG4gICAgdGhpcy5fbWF4SW5Hcm91cCA9IHZhbHVlID49IDAgPyB2YWx1ZSA6IHRoaXMuZGVmYXVsdE1heEluR3JvdXA7XG5cbiAgICBpZiAodGhpcy5fbWF4SW5Hcm91cCAhPT0gcHJldmlvdXNWYWx1ZSkge1xuICAgICAgdGhpcy5fc3RhdGVDaGFuZ2VzLm5leHQoKTtcbiAgICB9XG4gIH1cblxuICBnZXQgbWF4SW5Hcm91cCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9tYXhJbkdyb3VwO1xuICB9XG5cbiAgcHJpdmF0ZSBfbWF4SW5Hcm91cCA9IHRoaXMuZGVmYXVsdE1heEluR3JvdXA7XG5cbiAgQENvbnRlbnRDaGlsZHJlbihSZHNBdmF0YXJDb21wb25lbnQpXG4gIGF2YXRhckxpc3Q6IFF1ZXJ5TGlzdDxSZHNBdmF0YXJDb21wb25lbnQ+O1xuXG4gIG5nQWZ0ZXJDb250ZW50SW5pdCgpOiB2b2lkIHtcbiAgICBtZXJnZShcbiAgICAgIHRoaXMuX3N0YXRlQ2hhbmdlcyxcbiAgICAgIHRoaXMuYXZhdGFyTGlzdC5jaGFuZ2VzLFxuICAgICAgdGhpcy5jb250ZW50T2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLmVsZW1lbnRSZWYpLFxuICAgIClcbiAgICAgIC5waXBlKHN0YXJ0V2l0aChudWxsKSwgdGFrZVVudGlsRGVzdHJveWVkKHRoaXMuZGVzdHJveVJlZikpXG4gICAgICAuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgY29uc3QgdmlzaWJpbGl0eUNoYW5nZWQgPSB0aGlzLmNoZWNrVmlzaWJpbGl0eSgpO1xuXG4gICAgICAgIGlmICh2aXNpYmlsaXR5Q2hhbmdlZCkge1xuICAgICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xuICAgIHRoaXMuX3N0YXRlQ2hhbmdlcy5jb21wbGV0ZSgpO1xuICB9XG5cbiAgcHJpdmF0ZSBjaGVja1Zpc2liaWxpdHkoKTogYm9vbGVhbiB7XG4gICAgbGV0IHZpc2liaWxpdHlDaGFuZ2VkID0gdGhpcy5jaGVja0hpZGRlbkVsZW1lbnRzKCk7XG5cbiAgICB0aGlzLmF2YXRhckxpc3QuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcbiAgICAgIGlmIChpbmRleCA8IHRoaXMubWF4SW5Hcm91cCkge1xuICAgICAgICBpZiAoaXRlbS5faGFzSGlkZGVuU3R5bGUoKSkge1xuICAgICAgICAgIGl0ZW0uX2NsZWFySGlkZGVuU3R5bGVzKCk7XG4gICAgICAgICAgdmlzaWJpbGl0eUNoYW5nZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKCFpdGVtLl9oYXNIaWRkZW5TdHlsZSgpKSB7XG4gICAgICAgIGl0ZW0uX3NldEhpZGRlblN0eWxlcygpO1xuICAgICAgICB2aXNpYmlsaXR5Q2hhbmdlZCA9IHRydWU7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLmNoZWNrQ2hpbGRJbnB1dHMoKTtcblxuICAgIHJldHVybiB2aXNpYmlsaXR5Q2hhbmdlZDtcbiAgfVxuXG4gIHByaXZhdGUgY2hlY2tDaGlsZElucHV0cygpOiB2b2lkIHtcbiAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKCgpID0+IHtcbiAgICAgIHRoaXMuYXZhdGFyTGlzdFxuICAgICAgICAuZmlsdGVyKChpKSA9PiBpLnNpemUgIT09IHRoaXMuc2l6ZSlcbiAgICAgICAgLmZvckVhY2goKGkpID0+IChpLnNpemUgPSB0aGlzLnNpemUpKTtcbiAgICAgIHRoaXMuYXZhdGFyTGlzdFxuICAgICAgICAuZmlsdGVyKChpKSA9PiBpLmRpc2FibGVJbnRlcmFjdGlvbnMgIT09IHRoaXMuZGlzYWJsZUludGVyYWN0aW9ucylcbiAgICAgICAgLmZvckVhY2goKGkpID0+IChpLmRpc2FibGVJbnRlcmFjdGlvbnMgPSB0aGlzLmRpc2FibGVJbnRlcmFjdGlvbnMpKTtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgY2hlY2tIaWRkZW5FbGVtZW50cygpOiBib29sZWFuIHtcbiAgICBjb25zdCBwcmV2aW91cyA9IHRoaXMuaGlkZGVuRWxlbWVudHM7XG4gICAgdGhpcy5oaWRkZW5FbGVtZW50cyA9XG4gICAgICB0aGlzLmF2YXRhckxpc3Q/Lmxlbmd0aCA+IHRoaXMubWF4SW5Hcm91cFxuICAgICAgICA/IHRoaXMuYXZhdGFyTGlzdC5sZW5ndGggLSB0aGlzLm1heEluR3JvdXBcbiAgICAgICAgOiAwO1xuXG4gICAgcmV0dXJuIHByZXZpb3VzICE9PSB0aGlzLmhpZGRlbkVsZW1lbnRzO1xuICB9XG59XG4iXX0=