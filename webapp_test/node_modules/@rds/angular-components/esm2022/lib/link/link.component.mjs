import { FocusMonitor } from '@angular/cdk/a11y';
import { ContentObserver } from '@angular/cdk/observers';
import { booleanAttribute, ChangeDetectionStrategy, ChangeDetectorRef, Component, DestroyRef, ElementRef, HostBinding, inject, Input, numberAttribute, } from '@angular/core';
import { RouterLink } from '@angular/router';
import { takeUntilDestroyed } from '@angular/core/rxjs-interop';
import { TAB_INDEX_DEFAULT, TAB_INDEX_NOT_FOCUSABLE } from '../utils';
import * as i0 from "@angular/core";
export class RdsLinkComponent {
    get hostClasses() {
        const classes = ['rds-link'];
        if (this.standalone) {
            classes.push(`rds-link--${this.type}`, `rds-link-${this.size}`);
        }
        else if (this.elementRef) {
            classes.push(`rds-link-inline`);
        }
        return classes;
    }
    get hasFirstIcon() {
        return (this.elementRef?.nativeElement.firstChild?.tagName?.toUpperCase() ===
            'RDS-ICON');
    }
    get hasLastIcon() {
        return (this.elementRef?.nativeElement.lastChild?.tagName?.toUpperCase() ===
            'RDS-ICON');
    }
    set standalone(isStandalone) {
        this._standalone = booleanAttribute(isStandalone);
    }
    get standalone() {
        return (this._standalone ||
            this.elementRef.nativeElement.tagName === 'BUTTON' ||
            this.hasFirstIcon ||
            this.hasLastIcon);
    }
    get attrDisabled() {
        return this.disabled ? this.disabled : null;
    }
    set tabIndex(value) {
        this._tabIndex = numberAttribute(value, TAB_INDEX_DEFAULT);
    }
    get tabIndex() {
        return this.disabled ? TAB_INDEX_NOT_FOCUSABLE : this._tabIndex;
    }
    constructor() {
        this.destroyRef = inject(DestroyRef);
        this.cdr = inject(ChangeDetectorRef);
        this.elementRef = inject(ElementRef);
        this.focusMonitor = inject(FocusMonitor);
        this.contentObserver = inject(ContentObserver);
        this.routerLink = inject(RouterLink, { optional: true });
        this._standalone = false;
        this.active = false;
        this.disabled = false;
        this._tabIndex = TAB_INDEX_DEFAULT;
        this.type = 'primary';
        this.size = 'l';
        this._preventDisabledLinkClick();
    }
    ngAfterViewInit() {
        this.focusMonitor.monitor(this.elementRef, true);
        this.contentObserver
            .observe(this.elementRef.nativeElement)
            .pipe(takeUntilDestroyed(this.destroyRef))
            .subscribe(() => this.cdr?.markForCheck());
    }
    ngOnDestroy() {
        this.focusMonitor.stopMonitoring(this.elementRef);
    }
    focus(origin = 'program', options) {
        this.focusMonitor.focusVia(this.elementRef.nativeElement, origin, options);
    }
    _preventDisabledLinkClick() {
        const link = this.routerLink;
        if (link) {
            const onClick = link.onClick;
            link.onClick = (...args) => {
                if (this.disabled) {
                    return !this.routerLink;
                }
                else {
                    return onClick.apply(link, args);
                }
            };
        }
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.1", ngImport: i0, type: RdsLinkComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "16.1.0", version: "17.3.1", type: RdsLinkComponent, isStandalone: true, selector: "a[rds-link], a[rdsLink], button[rds-link], button[rdsLink]", inputs: { standalone: "standalone", active: ["active", "active", booleanAttribute], disabled: ["disabled", "disabled", booleanAttribute], tabIndex: "tabIndex", type: "type", size: "size" }, host: { properties: { "class": "this.hostClasses", "class.rds-link-before-icon": "this.hasFirstIcon", "class.rds-link-after-icon": "this.hasLastIcon", "class.rds-link-standalone": "this.standalone", "class.rds-link--active": "this.active", "attr.disabled": "this.attrDisabled", "attr.aria-disabled": "this.disabled", "tabIndex": "this.tabIndex" } }, ngImport: i0, template: '<ng-content/>', isInline: true, changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.1", ngImport: i0, type: RdsLinkComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'a[rds-link], a[rdsLink], button[rds-link], button[rdsLink]',
                    template: '<ng-content/>',
                    changeDetection: ChangeDetectionStrategy.OnPush,
                    standalone: true,
                }]
        }], ctorParameters: () => [], propDecorators: { hostClasses: [{
                type: HostBinding,
                args: ['class']
            }], hasFirstIcon: [{
                type: HostBinding,
                args: ['class.rds-link-before-icon']
            }], hasLastIcon: [{
                type: HostBinding,
                args: ['class.rds-link-after-icon']
            }], standalone: [{
                type: Input
            }, {
                type: HostBinding,
                args: ['class.rds-link-standalone']
            }], active: [{
                type: HostBinding,
                args: ['class.rds-link--active']
            }, {
                type: Input,
                args: [{ transform: booleanAttribute }]
            }], attrDisabled: [{
                type: HostBinding,
                args: ['attr.disabled']
            }], disabled: [{
                type: HostBinding,
                args: ['attr.aria-disabled']
            }, {
                type: Input,
                args: [{ transform: booleanAttribute }]
            }], tabIndex: [{
                type: HostBinding,
                args: ['tabIndex']
            }, {
                type: Input
            }], type: [{
                type: Input
            }], size: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGluay5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9saWJzL2FuZ3VsYXItY29tcG9uZW50cy9zcmMvbGliL2xpbmsvbGluay5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFtQixZQUFZLEVBQWUsTUFBTSxtQkFBbUIsQ0FBQztBQUUvRSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDekQsT0FBTyxFQUVMLGdCQUFnQixFQUNoQix1QkFBdUIsRUFDdkIsaUJBQWlCLEVBQ2pCLFNBQVMsRUFDVCxVQUFVLEVBQ1YsVUFBVSxFQUNWLFdBQVcsRUFDWCxNQUFNLEVBQ04sS0FBSyxFQUNMLGVBQWUsR0FFaEIsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQzdDLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQ2hFLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSx1QkFBdUIsRUFBRSxNQUFNLFVBQVUsQ0FBQzs7QUFXdEUsTUFBTSxPQUFPLGdCQUFnQjtJQVUzQixJQUEwQixXQUFXO1FBQ25DLE1BQU0sT0FBTyxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUM7UUFFN0IsSUFBSSxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7WUFDcEIsT0FBTyxDQUFDLElBQUksQ0FBQyxhQUFhLElBQUksQ0FBQyxJQUFJLEVBQUUsRUFBRSxZQUFZLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO1FBQ2xFLENBQUM7YUFBTSxJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQztZQUMzQixPQUFPLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUM7UUFDbEMsQ0FBQztRQUVELE9BQU8sT0FBTyxDQUFDO0lBQ2pCLENBQUM7SUFFRCxJQUNJLFlBQVk7UUFDZCxPQUFP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LEVBQUU7Z0JBS2xDLFFBQVE7c0JBRlgsV0FBVzt1QkFBQyxVQUFVOztzQkFDdEIsS0FBSztnQkFXRyxJQUFJO3NCQUFaLEtBQUs7Z0JBQ0csSUFBSTtzQkFBWixLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRm9jdXNhYmxlT3B0aW9uLCBGb2N1c01vbml0b3IsIEZvY3VzT3JpZ2luIH0gZnJvbSAnQGFuZ3VsYXIvY2RrL2ExMXknO1xuaW1wb3J0IHsgQm9vbGVhbklucHV0LCBOdW1iZXJJbnB1dCB9IGZyb20gJ0Bhbmd1bGFyL2Nkay9jb2VyY2lvbic7XG5pbXBvcnQgeyBDb250ZW50T2JzZXJ2ZXIgfSBmcm9tICdAYW5ndWxhci9jZGsvb2JzZXJ2ZXJzJztcbmltcG9ydCB7XG4gIEFmdGVyVmlld0luaXQsXG4gIGJvb2xlYW5BdHRyaWJ1dGUsXG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxuICBDaGFuZ2VEZXRlY3RvclJlZixcbiAgQ29tcG9uZW50LFxuICBEZXN0cm95UmVmLFxuICBFbGVtZW50UmVmLFxuICBIb3N0QmluZGluZyxcbiAgaW5qZWN0LFxuICBJbnB1dCxcbiAgbnVtYmVyQXR0cmlidXRlLFxuICBPbkRlc3Ryb3ksXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgUm91dGVyTGluayB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XG5pbXBvcnQgeyB0YWtlVW50aWxEZXN0cm95ZWQgfSBmcm9tICdAYW5ndWxhci9jb3JlL3J4anMtaW50ZXJvcCc7XG5pbXBvcnQgeyBUQUJfSU5ERVhfREVGQVVMVCwgVEFCX0lOREVYX05PVF9GT0NVU0FCTEUgfSBmcm9tICcuLi91dGlscyc7XG5cbmV4cG9ydCB0eXBlIFJkc0xpbmtUeXBlID0gJ3ByaW1hcnknIHwgJ3NlY29uZGFyeSc7XG5leHBvcnQgdHlwZSBSZHNMaW5rU2l6ZSA9ICdzJyB8ICdtJyB8ICdsJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYVtyZHMtbGlua10sIGFbcmRzTGlua10sIGJ1dHRvbltyZHMtbGlua10sIGJ1dHRvbltyZHNMaW5rXScsXG4gIHRlbXBsYXRlOiAnPG5nLWNvbnRlbnQvPicsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxuICBzdGFuZGFsb25lOiB0cnVlLFxufSlcbmV4cG9ydCBjbGFzcyBSZHNMaW5rQ29tcG9uZW50XG4gIGltcGxlbWVudHMgRm9jdXNhYmxlT3B0aW9uLCBBZnRlclZpZXdJbml0LCBPbkRlc3Ryb3lcbntcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IGRlc3Ryb3lSZWYgPSBpbmplY3QoRGVzdHJveVJlZik7XG4gIHByb3RlY3RlZCByZWFkb25seSBjZHIgPSBpbmplY3QoQ2hhbmdlRGV0ZWN0b3JSZWYpO1xuICBwcm90ZWN0ZWQgcmVhZG9ubHkgZWxlbWVudFJlZiA9IGluamVjdChFbGVtZW50UmVmKTtcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IGZvY3VzTW9uaXRvciA9IGluamVjdChGb2N1c01vbml0b3IpO1xuICBwcm90ZWN0ZWQgcmVhZG9ubHkgY29udGVudE9ic2VydmVyID0gaW5qZWN0KENvbnRlbnRPYnNlcnZlcik7XG4gIHByb3RlY3RlZCByZWFkb25seSByb3V0ZXJMaW5rID0gaW5qZWN0KFJvdXRlckxpbmssIHsgb3B0aW9uYWw6IHRydWUgfSk7XG5cbiAgQEhvc3RCaW5kaW5nKCdjbGFzcycpIGdldCBob3N0Q2xhc3NlcygpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgY2xhc3NlcyA9IFsncmRzLWxpbmsnXTtcblxuICAgIGlmICh0aGlzLnN0YW5kYWxvbmUpIHtcbiAgICAgIGNsYXNzZXMucHVzaChgcmRzLWxpbmstLSR7dGhpcy50eXBlfWAsIGByZHMtbGluay0ke3RoaXMuc2l6ZX1gKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuZWxlbWVudFJlZikge1xuICAgICAgY2xhc3Nlcy5wdXNoKGByZHMtbGluay1pbmxpbmVgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gY2xhc3NlcztcbiAgfVxuXG4gIEBIb3N0QmluZGluZygnY2xhc3MucmRzLWxpbmstYmVmb3JlLWljb24nKVxuICBnZXQgaGFzRmlyc3RJY29uKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAoXG4gICAgICB0aGlzLmVsZW1lbnRSZWY/Lm5hdGl2ZUVsZW1lbnQuZmlyc3RDaGlsZD8udGFnTmFtZT8udG9VcHBlckNhc2UoKSA9PT1cbiAgICAgICdSRFMtSUNPTidcbiAgICApO1xuICB9XG5cbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5yZHMtbGluay1hZnRlci1pY29uJylcbiAgZ2V0IGhhc0xhc3RJY29uKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAoXG4gICAgICB0aGlzLmVsZW1lbnRSZWY/Lm5hdGl2ZUVsZW1lbnQubGFzdENoaWxkPy50YWdOYW1lPy50b1VwcGVyQ2FzZSgpID09PVxuICAgICAgJ1JEUy1JQ09OJ1xuICAgICk7XG4gIH1cblxuICBASW5wdXQoKVxuICBASG9zdEJpbmRpbmcoJ2NsYXNzLnJkcy1saW5rLXN0YW5kYWxvbmUnKVxuICBzZXQgc3RhbmRhbG9uZShpc1N0YW5kYWxvbmU6IEJvb2xlYW5JbnB1dCkge1xuICAgIHRoaXMuX3N0YW5kYWxvbmUgPSBib29sZWFuQXR0cmlidXRlKGlzU3RhbmRhbG9uZSk7XG4gIH1cblxuICBnZXQgc3RhbmRhbG9uZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gKFxuICAgICAgdGhpcy5fc3RhbmRhbG9uZSB8fFxuICAgICAgdGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQudGFnTmFtZSA9PT0gJ0JVVFRPTicgfHxcbiAgICAgIHRoaXMuaGFzRmlyc3RJY29uIHx8XG4gICAgICB0aGlzLmhhc0xhc3RJY29uXG4gICAgKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBfc3RhbmRhbG9uZSA9IGZhbHNlO1xuXG4gIEBIb3N0QmluZGluZygnY2xhc3MucmRzLWxpbmstLWFjdGl2ZScpXG4gIEBJbnB1dCh7IHRyYW5zZm9ybTogYm9vbGVhbkF0dHJpYnV0ZSB9KVxuICBhY3RpdmUgPSBmYWxzZTtcblxuICBASG9zdEJpbmRpbmcoJ2F0dHIuZGlzYWJsZWQnKVxuICBnZXQgYXR0ckRpc2FibGVkKCk6IGJvb2xlYW4gfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy5kaXNhYmxlZCA/IHRoaXMuZGlzYWJsZWQgOiBudWxsO1xuICB9XG5cbiAgQEhvc3RCaW5kaW5nKCdhdHRyLmFyaWEtZGlzYWJsZWQnKVxuICBASW5wdXQoeyB0cmFuc2Zvcm06IGJvb2xlYW5BdHRyaWJ1dGUgfSlcbiAgZGlzYWJsZWQgPSBmYWxzZTtcblxuICBASG9zdEJpbmRpbmcoJ3RhYkluZGV4JylcbiAgQElucHV0KClcbiAgc2V0IHRhYkluZGV4KHZhbHVlOiBOdW1iZXJJbnB1dCkge1xuICAgIHRoaXMuX3RhYkluZGV4ID0gbnVtYmVyQXR0cmlidXRlKHZhbHVlLCBUQUJfSU5ERVhfREVGQVVMVCk7XG4gIH1cblxuICBnZXQgdGFiSW5kZXgoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5kaXNhYmxlZCA/IFRBQl9JTkRFWF9OT1RfRk9DVVNBQkxFIDogdGhpcy5fdGFiSW5kZXg7XG4gIH1cblxuICBwcml2YXRlIF90YWJJbmRleCA9IFRBQl9JTkRFWF9ERUZBVUxUO1xuXG4gIEBJbnB1dCgpIHR5cGU6IFJkc0xpbmtUeXBlID0gJ3ByaW1hcnknO1xuICBASW5wdXQoKSBzaXplOiBSZHNMaW5rU2l6ZSA9ICdsJztcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLl9wcmV2ZW50RGlzYWJsZWRMaW5rQ2xpY2soKTtcbiAgfVxuXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLmZvY3VzTW9uaXRvci5tb25pdG9yKHRoaXMuZWxlbWVudFJlZiwgdHJ1ZSk7XG4gICAgdGhpcy5jb250ZW50T2JzZXJ2ZXJcbiAgICAgIC5vYnNlcnZlKHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50KVxuICAgICAgLnBpcGUodGFrZVVudGlsRGVzdHJveWVkKHRoaXMuZGVzdHJveVJlZikpXG4gICAgICAuc3Vic2NyaWJlKCgpID0+IHRoaXMuY2RyPy5tYXJrRm9yQ2hlY2soKSk7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcbiAgICB0aGlzLmZvY3VzTW9uaXRvci5zdG9wTW9uaXRvcmluZyh0aGlzLmVsZW1lbnRSZWYpO1xuICB9XG5cbiAgZm9jdXMob3JpZ2luOiBGb2N1c09yaWdpbiA9ICdwcm9ncmFtJywgb3B0aW9ucz86IEZvY3VzT3B0aW9ucyk6IHZvaWQge1xuICAgIHRoaXMuZm9jdXNNb25pdG9yLmZvY3VzVmlhKHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LCBvcmlnaW4sIG9wdGlvbnMpO1xuICB9XG5cbiAgcHJpdmF0ZSBfcHJldmVudERpc2FibGVkTGlua0NsaWNrKCk6IHZvaWQge1xuICAgIGNvbnN0IGxpbmsgPSB0aGlzLnJvdXRlckxpbms7XG5cbiAgICBpZiAobGluaykge1xuICAgICAgY29uc3Qgb25DbGljayA9IGxpbmsub25DbGljaztcblxuICAgICAgbGluay5vbkNsaWNrID0gKC4uLmFyZ3MpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWQpIHtcbiAgICAgICAgICByZXR1cm4gIXRoaXMucm91dGVyTGluaztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gb25DbGljay5hcHBseShsaW5rLCBhcmdzKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH1cbn1cbiJdfQ==